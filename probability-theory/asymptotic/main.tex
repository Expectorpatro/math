\chapter{渐进理论初步}

\begin{theorem}[Scheffe Theorem]
	设$\{f_n\}$是测度空间$(X,\mathscr{F},\mu)$上的可积函数列，$f$是$(X,\mathscr{F},\mu)$上的可积函数，$f_n\overset{a.e.}{\longrightarrow}f$，则
\end{theorem}
\begin{property}\label{prop:ConvergenceInProbability}
	设$(X,\mathscr{F},P)$为概率空间，$\{f_n\},\{g_n\},\{h_n\}$和$f,g$分别是其上的随机变量列和随机变量，其中$f_n\overset{P}{\longrightarrow}f,\;g_n\overset{P}{\longrightarrow}g$，$\{h_n\}$也是一个实数列，$a,b\in\mathbb{R}^{}$，则：
	\begin{enumerate}
		\item 若$h_n\to a$，则$h_n\overset{P}{\longrightarrow}a$；
		\item $f_n\pm g_n\overset{P}{\longrightarrow}f\pm g$；
		\item $f_ng_n\overset{P}{\longrightarrow}fg$；
		\item 若$P(\{g=0\})=0$，则$\dfrac{f_n}{g_n}\overset{P}{\longrightarrow}\dfrac{f}{g}$。
	\end{enumerate}
\end{property}
\begin{proof}
	(1)由数列极限的定义，对任意的$\varepsilon>0$，存在$N\in\mathbb{N}^+$，当$n>N$时有$|h_n-a|<\varepsilon$，即$P(\{|h_n-a|\geqslant\varepsilon\})=0$，也即$h_n\overset{P}{\longrightarrow}a$。\par
	(2)若$|f_n-f|<\dfrac{\varepsilon}{2}$且$|g_n-g|<\dfrac{\varepsilon}{2}$，由绝对值不等式可得：
	\begin{equation*}
		|f_n\pm g_n-(f\pm g)|\leqslant|f_n-f|+|g_n-g|<\varepsilon
	\end{equation*}
	所以有：
	\begin{equation*}
		\left\{|f_n-f|<\frac{\varepsilon}{2}\right\}\cap\left\{|g_n-g|<\frac{\varepsilon}{2}\right\}\subseteq\{|f_n\pm g_n-(f\pm g)|<\varepsilon\}
	\end{equation*}
	根据\cref{prop:SetOperation}(7)即：
	\begin{equation*}
		\{|f_n\pm g_n-(f\pm g)|\geqslant\varepsilon\}\subseteq\left\{|f_n-f|\geqslant\frac{\varepsilon}{2}\right\}\cup\left\{|g_n-g|\geqslant\frac{\varepsilon}{2}\right\}
	\end{equation*}
	于是对任意的$\varepsilon>0$有：
	\begin{equation*}
		\{|f_n\pm g_n-(f\pm g)|\geqslant\varepsilon\}\subseteq\left\{|f_n-f|\geqslant\frac{\varepsilon}{2}\right\}\cup\left\{|g_n-g|\geqslant\frac{\varepsilon}{2}\right\}
	\end{equation*}
	根据\cref{prop:MeasurableFunction}(5)(2)可知上述集合都是可测集，由\cref{prop:Measure}(3)（单调性，次有限可加性）和\info{极限的线性性}可得：
	\begin{equation*}
		P(\{|f_n\pm g_n-(f\pm b)|\geqslant\varepsilon\})\leqslant P\left(\left\{|f_n-f|\geqslant\frac{\varepsilon}{2}\right\}\right)+P\left(\left\{|g_n-g|\geqslant\frac{\varepsilon}{2}\right\}\right)\to0
	\end{equation*}
	根据测度的非负性即$f_n\pm g_n\overset{P}{\longrightarrow}f\pm g$。\par
	(2)先证$f=g=0$时的情况。对任意的$\varepsilon>0$，当$f_n<\sqrt{\varepsilon},g_n<\sqrt{\varepsilon}$时，$f_ng_n<\varepsilon$，所以有：
	\begin{equation*}
		\{|f_n|<\sqrt{\varepsilon}\}\cap\{|g_n|<\sqrt{\varepsilon}\}\subseteq\{|f_ng_n|<\varepsilon\}
	\end{equation*}
	由\cref{prop:SetOperation}(7)即：
	\begin{equation*}
		\{|f_ng_n|\geqslant\varepsilon\}\subseteq\{|f_n|\geqslant\sqrt{\varepsilon}\}\cup\{|g_n|\geqslant\sqrt{\varepsilon}\}
	\end{equation*}
	根据\cref{prop:Measure}(3)（次有限可加性）和\info{极限的线性性}可得：
	\begin{equation*}
		P(\{|f_ng_n|\geqslant\varepsilon\})\leqslant P(\{|f_n|\geqslant\sqrt{\varepsilon}\})+P(\{|g_n|\geqslant\sqrt{\varepsilon}\})\to0
	\end{equation*}
	根据测度的非负性即$f_ng_n\overset{P}{\longrightarrow}0$。\par
	对于一般的情况，注意到：
	\begin{equation*}
		f_ng_n-fg=(f_n-f)(g_n-g)+f(g_n-g)+g(f_n-f)
	\end{equation*}
	即：
	\begin{equation*}
		|f_ng_n-fg|\leqslant|f_n-f||g_n-g|+|f||g_n-g|+|g||f_n-f|
	\end{equation*}
	于是对任意的$\varepsilon>0$有：
	\begin{equation*}
		\left\{|f_n-f||g_n-g|<\frac{\varepsilon}{3}\right\}\cap\left\{|f||g_n-g|<\frac{\varepsilon}{3}\right\}\cap\left\{|g||f_n-f|<\frac{\varepsilon}{3}\right\}\subseteq\{|f_ng_n-fg|<\varepsilon\}
	\end{equation*}
	由\cref{prop:SetOperation}(7)即：
	\begin{equation*}
		\{|f_ng_n-fg|\geqslant\varepsilon\}\subseteq\left\{|f_n-f||g_n-g|\geqslant\frac{\varepsilon}{3}\right\}\cup\left\{|f||g_n-g|\geqslant\frac{\varepsilon}{3}\right\}\cup\left\{|g||f_n-f|\geqslant\frac{\varepsilon}{3}\right\}
	\end{equation*}
	由\cref{prop:MeasurableFunction}(5)(2)可知上述集合都是可测集，根据\cref{prop:Measure}(3)（单调性，次有限可加性）可得：
	\begin{align*}
		P(\{|f_ng_n-fg|\geqslant\varepsilon\})&\leqslant P\left(\left\{|f_n-f||g_n-g|\geqslant\frac{\varepsilon}{3}\right\}\right)+P\left(\left\{|f||g_n-g|\geqslant\frac{\varepsilon}{3}\right\}\right) \\
		&\quad+P\left(\left\{|g||f_n-f|\geqslant\frac{\varepsilon}{3}\right\}
		\right)
	\end{align*}
	因为$f_n\overset{P}{\longrightarrow}f,g_n\overset{P}{\longrightarrow}g$，所以$f_n-f\overset{P}{\longrightarrow}0,g_n-g\overset{P}{\longrightarrow}0$，所以$(f_n-f)(g_n-g)\overset{P}{\longrightarrow}0$，即：
	\begin{equation*}
		\lim_{n\to+\infty}P\left(\left\{|f_n-f||g_n-g|\geqslant\frac{\varepsilon}{3}\right\}\right)=0
	\end{equation*}
	对给定的$M>0$，有：
	\begin{align*}
		&\left\{|f||g_n-g|\geqslant\frac{\varepsilon}{3}\right\}=\left\{|f||g_n-g|\geqslant\frac{\varepsilon}{3}\right\}\cap X \\
		=&\left\{|f||g_n-g|\geqslant\frac{\varepsilon}{3}\right\}\cap\Big\{\{|f|>M\}\cup\{|f|\leqslant M\}\Big\} \\
		=&\Big\{\left\{|f||g_n-g|\geqslant\frac{\varepsilon}{3}\right\}\cap\{|f|>M\}\Big\}\cup\Big\{\left\{|f||g_n-g|\geqslant\frac{\varepsilon}{3}\right\}\cap\{|f|\leqslant M\}\Big\} \\
		&\subseteq\{|f|>M\}\cup\left\{|g_n-g|\geqslant\frac{\varepsilon}{3M}\right\}
	\end{align*}
	由\cref{prop:Measure}(3)（单调性，次有限可加性）可得：
	\begin{equation*}
		P\left(\left\{|f||g_n-g|\geqslant\frac{\varepsilon}{3}\right\}\right)\leqslant P(\{|f|>M\})+P\left(\left\{|g_n-g|\geqslant\frac{\varepsilon}{3M}\right\}\right)
	\end{equation*}
	由\info{极限的线性性，不等式性}可得：
	\begin{equation*}
		\lim_{n\to+\infty}P\left(\left\{|f||g_n-g|\geqslant\frac{\varepsilon}{3}\right\}\right)\leqslant P(\{|f|>M\})
	\end{equation*}
	同理可得：
	\begin{equation*}
		\lim_{n\to+\infty}P\left(\left\{|g||f_n-f|\geqslant\frac{\varepsilon}{3}\right\}\right)\leqslant P(\{|g|>M\})
	\end{equation*}
	于是有：
	\begin{equation*}
		\lim_{n\to+\infty}P(\{|f_ng_n-fg|\geqslant\varepsilon\})\leqslant P(\{|f|>M\})+P(\{|g|>M\})
	\end{equation*}
	对任意的$M>0$成立。因为$f,g$是随机变量，根据下确界的不等式性、测度的非负性和 极限的不等式性可得：
	\begin{equation*}
		\lim_{n\to+\infty}P(\{|f_ng_n-fg|\geqslant\varepsilon\})=0
	\end{equation*}
	即$f_ng_n\overset{P}{\longrightarrow}fg$。\par
	(4)
\end{proof}
\begin{theorem}[Slutsky Theorem]\label{theo:Slutsky}
	设$\{f_n\}$和$\{g_n\}$是概率空间$(X,\mathscr{F},P)$上的随机变量序列，$f$是$(X,\mathscr{F},P)$上的随机变量，$c\in\mathbb{R}$。若：
	\begin{equation*}
		f_n\overset{d}{\longrightarrow}f,\quad g_n\overset{P}{\longrightarrow}c
	\end{equation*}
	则：
	\begin{enumerate}
		\item $f_n+g_n\overset{d}{\longrightarrow}f+c$；
		\item $g_nf_n\overset{d}{\longrightarrow}cf$；
		\item 当$c\ne0$时，$\dfrac{f_n}{g_n}\overset{d}{\longrightarrow}\dfrac{f}{c}$。
	\end{enumerate}
\end{theorem}
\begin{proof}
	(1)
\end{proof}
\begin{property}\label{prop:ConvergenceInDistribution}
	设$(X,\mathscr{F},P)$为概率空间，$\{f_n\}$和$f$分别是其上的随机变量列和随机变量，其中$f_n\overset{d}{\longrightarrow}f$，$\{a_n\},\{b_n\}$是一个实数列，$a,b\in\mathbb{R}^{}$，则：
	\begin{enumerate}
		\item 若$a_n\to a,b_n\to b$，则$a_nf_n+b_n\overset{d}{\longrightarrow}af+b$；
	\end{enumerate}
\end{property}
\begin{proof}
	(1)由\cref{prop:ConvergenceInProbability}和\cref{theo:Slutsky}(1)(2)立即可得。
\end{proof}
\begin{theorem}\label{theo:ContinuousMappingTheorem}
	设$\{\mathbf{X_n}\}$是概率空间$(X,\mathscr{F},P)$上的$p$维随机向量序列，$\mathbf{X}$是$(X,\mathscr{F},P)$上的$p$维随机向量，$g$是$(\mathbb{R}^{p},\mathcal{B}^p)$到$(\mathbb{R}^{q},\mathcal{B}^q)$上的可测函数，且$g\;$a.s连续于$(\mathbb{R}^{p},\sigma(g),P\mathbf{X}^{-1})$，则：
	\begin{enumerate}
		\item $\mathbf{X_n}\overset{a.s.}{\longrightarrow}\mathbf{X}\Rightarrow g(\mathbf{X_n})\overset{a.s.}{\longrightarrow}g(\mathbf{X})$；
		\item $\mathbf{X_n}\overset{P}{\longrightarrow}\mathbf{X}\Rightarrow g(\mathbf{X_n})\overset{P}{\longrightarrow}g(\mathbf{X})$；
		\item $\mathbf{X_n}\overset{d}{\longrightarrow}\mathbf{X}\Rightarrow g(\mathbf{X_n})\overset{d}{\longrightarrow}g(\mathbf{X})$；
	\end{enumerate}
\end{theorem}
\begin{proof}
%	(1)考虑$g$的所有连续点，由连续性可得对任意的$\varepsilon>0$，存在$\delta>0$，当$||\mathbf{X_n}-\mathbf{X}||<\delta$时，就有$||g(\mathbf{X_n})-g(\mathbf{X})||<\varepsilon$，根据\cref{prop:Measure}(3)（单调性）可得：
%	\begin{equation*}
%		P\mathbf{X}^{-1}(\{||g(\mathbf{X_n})-g(\mathbf{X})||<\varepsilon\})\leqslant P(\{||\mathbf{X_n}-\mathbf{X}||<\delta\})
%	\end{equation*}
%	\begin{equation*}
%		P\left(\lim_{n\to+\infty}g(\mathbf{X}_n)\ne g(\mathbf{X})\right)
%	\end{equation*}
%	\begin{equation*}
%		P[||\lim_{n\to+\infty}g(\mathbf{X_n})-g(\mathbf{X})||\geqslant\varepsilon]
%	\end{equation*}
\end{proof}

\begin{definition}
	设
\end{definition}


\input{probability-theory/asymptotic/law-of-large-numbers.tex}
\input{probability-theory/asymptotic/CLT.tex}
\input{probability-theory/asymptotic/continuity-correction.tex}
\input{probability-theory/asymptotic/deltamethod.tex}