\chapter{概率初步}

\section{随机变量的分类}
设$f$是概率空间$(X,\mathscr{F},P)$上的随机变量。由\cref{prop:MeasurableMapping}(3)可知$(\mathbb{R}^{},\mathcal{B},Pf^{-1})$是一个概率空间。因为$Pf^{-1}$是概率测度，所以$Pf^{-1}$是$\sigma$有限测度，而由\cref{prop:LSMeasure}(6)可知L测度$\lambda$也是$\sigma$有限测度，根据\cref{theo:LebesgueDecomposition}可知$Pf^{-1}$有如下分解式：
\begin{equation*}
	Pf^{-1}=\mu_1+\mu_s,\quad\mu_1\ll\lambda,\quad\mu_s\perp\lambda
\end{equation*}
其中$\mu_1$和$\mu_s$是$\sigma$有限的符号测度。由\cref{prop:BorelSigmaField}(2)可知$\mathbb{R}^{}$上的单点集都在$\mathcal{B}$中，于是记：
\begin{gather*}
	D=\{x\in\mathbb{R}^{}:\mu_s(\{x\})>0\}
\end{gather*}
则$D$是有限集或可列集，否则对任意满足$\underset{n=1}{\overset{+\infty}{\cup}}A_n=\mathbb{R}^{}$的互不相交的$\{A_n\}\subseteq\mathcal{B}$，必然有一个$A_n$中有不可列个正测度的单点集（不然的话由\info{可列个可列是可列}即可得到$D$是可列集）。设$A_n$中所有正测度的点构成的集合为$E$，由\cref{theo:JordanDecomposition}可知$\mu_s$可以分解为测度$\varphi^+$与有限测度$\varphi^-$的差或有限测度$\varphi^+$与测度$\varphi^-$的差\info{检查符号测度部分可以负无穷的所有情况}。取：
\begin{equation*}
	\forall\;k\in\mathbb{N}^+,\;E_k=\left\{x\in E:\mu_s(x)\geqslant\frac{1}{k}\right\}
\end{equation*}
因为$E$中的元素不可列，所以必然存在一个$E_k$含有不可列个元素，否则由\info{可列个可列是可列}即可得出$E$中的元素是可列的。根据\cref{prop:BorelSigmaField}(2)可知单点集在$\mathcal{B}$中，因为测度具有可列可加性，可取$E$的一个子集，在选定的子集最前面加入$E_k$中的点，加一个点该子集关于$\varphi^+$的测度就增加$\dfrac{1}{k}$，这个增加的过程可以无限的进行下去，于是$A_n$中存在在$\mathscr{F}$中的可列子集使得其关于$\varphi^+$的测度为$+\infty$。\par
在第一种情况中，由\cref{prop:Measure}(3)（单调性）和$\varphi^-$的有限性可得$\mu_s(A_n)=\varphi^+(A_n)-\varphi^-(A_n)=+\infty$，那么$\mu_s$就不是$\sigma$有限的符号测度，矛盾。\par
第二种情况时，$\mathscr{F}$中不可能存在关于$\varphi^+$的测度为$+\infty$的集合。\par
综上，$D$至多可列。\par
因为$D$至多可列，根据\cref{prop:BorelSigmaField}(2)可得单点集在$\mathcal{B}$中，所以$D\in\mathcal{B}$，于是令：
\begin{equation*}
	\forall\;A\in\mathcal{B},\;\mu_2(A)=\mu_s(A\cap D),\quad\mu_3=\mu_s-\mu_2
\end{equation*}
由$D$的定义和\cref{prop:Measure}(3)（单调性）可得$\mu_2$是一个非负集函数。因为$\mu_s$是符号测度，所以$\mu_2(\varnothing)=\mu_s(\varnothing)=0$，由\cref{prop:SetOperation}(4)可知$\mu_2$满足可列可加性，于是$\mu_2$是测度。因为$\mu_s$是$\sigma$有限测度，则$\mu_2$显然也是$\sigma$有限测度。\info{思考$\mu_3$是不是有限测度}\par
综上，$Pf^{-1}$有分解：
\begin{equation*}
	Pf^{-1}=\mu_1+\mu_2+\mu_3
\end{equation*}\par
若对任意的$A\in\mathcal{B}$有$\mu_2(A)=\mu_3(A)=0$，称$f$为\textbf{连续型随机变量}。因为$\mu_1\ll\lambda$，所以此时有$Pf^{-1}\ll\lambda$，因为$\lambda$是$\sigma$有限测度，$Pf^{-1}$是概率测度，由\cref{theo:RandonNikodym}可知存在$(\mathbb{R}^{},\mathcal{B},\lambda)$上在a.e.于$\mathbb{R}^{}$的意义下唯一的可测函数$p(x)$满足：
\begin{equation*}
	\dfrac{\dif Pf^{-1}}{\dif \lambda}(x)=p(x)
\end{equation*}
称$p(x)$为$f$的\textbf{概率密度函数}。在没有明确随机变量的场合，也将概率测度$P$对L测度$\lambda$的Randon-Nikodym导数称为概率密度函数。\par
若对任意的$A\in\mathcal{B}$有$\mu_1(A)=\mu_3(A)=0$，称$f$为\textbf{离散型随机变量}。记$D=\{x_n\},\;p(x_n)=Pf^{-1}(\{x_n\}),\;n\in\mathbb{N}^+$，则：
\begin{equation*}
	\{p(x_n):x_n\in D\}
\end{equation*}
完全确定了$f$的概率分布，称上式为$f$的\textbf{概率分布列}（简称为分布列）。在没有明确随机变量的场合，也将满足条件的$\mu_2$称为概率分布列。\par
若对任意的$A\in\mathcal{B}$有$\mu_1(A)=\mu_2(A)=0$，称$f$为\textbf{奇异型随机变量}。\par
统称概率分布列与概率密度函数为\textbf{概率函数}。\par
\begin{theorem}
	任何随机变量的分布都是离散型、连续型、奇异型随机变量分布的混合。
\end{theorem}

\section{独立性}
\begin{definition}
	设$(X,\mathscr{F},P)$是一个概率空间，$T$是一个指标集。
	\begin{enumerate}
		\item 若$(X,\mathscr{F},P)$上的集族$\{A_n:n\in T\}$对任意的$m\in\mathbb{N}^+$和任意的$\{\seq{n}{m}\}\subseteq T$，有：
		\begin{equation*}
			P\left(\underset{i=1}{\overset{m}{\cap}}A_{n_i}\right)=\prod_{i=1}^{m}P(A_{n_i})
		\end{equation*}
		则称$\{A_n:n\in T\}$\gls{MutuallyIndependent}；
		\item 设$\{\mathscr{A}_n\subseteq\mathscr{F}:n\in T\}$是$(X,\mathscr{F},P)$上由集族构成的集族，若对每个$n\in T$任取一个$A_n\in\mathscr{A}_n$所构成的集族$\{A_n:n\in T\}$相互独立，则称$\{\mathscr{A}_n\subseteq\mathscr{F}:n\in T\}$相互独立；
		\item 设$\{f_n:n\in T\}$是由$(X,\mathscr{F},P)$上的随机变量构成的随机变量族，若$\{\sigma(f_n):n\in T\}$相互独立，则称$\{f_n:n\in T\}$相互独立。若$\sigma(f)$与$\mathscr{A}\subseteq\mathscr{F}$独立，也称为$f$与$\mathscr{A}$独立。
	\end{enumerate}
	若$(X,\mathscr{F},P)$上的集族$\{A_n\}$对任意的$i\ne j$有$P(A_i\cap A_j)=P(A_i)P(A_j)$，则称$\{A_n\}$\gls{PairwiseIndependent}。可见两个集合之间的相互独立性与成对独立性是等价的，于是将两个集合相互独立或成对独立简称为它们独立。
\end{definition}
\begin{property}\label{prop:Independent}
	设$(X,\mathscr{F},P)$是一个概率空间。独立性具有如下性质：
	\begin{enumerate}
		\item 若$\{A_n\}\subseteq\mathscr{F}$相互独立，则对其中任意个元素取补集后得到的$\{B_n\}$也相互独立；
		\item $\{A_n\}\subseteq\mathscr{F}$相互独立当且仅当$\{I_{A_n}\}$相互独立；
		\item $\{\mathscr{A}_n\subseteq\mathscr{F}\}$相互独立则$\{(X,\mathscr{A}_n)\}$上任意的随机变量族也相互独立；
		\item 设$\{f_n\}$是$(X,\mathscr{F},P)$上相互独立的随机变量族，$\{g_n\}$是一族$(\mathbb{R}^{},\mathcal{B})$上的Borel函数，则$\{g_n\circ f_n\}$是相互独立的随机变量族；
		\item 若由$\pi$系构成的集族$\{\mathscr{A}_n\subseteq\mathscr{F}\}$相互独立，则将其中任意个元素修改为由自身生成的$\sigma$域后得到的$\{\mathscr{B}_n\}$也相互独立；
		\item 设$f$为$(X,\mathscr{F})$上的随机变量，$f$与$\mathscr{A}\subseteq\mathscr{F}$独立，$g$是$(\mathbb{R}^{},\mathcal{B})$上的Borel函数，则$g\circ f$与$\mathscr{A}$独立；
		\item 若$f$与$\mathscr{A}\subseteq\mathscr{F}$独立，则$f^+,f^-$与$\mathscr{A}$独立；
		\item 若$f$与$\mathscr{A}\subseteq\mathscr{F}$独立，当$f$是非负可测函数时，\cref{prop:MeasurableFunction}(8)中满足$\varphi_n\uparrow f$的非负简单函数列$\{\varphi_n\}$与$\mathscr{A}$独立；
	\end{enumerate}
\end{property}
\begin{proof}
	(1)当$\{A_n\}=\{\seq{A}{n}\}$时，考虑$\{A_1^c,A_2,\dots,A_n\}$的情况。对任意的$m\in\{1,2,\dots,n\}$和任意的$\{\seq{n}{m}\}\subseteq\{1,2,\dots,n\}$，若$1\notin\{\seq{n}{m}\}$，自然有：
	\begin{equation*}
		P\left(\underset{i=1}{\overset{m}{\cap}}A_{n_i}\right)=\prod_{i=1}^{m}P(A_{n_i})
	\end{equation*}
	若$1\in\{\seq{n}{m}\}$，修改数值使得$n_1=1$，由\cref{prop:SetOperation}(6)和\cref{prop:Measure}(2)可知：：
	\begin{align*}
		P\left[A_1^c\cap\left(\underset{i=2}{\overset{m}{\cap}}A_{n_i}\right)\right]&=P\left\{\underset{i=2}{\overset{m}{\cap}}A_{n_i}\backslash\left[A_1\cap\left(\underset{i=2}{\overset{m}{\cap}}A_{n_i}\right)\right]\right\}=P\left(\underset{i=2}{\overset{m}{\cap}}A_{n_i}\right)-P\left(\underset{i=1}{\overset{m}{\cap}}A_{n_i}\right) \\
		&=\prod_{i=2}^{m}P(A_{n_i})-\prod_{i=1}^{m}P(A_{n_i})=[1-P(A_1)]\prod_{i=2}^{m}P(A_{n_i}) \\
		&=P(A_1^c)\prod_{i=2}^{m}P(A_{n_i})
	\end{align*}
	于是$\{A_1^c,A_2,\dots,A_n\}$相互独立，该结论显然可推广至对$\{A_n\}$中任意个元素取补集后得到的$\{B_n\}$也相互独立。\par
	当$\{A_n\}$含有无穷个元素时，由相互独立的定义和有限个元素时的情况即可得出结论。\par
	(2)注意到$\{\sigma(I_{A_n})\}=\Big\{\{\varnothing,A_n,A_n^c,X\}\Big\}$，所以充分性显然成立，下证必要性。对每个$n\in T$任取一个$B_n\in\sigma(I_{A_n})$从而构成集族$\{B_n\}$。对任意的$m\in\mathbb{N}^+$且$m$小于等于$\{B_n\}$中元素的个数，从$\{B_n\}$中任取$m$个元素构成集族$\{C_n\}$。若$\varnothing\in\{C_n\}$，则：
	\begin{equation*}
		P\left(\underset{i=1}{\overset{m}{\cap}}C_i\right)=P(\varnothing)=0,\quad\prod_{i=1}^{m}P(C_i)=0
	\end{equation*}
	二者相等。其它情况由$X=\varnothing^c$和(1)即可得出。\par
	(3)由随机变量的定义立即可得。\par
	(4)由\cref{prop:MeasurableMapping}(2)的证明过程可知$\sigma(g_n\circ f_n)\subseteq\sigma(f_n)$，而$\{\sigma(f_n)\}$相互独立，所以$\{g_n\circ f_n\}$相互独立。\par
	(5)当$\{\mathscr{A}_n\}=\{\seq{\mathscr{A}}{n}\},\;\{\mathscr{B}_n\}=\{\sigma(\mathscr{A}_1),\mathscr{A}_2,\dots,\mathscr{A}_n\}$时，记：
	\begin{equation*}
		\mathscr{B}=\left\{A\in\mathscr{F}:\textbf{对任意的}B=\underset{i=2}{\overset{m}{\cap}}A_{n_i},A_{n_i}\in\mathscr{A}_{n_i},\;i=2,\dots,m,\;m\leqslant n\textbf{有}P(A\cap B)=P(A)P(B)\right\}
	\end{equation*}
	注意到$P(X\cap B)=P(B)=P(X)P(B)$，所以$X\in\mathscr{B}$。若$C,D\in\mathscr{B}$且$D\subseteq C$，由\cref{prop:SetOperation}(4)和\cref{prop:Measure}(2)可得：
	\begin{align*}
		P[(C\backslash D)\cap B]&=P[(C\cap B)\backslash(D\cap B)]=P(C\cap B)-P(D\cap B) \\
		&=P(C)P(B)-P(D)P(B)=[P(C)-P(D)]P(B)=P(C\backslash D)P(B)
	\end{align*}
	所以$C\backslash D\in\mathscr{B}$。取$\mathscr{B}$中单调递增的集合序列$\{B_m\}$，由\cref{prop:SigmaField}(2)可知$\{B_m\cap B\}$也是$\mathscr{F}$中单调递增的集合序列，由\cref{prop:SetOperation}(4)和\cref{prop:Measure}(3)（下连续性）可得：
	\begin{align*}
		P\left[\left(\underset{m=1}{\overset{+\infty}{\cup}}B_m\right)\cap B\right]&=P\left[\underset{m=1}{\overset{+\infty}{\cup}}(B_m\cap B)\right]=\lim_{m\to+\infty}P\left[B_m\cap B\right] \\
		&=\lim_{m\to+\infty}[P(B_m)P(B)]=P(B)\lim_{m\to+\infty}P(B_m) \\
		&=P(B)P\left(\underset{m=1}{\overset{+\infty}{\cup}}B_m\right)
	\end{align*}
	于是$\underset{m=1}{\overset{+\infty}{\cup}}B_m\in\mathscr{B}$。\par
	综上，$\mathscr{B}$是一个$\lambda$系，由相互独立性的定义可知$\mathscr{A}_1\subseteq\mathscr{B}$，根据\cref{cor:SigmaPi=LambdaPi}可得$\sigma(\mathscr{A}_1)\subseteq\mathscr{B}$，所以有$\sigma(\mathscr{A}_1),\mathscr{A}_2,\dots,\mathscr{A}_n$相互独立。显然可将该结论推广为：将$\seq{\mathscr{A}}{n}$中任意个元素修改为由自身生成的$\sigma$域后得到的$\seq{\mathscr{B}}{n}$也相互独立。\par
	当$\{\mathscr{A}_n\}$含有无穷个元素时，由相互独立的定义和有限个元素时的情况即可得出结论。\par
	(6)由\cref{prop:MeasurableMapping}(2)的证明过程可知$\sigma(g\circ f)\subseteq\sigma(f)$，而$\sigma(f)$与$\mathscr{A}$相互独立，所以$g\circ f$与$\mathscr{A}$相互独立。\par
	(7)$\;f^+$可视作$f$关于函数$h$的复合：
	\begin{equation*}
		h(x)=
		\begin{cases}
			x,&x>0 \\
			0,&x\leqslant0
		\end{cases}
	\end{equation*}
	显然$h$是一个$\mathbb{R}^{}$上的实值连续函数，由\cref{prop:MeasurableFunction}(10)即可得到$h$是$(\mathbb{R}^{},\mathcal{B})$上的Borel函数，根据(6)即可得出$f^+$与$\mathscr{A}$独立。$f^-$的情况同理可得。\par
	(8)对任意的$A\in\mathcal{B}$和任意的$n\in\mathbb{N}^+$，根据\cref{prop:MeasurableFunction}(8)可知$\varphi_n^{-1}(A)$是有限个$\sigma(f)$中集合的并集，由\cref{prop:SigmaField}(3)可知$\varphi_n^{-1}(A)\in\sigma(f)$，根据$A$的任意性可得$\sigma(\varphi_n)\subseteq\sigma(f)$。因为$\sigma(f)$与$\mathscr{A}$独立，所以有$\sigma(\varphi_n)$与$\mathscr{A}$独立，即$\varphi_n$与$\mathscr{A}$独立。由$n$的任意性即可得出结论。
\end{proof}

\input{probability-theory/single-variable/expectation.tex}
\input{probability-theory/single-variable/variance.tex}
\input{probability-theory/single-variable/moment.tex}
\input{probability-theory/single-variable/covariance.tex}
\input{probability-theory/single-variable/quadratic-form.tex}
\input{probability-theory/single-variable/moment-generating-function.tex}
\input{probability-theory/single-variable/cumulant-generating-function.tex}
\input{probability-theory/single-variable/characteristic-function.tex}
\input{probability-theory/single-variable/fisher-information.tex}
\input{probability-theory/single-variable/distance.tex}