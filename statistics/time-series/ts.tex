\section{线性差分方程理论}

\subsection{差分与位移}
\begin{definition}
	设$f(x)$是定义在$\mathbb{R}^{}$上的函数，称$\Delta f(x)=f(x)-f(x-1)$为$f(x)$在$x$处的$1$阶\textbf{差分}，称$\Delta$为\textbf{差分算子}，对$n-1$阶差分后的函数再进行一次$1$阶差分运算称为$n$阶差分，记$\Delta^nf(x)$为$f(x)$的$n$阶差分，则：
	\begin{equation*}
		\Delta^nf(x)=\Delta^{n-1}f(x)-\Delta^{n-1}f(x-1)
	\end{equation*}\par
	将$\mathcal{B}f(x)=f(x-1)$称为$f(x)$在$x$处的$1$步\textbf{位移}，称$\mathcal{B}$为位移算子，对$n-1$步位移后的函数再进行一次$1$步位移运算称为$n$步位移，记$\mathcal{B}^nf(x)$为$f(x)$的$n$步位移，则：
	\begin{equation*}
		\mathcal{B}^nf(x)=f(x-n)
	\end{equation*}
\end{definition}
\begin{property}
	设$f(x),g(x)$为定义在$\mathbb{R}^{}$上的函数，$\alpha,\beta$是任意常数，$\mathcal{B}$为位移算子。差分算子$\Delta$和位移算子$\mathcal{B}$具有如下性质：
	\begin{enumerate}
		\item 差分算子是线性算子，即：
		\begin{equation*}
			\Delta[\alpha f(x)+\beta g(x)]=\alpha\Delta f(x)+\beta\Delta g(x)
		\end{equation*}
		\item $\Delta[f(x)g(x)]=\Delta f(x)g(x)+\Delta g(x)\mathcal{B}f(x)$；
		\item $\Delta\left[\dfrac{f(x)}{g(x)}\right]=\dfrac{\Delta f(x)\mathcal{B}g(x)-\Delta g(x)\mathcal{B}f(x)}{g(x)\mathcal{B}g(x)}$；
		\item $\mathcal{B}\alpha=\alpha$；
		\item 位移算子是线性算子，即：
		\begin{equation*}
			\mathcal{B}[\alpha f(x)+\beta g(x)]=\alpha\mathcal{B}f(x)+\beta\mathcal{B}g(x)
		\end{equation*}
		\item 对于多项式$\varphi(x)=\sum\limits_{i=0}^{m}a_ix^i,\;\psi(x)=\sum\limits_{i=0}^{n}b_ix^i$的乘积$A(x)=\varphi(x)\psi(x)$，有：
		\begin{equation*}
			A(\mathcal{B})f(x)=\varphi(\mathcal{B})[\psi(\mathcal{B})f(x)]=\psi(\mathcal{B})[\varphi(\mathcal{B})f(x)]
		\end{equation*}
		\item 差分算子与位移算子具有如下关系：
		\begin{gather*}
			\Delta^n=(I-\mathcal{B})^n=\sum_{i=0}^{n}\binom{n}{i}(-1)^i\mathcal{B}^i \\
			\mathcal{B}^n=(I-\Delta)^n=\sum_{i=0}^{n}\binom{n}{i}(-1)^i\Delta^i \\
			\Delta\mathcal{B}=\mathcal{B}\Delta
		\end{gather*}
	\end{enumerate}
\end{property}
\begin{proof}
	(1)(4)(5)(7)是显然的。\par
	(2)注意到：
	\begin{align*}
		\Delta[f(x)g(x)]&=f(x)g(x)-f(x-1)g(x-1) \\
		&=f(x)g(x)-f(x-1)g(x)+g(x)f(x-1)-g(x-1)f(x-1) \\
		&=[f(x)-f(x-1)]g(x)+[g(x)-g(x-1)]f(x-1) \\
		&=\Delta f(x)g(x)+\Delta g(x)\mathcal{B}f(x)
	\end{align*}\par
	(3)注意到：
	\begin{align*}
		\Delta\left[\frac{f(x)}{g(x)}\right]
		&=\frac{f(x)}{g(x)}-\frac{f(x-1)}{g(x-1)}
		=\frac{f(x)g(x-1)-f(x-1)g(x)}{g(x)g(x-1)} \\
		&=\frac{f(x)g(x-1)-f(x-1)g(x-1)+f(x-1)g(x-1)-f(x-1)g(x)}{g(x)\mathcal{B}g(x)} \\
		&=\frac{[f(x)-f(x-1)]g(x-1)-[g(x)-g(x-1)]f(x-1)}{g(x)\mathcal{B}g(x)} \\
		&=\frac{\Delta f(x)\mathcal{B}g(x)-\Delta g(x)\mathcal{B}f(x)}{g(x)\mathcal{B}g(x)}
	\end{align*}\par
	(6)注意到：
	\begin{equation*}
		A(x)=\varphi(x)\psi(x)=\left(\sum_{i=0}^{m}a_ix^i\right)\left(\sum_{i=0}^{n}b_ix^i\right)=\sum_{i=0}^{m}\sum_{j=0}^{n}a_ib_j x^{i+j}
	\end{equation*}
	所以：
	\begin{align*}
		A(\mathcal{B})f(x)&=\sum_{i=0}^{m}\sum_{j=0}^{n}a_ib_j\mathcal{B}^{i+j}f(x)
		=\sum_{i=0}^{m}\sum_{j=0}^{n}a_ib_j \mathcal{B}^i\mathcal{B}^j f(x) \\
		&=\sum_{i=0}^{m}a_i\mathcal{B}^i\left[\sum_{j=0}^{n}b_j\mathcal{B}^j f(x)\right]
		=\varphi(\mathcal{B})[\psi(\mathcal{B})f(x)]
	\end{align*}
	同理可证$A(\mathcal{B})f(x)=\psi(\mathcal{B})[\varphi(\mathcal{B})f(x)]$。
\end{proof}


\subsection{线性差分方程}
\begin{definition}
	称方程：
	\begin{equation*}
		x_m+a_1(m)x_{m-1}+a_2(m)x_{m-2}+\cdots+a_n(m)x_{m-n}=f(m)
	\end{equation*}
	为关于$\{x_m\}$的$n$阶线性差分方程，其中$f(x),a_1(x),a_2(x),\dots,a_n(x)$为定义在$\mathbb{Z}^{}$上的函数，且$a_n(x)\ne0$在$x\in\mathbb{Z}^{}$恒成立。当$f(x)=0$时，称上述方程为关于$\{x_m\}$的$n$阶齐次线性差分方程。
\end{definition}
\begin{note}
	这里的线性指的是方程关于$\{x_m\}$是线性的。$x_m-\sin(x_{m-1})$不是一个线性方程。
\end{note}
\begin{derivation}
	定义算子：
	\begin{equation*}
		L(x_m)=I+a_1(m)\mathcal{B}x_m+a_2(m)\mathcal{B}^2x_m+\cdots+a_n(m)\mathcal{B}^nx_m
	\end{equation*}
	则线性差分方程可表示为：
	\begin{equation*}
		L(x_m)=f(m)
	\end{equation*}
\end{derivation}
\begin{theorem}\label{theo:LinearDifferenceEqExistenceUniqueness}
	初值问题：
	\begin{equation*}
		L(x_m)=f(m),\;x_0=y_0,\;x_1=y_1,\;\cdots,\;x_{n-1}=y_{n-1}
	\end{equation*}
	有唯一的解。
\end{theorem}
\begin{proof}
	注意到关系：
	\begin{gather*}
		x_m+a_1(m)x_{m-1}+a_2(m)x_{m-2}+\cdots+a_n(m)x_{m-n}=f(m),\;\forall\;m\geqslant n \\
		x_{m}=-\frac{x_{m+n}}{a_n(m+n)}-\frac{a_1(m)x_{m+n-1}}{a_n(m+n)}-\cdots-\frac{a_{n-1}x_{m+1}}{a_n(m+n)}+\frac{f(m)}{a_n(m+n)},\;\forall\;m<0
	\end{gather*}
	于是当如上$n$个初始值给定时，$\{x_m\}$的所有值都可以由上述递推关系唯一得到。
\end{proof}
\begin{definition}
	若存在不全为$0$的常数$\seq{c}{k}$使得序列$\{x_m^{(1)}\},\{x_m^{(2)}\},\dots,\{x_m^{(k)}\}$满足：
	\begin{equation*}
		c_1x_m^{(1)}+c_2x_m^{(2)}+\cdots+c_kx_m^{(k)}=0,\;\forall\;m\in\mathbb{Z}^{}
	\end{equation*}
	则称这些序列\textbf{线性相关}，否则就称这些序列\textbf{线性无关}。
\end{definition}
\begin{definition}
	称矩阵：
	\begin{equation*}
		C(m)=
		\begin{pmatrix}
			x_m^{(1)} & x_m^{(2)} & \cdots & x_m^{(k)} \\
			\mathcal{B}x_m^{(1)} & \mathcal{B}x_m^{(2)} & \cdots & \mathcal{B}x_m^{(k)} \\
			\vdots & \vdots & \ddots & \vdots \\
			\mathcal{B}^{k-1}x_m^{(1)} & \mathcal{B}^{k-1}x_m^{(2)} & \cdots & \mathcal{B}^{k-1}x_m^{(k)} \\
		\end{pmatrix}
	\end{equation*}
	为序列$\{x_m^{(1)}\},\{x_m^{(2)}\},\dots,\{x_m^{(k)}\}$的\textbf{Casorati矩阵}，将$\det C(m)$称为其\textbf{Casorati行列式}。
\end{definition}
\begin{theorem}\label{theo:CasoratiEq0LinearDependent}
	若序列$\{x_m^{(1)}\},\{x_m^{(2)}\},\dots,\{x_m^{(k)}\}$线性相关，则其Casorati行列式$\det C(m)$在$m\in\mathbb{Z}^{}$上恒为$0$。
\end{theorem}
\begin{proof}
	因为$\{x_m^{(1)}\},\{x_m^{(2)}\},\dots,\{x_m^{(k)}\}$线性相关，所以存在不全为$0$的常数$\seq{c}{k}$使得
	\begin{equation*}
		c_1x_m^{(1)}+c_2x_m^{(2)}+\cdots+c_kx_m^{(k)}=0,\;\forall\;m\in\mathbb{Z}^{}
	\end{equation*}
	于是以$C(m)$为系数矩阵的线性方程组有非零解。由\info{链接线性方程组理论}可知$\det C(m)=0$在$m\in\mathbb{Z}^{}$上恒成立。
\end{proof}
\begin{corollary}\label{cor:CasoratiNe0LinearIndependent}
	若存在$m\in\mathbb{Z}^{}$使得$\det C(m)\ne0$，则序列$\{x_m^{(1)}\},\{x_m^{(2)}\},\dots,\{x_m^{(k)}\}$线性无关。
\end{corollary}
\subsubsection{齐次线性差分方程解的一般理论}
\begin{theorem}\label{theo:LinearDifferenceLinearCombination}
	如果$\{x_m^{(1)}\},\{x_m^{(2)}\},\dots,\{x_m^{(k)}\}$是$n$阶常系数齐次线性差分方程$L(x_m)=0$的$k$个解，则它们的线性组合：
	\begin{equation*}
		\{x_m=c_1x_m^{(1)}+c_2x_m^{(2)}+\cdots+c_kx_m^{(k)}\}
	\end{equation*}
	也是解，其中$c_i$为任意常数，$i=1,2,\dots,k$。
\end{theorem}
\begin{proof}
	因为$x_m^{(j)},\;j=1,2,\dots,k$是$L(x_m)=0$的解，所以：
	\begin{equation*}
		x_m^{(j)}+a_{1}x_{m-1}^{(j)}+\cdots+a_nx_{m-n}^{(j)}=0
	\end{equation*}
	于是：
	\begin{equation*}
		\sum_{j=1}^{k}x_m^{(j)}+a_1\sum_{j=1}^{k}x_{m-1}^{(j)}+\cdots+a_n\sum_{j=1}^{k}x_{m-n}^{j}=0
	\end{equation*}
	即：
	\begin{equation*}
		x_m+a_{1}x_{m-1}+\cdots+a_nx_{m-n}=0\qedhere
	\end{equation*}
\end{proof}
\begin{theorem}
	$n$阶齐次线性差分方程$L(x_m)=0$一定存在$n$个线性无关的解。
\end{theorem}
\begin{proof}
	由\cref{theo:LinearDifferenceEqExistenceUniqueness}可知$L(x_m)=0$满足初值条件：
	\begin{equation*}
		\begin{cases}
			x_0=1,\;x_1=0,\;\dots,\;x_{n-1}=0 \\
			x_0=0,\;x_1=1,\;\dots,\;x_{n-1}=0 \\
			\cdots\cdots\cdots \\
			x_0=0,\;x_1=0,\;\dots,\;x_{n-1}=1 \\
		\end{cases}
	\end{equation*}
	的解一定存在，由\cref{cor:CasoratiNe0LinearIndependent}可知这$n$个解线性无关。
\end{proof}
\begin{theorem}\label{theo:GeneralSolutionHomogeneousLinearDifferenceEquation}
	设$\{x_m^{(1)}\},\{x_m^{(2)}\},\dots,\{x_m^{(n)}\}$是$n$阶齐次线性差分方程$L(x_m)=0$的$n$个线性无关的解，则方程的通解可以表示为：
	\begin{equation*}
		x_m=c_1x_m^{(1)}+c_2x_m^{(2)}+\cdots+c_nx_m^{(n)},\;\forall\;m\in\mathbb{Z}^{}
	\end{equation*}
	其中$\seq{c}{n}$是任意常数。
\end{theorem}
\begin{proof}
	因为$\{x_m^{(1)}\},\{x_m^{(2)}\},\dots,\{x_m^{(n)}\}$线性无关，由\cref{theo:CasoratiEq0LinearDependent}可知存在$m\in\mathbb{Z}^{}$使得Casorati行列式$\det C(m)\ne0$，于是此时的Casorati矩阵$C(n)$可逆。任取$L(x_m)=0$的一个解$\{y_m\}$，则$y_m,\mathcal{B}y_m,\dots,\mathcal{B}^{n-1}y_m$是确定的数，于是关于$(\seq{c}{n})^T$的线性方程组：
	\begin{equation*}
		\begin{pmatrix}
			x_m^{(1)} & x_m^{(2)} & \cdots & x_m^{(n)} \\
			\mathcal{B}x_m^{(1)} & \mathcal{B}x_m^{(2)} & \cdots & \mathcal{B}x_m^{(n)} \\
			\vdots & \vdots & \ddots & \vdots \\
			\mathcal{B}^{n-1}x_m^{(1)} & \mathcal{B}^{n-1}x_m^{(2)} & \cdots & \mathcal{B}^{n-1}x_m^{(n)} \\
		\end{pmatrix}
		\begin{pmatrix}
			c_1 \\
			c_2 \\
			\cdots \\
			c_n
		\end{pmatrix}=
		\begin{pmatrix}
			y_m \\
			\mathcal{B}y_m \\
			\vdots \\
			\mathcal{B}^{n-1}y_m
		\end{pmatrix}
	\end{equation*}
	存在唯一解$(\seq{c^*}{n})^T$，即在这$n$个位置处$\{y_m\}$可以由$\{x_m^{(1)}\},\{x_m^{(2)}\},\dots,\{x_m^{(n)}\}$线性表出。令：
	\begin{equation*}
		z_m=c_1^*x_m^{(1)}+c_2^*x_m^{(2)}+\cdots+c_n^*x_m^{(n)},\;\forall\;m\in\mathbb{Z}^{}
	\end{equation*}
	则$\{z_m\}$在这$n$个位置处的值等于$\{y_m\}$对应位置上的值，且$\{z_m\}$可以由$\{x_m^{(1)}\},\{x_m^{(2)}\},\dots,\{x_m^{(n)}\}$线性表出。而由\cref{theo:LinearDifferenceEqExistenceUniqueness}可知$L(x_m)=0$的解由任意的$n$个初始值唯一确定，于是$\{y_m\}$就是$\{z_m\}$，所以它也可以由$\{x_m^{(1)}\},\{x_m^{(2)}\},\dots,\{x_m^{(n)}\}$线性表出。由$\{y_m\}$的任意性，结论成立。
\end{proof}
\begin{corollary}\label{cor:LinearSpaceSolutionHomogeneousLinearDifferenceEquation}
	$n$阶齐次线性差分方程的所有解构成一个$n$维线性空间。
\end{corollary}
\begin{definition}
	称$n$阶齐次线性差分方程的任意$n$个线性无关的解为其\textbf{基本解组}。
\end{definition}
\subsubsection{非齐次线性差分方程解的一般理论}
\begin{theorem}\label{theo:DifStillSolutionHomogeneousLinearDifferenceEquation}
	$n$阶非齐次线性差分方程$L(x_m)=f(m)$任意两个解的差是$n$阶齐次线性差分方程$L(x_m)=0$的解。
\end{theorem}
\begin{theorem}\label{theo:AddStillSolutionNonhomogeneousLinearDifferenceEquation}
	$n$阶非齐次线性差分方程$L(x_m)=f(m)$任意一个解与$n$阶齐次线性差分方程$L(x_m)=0$任意一个解的和还是$L(x_m)=f(m)$的解。
\end{theorem}
\begin{theorem}\label{theo:GeneralSolutionNonhomogeneousLinearDifferenceEquation}
	设$\{x_m^{(1)}\},\{x_m^{(2)}\},\dots,\{x_m^{(n)}\}$是$n$阶齐次线性差分方程$L(x_m)=0$的基本解组，$\{y_m\}$是$n$阶非齐次线性差分方程$L(x_m)=f(m)$的一个解，则$L(x_m)=f(m)$的通解可表示为：
	\begin{equation*}
		x_m=y_m+c_1x_m^{(1)}+c_2x_m^{(2)}+\cdots+c_nx_m^{(n)},\;\forall\;m\in\mathbb{Z}^{}
	\end{equation*}
\end{theorem}
\begin{proof}
	对任意的$\{y_m\}$，由\cref{theo:DifStillSolutionHomogeneousLinearDifferenceEquation}和\cref{theo:GeneralSolutionHomogeneousLinearDifferenceEquation}可知$L(x_m)=f(m)$的任意一个解可以表示为上述形式。由$\{y_m\}$的任意性可得出结论。
\end{proof}

\subsection{$n$阶常系数线性差分方程}
\begin{definition}
	若$n$阶线性差分方程：
	\begin{equation*}
		x_m+a_1(m)x_{m-1}+a_2(m)x_{m-2}+\cdots+a_n(m)x_{m-n}=f(m)
	\end{equation*}
	中$a_1(x),a_2(x),\dots,a_n(x)$都是常数，则称上述方程为关于$\{x_m\}$的$n$阶常系数线性差分方程。
\end{definition}
\subsubsection{常系数齐次线性差分方程解的一般理论}
\begin{derivation}
	取一个一阶常系数齐次线性差分方程$x_m+a_1x_{m-1}=0$，可以看出该方程的通解为$x_m=C(-a_1)^m,\;\forall\;m\in\mathbb{Z}^{}$，其中$C$为任意常数。受此启发，我们对于$n$阶常系数齐次线性差分方程寻找指数形式的解。
\end{derivation}
\begin{definition}
	称：
	\begin{equation*}
		\lambda^n+a_1\lambda^{n-1}+a_2\lambda^{n-2}+\cdots+a_{n-1}\lambda+a_n=0
	\end{equation*}
	为$n$阶常系数齐次线性差分方程：
	\begin{equation*}
		x_m+a_1x_{m-1}+a_2x_{m-2}+\cdots+a_nx_{m-n}=0
	\end{equation*}
	的\textbf{特征方程}，等号左边关于$\lambda$的多项式被称为\textbf{特征多项式}，记为$l(\lambda)$。
\end{definition}
\begin{theorem}\label{theo:GeneralSolutionHomogeneousLinearDifferenceEqConstantCoefficients}
	设$\seq{\lambda}{s}$是$n$阶常系数齐次线性差分方程$L(x_m)=0$的特征方程$l(\lambda)=0$的解，其重数分别为$\seq{r}{s}$，则$L(x_m)=0$的通解可以表示为：
	\begin{equation*}
		x_m=\sum_{i=1}^{s}\sum_{j=0}^{r_i-1}c_{ij}m^{j}\lambda_i^m,\;\forall\;m\in\mathbb{Z}^{}
	\end{equation*}
	其中$c_{ij},\;i=1,2,\dots,s,\;j=0,1,\dots,r_i-1$为常数。
\end{theorem}
\begin{proof}
	\textbf{情况一：}此时特征方程有$n$个互不相同的实根，分别设为$\seq{\lambda}{n}$。将$\{\lambda_i^m\},\;i=1,2,\dots,n$代入$L(x_m)=0$中可以发现：
	\begin{align*}
		&\lambda_i^m+a_1\lambda_i^{m-1}+a_2\lambda_i^{m-2}+\cdots+a_n\lambda_i^{m-n} \\
		=&\lambda_i^{m-n}(\lambda_i^n+a_1\lambda_i^{n-1}+a_2\lambda_i^{n-2}+\cdots+a_n)=0
	\end{align*}
	所以它们就是$L(x_m)=0$的解。由$n$阶线性差分方程的定义，$a_n\ne0$，所以$\lambda_i\ne0$。于是有：
	\begin{equation*}
		\det C(0)=
		\begin{vmatrix}
			1 & 1 & \cdots & 1 \\
			\lambda_1^{-1} & \lambda_2^{-1} & \cdots & \lambda_n^{-1} \\
			\lambda_1^{-2} & \lambda_2^{-2} & \cdots & \lambda_n^{-2} \\
			\vdots & \vdots & \ddots & \vdots \\
			\lambda_1^{-(n-1)} & \lambda_2^{-(n-1)} & \cdots & \lambda_n^{-(n-1)} \\
		\end{vmatrix}
		=\prod_{1\leqslant i<j\leqslant n}(\lambda_j-\lambda_i)\ne0
	\end{equation*}
	由\cref{cor:CasoratiNe0LinearIndependent}可知这$n$个解线性无关，所以构成一个基本解组。\par
	\textbf{情况二：}此时特征方程存在重实根。假设根$\lambda_i$的重数为$r_i$，代入可知$\{\lambda_i^m\}$是$L(x_m)=0$的解。下证明对$1\leqslant b\leqslant r_i-1$且$b\in\mathbb{N}^+$，$\{m^b\lambda_i^m\}$都是$L(x_m)=0$的解。设$a_0=1$，则：
	\begin{align*}
		&m^{b}\lambda_i^m+a_1(m-1)^{b}\lambda_i^{m-1}+\cdots+a_{n}(m-n)^{b}\lambda_i^{m-n} \\
		=&\sum_{k=0}^{n}a_k(m-k)^b\lambda_i^{m-k} =\sum_{k=0}^{n}a_k\sum_{j=0}^{b}\binom{b}{j}m^j(-k)^{b-j}\lambda_i^{m-k} \\
		=&\sum_{k=0}^{n}\sum_{j=0}^{b}a_k\binom{b}{j}m^j(-k)^{b-j}\lambda_i^{m-k}
		=\sum_{j=0}^{b}\sum_{k=0}^{n}a_k\binom{b}{j}m^j(-k)^{b-j}\lambda_i^{m-k} \\
		=&\sum_{j=0}^{b}\binom{b}{j}m^j\sum_{k=0}^{n}a_k(-k)^{b-j}\lambda_i^{m-k}=\lambda_i^m\sum_{j=0}^{b}\binom{b}{j}m^j\sum_{k=0}^{n}a_k(-k)^{b-j}\lambda_i^{-k}
	\end{align*}
	取函数$f(\lambda_i)=\sum\limits_{k=0}^{n}a_k\lambda_i^{-k}$，则：
	\begin{equation*}
		\sum_{k=0}^{n}a_k(-k)^{b-j}\lambda_i^{-k}
	\end{equation*}
	可以表示为$f(\lambda_i),f'(\lambda_i),\dots,f^{(b-j)}(\lambda_i)$的线性组合。考虑特征多项式$l(\lambda_i)$：
	\begin{equation*}
		l(\lambda_i)=\lambda_i^n+a_1\lambda_i^{n-1}+a_2\lambda_i^{n-2}+\cdots+a_{n-1}\lambda_i+a_n=\sum_{k=0}^{n}a_k\lambda_i^{n-k}=\lambda_i^nf(\lambda_i)
	\end{equation*}
	于是有：
	\begin{equation*}
		f(\lambda_i)=\frac{l(\lambda_i)}{\lambda_i^n}
	\end{equation*}
	所以$f^{(b-j)}(\lambda_i)$可以由$l(\lambda_i),l'(\lambda_i),\dots,l^{(b-j)}(\lambda_i)$线性表出。于是：
	\begin{align*}
		&m^{b}\lambda_i^m+a_1(m-1)^{b}\lambda_i^{m-1}+\cdots+a_{n}(m-n)^{b}\lambda_i^{m-n} \\
		=&\lambda_i^m\sum_{j=0}^{b}\binom{b}{j}m^j\sum_{k=0}^{n}a_k(-k)^{b-j}\lambda_i^{-k}=\lambda_i^m\sum_{j=0}^{b}\binom{b}{j}m^jg[l(\lambda_i),l'(\lambda_i),\dots,l^{(b-j)}(\lambda_i)]
	\end{align*}
	其中$g$是$l(\lambda_i),l'(\lambda_i),\dots,l^{(b-j)}(\lambda_i)$的线性函数。因为$\lambda_i$是特征方程的$r_i$重根，所以：
	\begin{equation*}
		l(\lambda)=(\lambda-\lambda_i)^{r_i}h(\lambda)=0
	\end{equation*}
	求导可知$l(\lambda_i)=l'(\lambda_i)=\cdots=l^{(b-j)}(\lambda_i)=0$，所以$g=0$，即：
	\begin{equation*}
		m^{b}\lambda_i^m+a_1(m-1)^{b}\lambda_i^{m-1}+\cdots+a_{n}(m-n)^{b}\lambda_i^{m-n}=0
	\end{equation*}
	所以$\{m^b\lambda_i^m\},\;b=0,1,2,\dots,r_i-1$都是$L(x_m)=0$的解。\par
	若$\{m^b\lambda_i^m\},\;b=0,1,2,\dots,r_i-1$线性相关，则存在不全为$0$的$\seq{c}{r_i}$使得：
	\begin{equation*}
		c_1\lambda_i^m+c_2m\lambda_i^m+\cdots+c_{r_i}m^{r_i-1}\lambda_i^m=\lambda_i^m(c_1+c_2m+\cdots+c_{r_i}m^{r_i-1})=0
	\end{equation*}
	对任意的$m\in\mathbb{Z}$成立。由$n$阶线性差分方程的定义，$a_n\ne0$，所以$\lambda_i\ne0$，于是需要上式中关于整数$m$的多项式恒等于$0$，此时应有$c_1=c_2=\cdots=c_{r_i}=0$，矛盾，所以$\{m^b\lambda_i^m\},\;b=0,1,2,\dots,r_i-1$线性无关。\info{不同$\lambda_i$之间的线性无关性涉及到广义Vandermonde行列式，以后再写}\par
	\textbf{情形三：}此时特征方程存在一对共轭复根$a+bi,a-bi$，令：
	\begin{equation*}
		\rho=\sqrt{a^2+b^2},\;\theta=\arctan\left(\frac{b}{a}\right)
	\end{equation*}
	则：
	\begin{gather*}
		(a+bi)^m=(\rho e^{i\theta})^m=\rho^m[\cos(m\theta)+i\sin(m\theta)],\;\forall\;m\in\mathbb{Z}^{} \\
		(a-bi)^m=(\rho e^{-i\theta})^m=\rho^m[\cos(m\theta)-i\sin(m\theta)],\;\forall\;m\in\mathbb{Z}^{}
	\end{gather*}
	都是$L(x_m)$的解。\par
	综上可得出定理的结论。
\end{proof}
\subsubsection{常系数齐次线性差分方程解的收敛性}
\begin{derivation}
	设$\seq{\lambda}{s}$为$n$阶常系数齐次线性差分方程$L(x_m)=0$的特征方程$l(\lambda)=0$的解。\par
	\textbf{(1)$\;\lambda_i$都在单位圆内：}此时存在$\alpha$使得：
	\begin{equation*}
		\min\{|\lambda_i|:i=1,2,\dots,s\}<\alpha<1
	\end{equation*}
	于是$L(x_m)=0$的任何解$\{x_m\}$满足：
	\begin{equation*}
		|x_m|=\left|\sum_{i=1}^{s}\sum_{j=0}^{r_i-1}c_{ij}m^{j}\lambda_i^m\right|\leqslant\sum_{i=1}^{s}\sum_{j=0}^{r_i-1}|c_{ij}m^{j}|\;|\lambda_i^m|\leqslant\sum_{i=1}^{s}\sum_{j=0}^{r_i-1}|c_{ij}m^{j}|\alpha^m
	\end{equation*}
	由指数函数$\alpha^m$与幂函数$m^j$的收敛速度比较可得：
	\begin{equation*}
		\lim_{m\to+\infty}|x_m|=0
	\end{equation*}
	此时称$\{x_m\}$\textbf{以负指数收敛到$0$}。\par
	\textbf{(2)$\;\lambda_i$在单位圆上：}设$\lambda_i=a+bi$，由\cref{theo:GeneralSolutionHomogeneousLinearDifferenceEqConstantCoefficients}可知此时$L(x_m)=0$有解：
	\begin{equation*}
		x_m=\cos(m\theta)+i\sin(m\theta),\;\theta=\arctan\left(\frac{b}{a}\right),\;\forall\;m\in\mathbb{Z}^{}
	\end{equation*}
	当$\theta=\dfrac{\pi}{4}$时，这个解不收敛，是一个周期解。\par
	\textbf{(3)$\;\lambda_i$在单位圆外：}显然此时存在发散于$+\infty$的解。
\end{derivation}
\subsubsection{常系数非齐次线性差分方程解的一般理论}
\begin{theorem}\label{theo:GeneralSolutionNonhomogeneousLinearDifferenceEqConstantCoefficients}
	设$\seq{\lambda}{s}$是$n$阶常系数齐次线性差分方程$L(x_m)=0$的特征方程$l(\lambda)=0$的互异根，其重数分别为$\seq{r}{s}$，$n$阶常系数非齐次线性差分方程$L(x_m)=f(m)$的一个特解为$\{y_m\}$，则$L(x_m)=f(m)$的通解可以表示为：
	\begin{equation*}
		x_m=y_m+\sum_{i=1}^{s}\sum_{j=0}^{r_i-1}c_{ij}m^{j}\lambda_i^m,\;\forall\;m\in\mathbb{Z}^{}
	\end{equation*}
	其中$c_{ij},\;i=1,2,\dots,s,\;j=0,1,\dots,r_i-1$为常数。
\end{theorem}
\begin{proof}
	由\cref{theo:GeneralSolutionNonhomogeneousLinearDifferenceEquation}和\cref{theo:GeneralSolutionHomogeneousLinearDifferenceEqConstantCoefficients}可直接得到。
\end{proof}

\section{ARIMA}
\subsection{AR模型}
\begin{definition}
	如果$\{\varepsilon_t\}$是$\operatorname{WN}(0,\sigma^2)$，实数$\seq{a}{p}(a_p\ne0)$使得多项式$A(z)=0$的根都在单位圆外：
	\begin{equation*}
		A(z)=1-\sum_{i=1}^{p}a_iz^i\ne0,\quad\forall\;|z|\leqslant1
	\end{equation*}
	则称$p$阶常系数线性差分方程：
	\begin{equation*}
		X_t=\sum_{i=1}^{p}a_iX_{t-i}+\varepsilon_t
	\end{equation*}
	为$p$\textbf{阶自回归模型}，简记为$\operatorname{AR}(p)$模型。称满足$\operatorname{AR}(p)$模型的平稳时间序列$\{X_t\}$为$\operatorname{AR}(p)$序列，称$\seq{a}{p}$为$\operatorname{AR}(p)$模型的\textbf{自回归系数}，多项式$A(z)=0$的根都在单位圆外这一条件被称为\textbf{稳定性条件}，分别称$A(z)$和$A(\mathcal{B})$为$\operatorname{AR}(p)$模型的\textbf{特征多项式}和\textbf{自回归系数多项式}。可以用$A(\mathcal{B})$将模型改写为$A(\mathcal{B})X_t=\varepsilon_t$。
\end{definition}
\begin{derivation}
	$A(z)=0$的解为$p$阶常系数线性差分方程特征方程：
	\begin{equation*}
		\lambda^p-a_1\lambda^{p-1}-\cdots-a_{p-1}\lambda-a_p=0
	\end{equation*}
	的解的倒数。取特征方程的任一根$\lambda_j$，则：
	\begin{equation*}
		A\left(\frac{1}{\lambda_j}\right)=1-\sum_{i=1}^{p}a_i\frac{1}{\lambda_j^i}=\frac{1}{\lambda_j^p}(\lambda_j^p-a_1\lambda_j^{p-1}-\cdots-a_{p-1}\lambda_j-a_{p})=0
	\end{equation*}
	所以上述稳定性条件即为要求$p$阶常系数线性差分方程特征方程的根都在单位圆内。
\end{derivation}
\begin{theorem}\label{theo:ARPSolution}
	设$\operatorname{AR}(p)$模型的特征多项式$A(z)=0$有$s$个互异根$\seq{z}{s}$，根的重数分别为$\seq{r}{s}$，$1<\rho<\min\limits_i\{|z_i|\}$，则：
	\begin{enumerate}
		\item $\operatorname{AR}(p)$模型的唯一平稳解是：
		\begin{equation*}
			X_t=\sum_{i=0}^{+\infty}\psi_i\varepsilon_{t-i}
		\end{equation*}
		其中$\psi_i$为$A^{-1}(z)$在$\{z:|z|\leqslant\rho\}$内展开的幂级数的系数，称之为\textbf{Wold系数}，$\{\psi_n\}\in l^1$。对$j<0$定义$\psi_j=0$，那么它具有递推公式：
		\begin{equation*}
			\psi_0=1,\quad\psi_j=\sum_{i=1}^{p}a_i\psi_{j-i},\;\forall\;j\geqslant1
		\end{equation*}
		\item $\operatorname{AR}(p)$模型的通解为：
		\begin{equation*}
			\sum_{i=0}^{+\infty}\psi_i\varepsilon_{t-i}+\sum_{i=1}^{s}\sum_{j=0}^{r_i-1}c_{ij}t^{j}z_i^{-t}
		\end{equation*}
		其中$c_{ij}$为任意常数；
		\item $\operatorname{AR}(p)$模型的任一解都以负指数阶的速度收敛到平稳解，$\min\limits_i{|z_i|}$越大，收敛越快。
	\end{enumerate}
\end{theorem}
\begin{proof}
	(1)由复变函数的知识，$A^{-1}(z)$在$\{z:|z|\leqslant\rho\}$内解析，即$A^{-1}(z)$有如下展开：
	\begin{equation*}
		A^{-1}(z)=\sum_{i=0}^{+\infty}\psi_iz^i,\quad|z|\leqslant\rho
	\end{equation*}
	且这个级数是绝对收敛的。由绝对收敛性可知$|\psi_iz^i|\to0$，即$|\psi_i|=o(\rho^{-i})$，所以$\{\psi_i\}\in l^1$，由\cref{theo:l1LinearlyStationarySeries}可知$\{X_t\}$是平稳序列。\par
	令$a_0=-1$，对$k<0$定义$\psi_k=0$。注意到：
	\begin{align*}
		A(\mathcal{B})X_t&=\left(1-\sum_{i=1}^{p}a_i\mathcal{B}^i\right)X_t=\left(-a_0-\sum_{i=1}^{p}a_i\mathcal{B}^i\right)X_t=-\sum_{i=0}^{p}a_i\mathcal{B}^iX_t \\
		&=-\sum_{i=0}^{p}a_iX_{t-i}=-\sum_{i=0}^{p}a_{i}\sum_{j=0}^{+\infty}\psi_j\varepsilon_{t-i-j}=-\sum_{j=0}^{+\infty}\sum_{i=0}^{p}a_i\psi_j\varepsilon_{t-i-j} \\
		&=-\sum_{j=0}^{+\infty}\sum_{i=0}^{p}a_i\psi_{j-i}\varepsilon_{t-j}=-\sum_{j=0}^{+\infty}\left(\sum_{i=0}^{p}a_i\psi_{j-i}\right)\varepsilon_{t-j}
	\end{align*}
	因为$\{\psi_i\}\in l^1$，所以对$|z|\leqslant1$级数$\sum\limits_{j=0}^{+\infty}\psi_jz^j$是良定义的。由：
	\begin{align*}
		1&=A(z)A^{-1}(z)=\left(1-\sum_{i=1}^{p}a_iz^i\right)A^{-1}(z)=-\sum_{i=0}^{p}a_iz^i\sum_{j=0}^{+\infty}\psi_jz^j \\
		&=-\sum_{i=0}^{p}\sum_{j=0}^{+\infty}a_iz^i\psi_jz^j=-\sum_{j=0}^{+\infty}\sum_{i=0}^{p}a_i\psi_jz^{i+j}=-\sum_{j=0}^{+\infty}\left(\sum_{i=0}^{p}a_i\psi_{j-i}\right)z^j
	\end{align*}
	最后一步是求和换元后的结果。对比系数可得（递推公式）：
	\begin{equation*}
		-\sum_{i=0}^{p}a_i\psi_{-i}=1,\quad-\sum_{i=0}^{p}a_i\psi_{j-i}=0,\;\forall\;j\geqslant1
	\end{equation*}
	于是：
	\begin{equation*}
		A(\mathcal{B})X_t=-\sum_{j=0}^{+\infty}\left(\sum_{i=0}^{p}a_i\psi_{j-i}\right)\varepsilon_{t-j}=-\sum_{i=0}^{p}a_i\psi_{-i}\varepsilon_t-\sum_{j=1}^{+\infty}\left(\sum_{i=0}^{p}a_i\psi_{j-i}\right)\varepsilon_{t-j}=\varepsilon_t
	\end{equation*}
	所以$\{X_t\}$是解。\par
	设还有另一平稳解$\{Y_t\}$，即$A(\mathcal{B})Y_t=\varepsilon_t$且$A^{-1}(\mathcal{B})$存在，则：
	\begin{equation*}
		Y_t=A^{-1}(\mathcal{B})\varepsilon_t=A^{-1}(\mathcal{B})A(\mathcal{B})X_t=X_t
	\end{equation*}\par
	综上，$\{X_t\}$是$\operatorname{AR}(p)$模型唯一的平稳解。\par
	(2)由(1)、\cref{theo:GeneralSolutionNonhomogeneousLinearDifferenceEquation}与\cref{theo:GeneralSolutionHomogeneousLinearDifferenceEqConstantCoefficients}即可得通解为：
	\begin{equation*}
		X_t+\sum_{i=1}^{s}\sum_{j=0}^{r_i-1}c_{ij}t^{j}z_i^{-t}=\sum_{i=0}^{+\infty}\psi_i\varepsilon_{t-i}+\sum_{i=1}^{s}\sum_{j=0}^{r_i-1}c_{ij}t^{j}z_i^{-t}
	\end{equation*}\par
	(3)由(1)(2)可得对于$\operatorname{AR}(p)$模型的任一解$\{Y_t\}$有：
	\begin{equation*}
		|X_t-Y_t|=\left|\sum_{i=1}^{s}\sum_{j=0}^{r_i-1}c_{ij}t^{j}z_i^{-t}\right|\leqslant O\left[\left(\min_i\{|z_i|\}\right)^{-t}\right]\qedhere
	\end{equation*}
\end{proof}
\begin{note}
	上述定理给了我们一个产生$\operatorname{AR}(p)$序列的方式。先任意选择$p$个初始值，然后根据自回归系数产生序列$\{Y_t\}$。因为任意的$\{Y_t\}$都以负指数阶的速度收敛到平稳解，取一个较大的$m$然后令$X_t=Y_{m+t}$即可得到近似的$\operatorname{AR}(p)$序列$\{X_t\}$。
\end{note}
\begin{property}\label{prop:ARp}
	$\operatorname{AR}(p)$序列$\{X_t\}$具有如下性质：
	\begin{enumerate}
		\item 对任意的$i\geqslant1$且$i\in\mathbb{N}^+$，$X_t$与$\varepsilon_{t+i}$不相关；
		\item $\gamma(n)=\sigma^2\sum\limits_{i=0}^{+\infty}\psi_i\psi_{i+n}$；
		\item (Yule-Walker方程)$\;\{X_t\}$的自协方差函数满足：
		\begin{gather*}
			\boldsymbol{\gamma}_n=\Gamma_n\alpha,\;
			\gamma(0)=\boldsymbol{\gamma}_n^T\alpha+\sigma^2,\quad n\geqslant p \\
			\boldsymbol{\gamma}_n=
			\begin{pmatrix}
				\gamma(1) \\
				\gamma(2) \\
				\vdots \\
				\gamma(n)
			\end{pmatrix},\;
			\Gamma_n=
			\begin{pmatrix}
				\gamma(0) & \gamma(1) & \cdots & \gamma(n-1) \\
				\gamma(1) & \gamma(0) & \cdots & \gamma(n-2) \\
				\vdots & \vdots & \ddots & \vdots \\
				\gamma(n-1) & \gamma(n-2) & \cdots & \gamma(0) \\
			\end{pmatrix} \\
			\alpha=(\seq{a}{p},0,0,\dots,0)^T
		\end{gather*}
		\item $\operatorname{AR}(p)$序列的自协方差函数和自相关函数满足和$\operatorname{AR}(p)$模型相对应的常系数齐次线性差分方程：
		\begin{gather*}
			\gamma(n)=a_1\gamma(n-1)+a_2\gamma(n-2)\cdots+a_p\gamma(n-p) \\
			\rho(n)=a_1\rho(n-1)+a_2\rho(n-2)\cdots+a_p\rho(n-p)
		\end{gather*}
		\item $\{X_t\}$的自协方差函数与自相关函数具有拖尾性，即$\gamma(n)$和$\rho(n)$始终不为$0$，且二者的模随着$n$的增大指数衰减到$0$；
		\item $\{X_t\}$具有如下谱密度函数：
		\begin{equation*}
			f(\lambda)=\frac{\sigma^2}{2\pi}\left|\sum_{j=0}^{+\infty}\psi_je^{ij\lambda}\right|^2=\frac{\sigma^2}{2\pi|A(e^{i\lambda})|^2}=\frac{1}{2\pi}\sum_{n=-\infty}^{+\infty}\gamma(n)e^{in\lambda},\quad\lambda\in[-\pi,\pi]
		\end{equation*}
		\item $\{X_t\}$的自协方差矩阵为正定矩阵；
		\item $\{X_t\}$是最小序列；
	\end{enumerate}
\end{property}
\begin{proof}
	(1)因为$\operatorname{E}(\varepsilon_{t+i})=0$，由\cref{prop:NonnegativeMeasurableIntegral}(9)可知$\varepsilon_{t+i}\;$a.e.有限，由\cref{theo:l1LinearlyStationarySeries}可知$X_t\;$a.e.有限，于是$X_t\varepsilon_{t+i}$良定义。根据\cref{prop:NonnegativeMeasurableIntegral}(4)(6)可知：
	\begin{align*}
		\operatorname{E}\left(\sum_{j=0}^{+\infty}|\psi_j\varepsilon_{t-j}\varepsilon_{t+i}|\right)
		&=\lim_{n\to+\infty}\operatorname{E}\left(\sum_{j=0}^{n}|\psi_j\varepsilon_{t-j}\varepsilon_{t+i}|\right)
		=\lim_{n\to+\infty}\left[\sum_{j=0}^{n}|\psi_j|\operatorname{E}(|\varepsilon_{t-j}\varepsilon_{t+i}|)\right] \\
		&=\sum_{j=0}^{+\infty}|\psi_j|\operatorname{E}(|\varepsilon_{t-j}\varepsilon_{t+i}|)
	\end{align*}
	由\cref{ineq:cauchy-schiwarz-expectations}可知：
	\begin{equation*}
		\operatorname{E}(|\varepsilon_{t-j}\varepsilon_{t+i}|)=\Big|\operatorname{E}(|\varepsilon_{t-j}\varepsilon_{t+i}|)\Big|\leqslant\sqrt{\operatorname{E}(\varepsilon_{t-j}^2)\operatorname{E}(\varepsilon_{t+i}^2)}=\sigma^2
	\end{equation*}
	由\cref{theo:ARPSolution}(1)可得$\{\psi_i\}\in l^1$，所以：
	\begin{equation*}
		\operatorname{E}\left(\sum_{j=0}^{+\infty}|\psi_j\varepsilon_{t-j}\varepsilon_{t+i}|\right)\leqslant\sigma^2\sum_{j=0}^{+\infty}|\psi_j|<+\infty
	\end{equation*}
	取控制函数$\sum\limits_{j=0}^{+\infty}|\psi_j\varepsilon_{t-j}\varepsilon_{t+i}|$，由\cref{theo:DominatedConvergenceTheorem}和\cref{prop:NonnegativeMeasurableIntegral}(6)可得：
	\begin{align*}
		\operatorname{E}(X_t\varepsilon_{t+i})&=\operatorname{E}\left(\sum_{j=0}^{+\infty}\psi_j\varepsilon_{t-j}\varepsilon_{t+i}\right)=\operatorname{E}\left[\lim_{n\to+\infty}\left(\sum_{j=0}^{n}\psi_j\varepsilon_{t-j}\varepsilon_{t+i}\right)\right] \\
		&=\lim_{n\to+\infty}\operatorname{E}\left(\sum_{j=0}^{n}\psi_j\varepsilon_{t-j}\varepsilon_{t+i}\right)=\lim_{n\to+\infty}\left[\sum_{j=0}^{n}\psi_j\operatorname{E}(\varepsilon_{t-j}\varepsilon_{t+i})\right]=0
	\end{align*}\par
	(2)由\cref{prop:LinearlyStationarySeries}(1)和\cref{theo:ARPSolution}(1)立即可得。\par
	(3)由$\operatorname{AR}(p)$模型的定义可得：
	\begin{equation*}
		\begin{pmatrix}
			X_t \\
			X_{t+1} \\
			\vdots \\
			X_{t+n-1}
		\end{pmatrix}=
		\begin{pmatrix}
			X_{t-1} & X_{t-2} & \cdots & X_{t-n} \\
			X_{t} & X_{t-1} & \cdots & X_{t-n+1} \\
			\vdots & \vdots & \ddots & \vdots \\
			X_{t+n-2} & X_{t+n-3} & \cdots & X_{t-1}
		\end{pmatrix}\alpha+
		\begin{pmatrix}
			\varepsilon_t \\
			\varepsilon_{t+1} \\
			\vdots \\
			\varepsilon_{t+n-1}
		\end{pmatrix}
	\end{equation*}
	于是：
	\begin{gather*}
		X_{t-1}
		\begin{pmatrix}
			X_t \\
			X_{t+1} \\
			\vdots \\
			X_{t+n-1}
		\end{pmatrix}=X_{t-1}
		\begin{pmatrix}
			X_{t-1} & X_{t-2} & \cdots & X_{t-n} \\
			X_{t} & X_{t-1} & \cdots & X_{t-n+1} \\
			\vdots & \vdots & \ddots & \vdots \\
			X_{t+n-2} & X_{t+n-3} & \cdots & X_{t-1}
		\end{pmatrix}\alpha_n+X_{t-1}
		\begin{pmatrix}
			\varepsilon_t \\
			\varepsilon_{t+1} \\
			\vdots \\
			\varepsilon_{t+n-1}
		\end{pmatrix} \\
		\boldsymbol{\gamma}_n=\Gamma_n\alpha,\quad n\geqslant p
	\end{gather*}
	第二行是对第一行取期望的结果。对于$\gamma(0)$，由(1)可得：
	\begin{align*}
		\gamma(0)&=\operatorname{E}(X_t^2)=\operatorname{E}\left(\sum_{i=1}^{p}a_iX_{t-i}+\varepsilon_t\right)^2=\operatorname{E}\left(\sum_{i=1}^{p}a_iX_{t-i}\right)^2+\operatorname{E}(\varepsilon_t)^2 \\
		&=\alpha^T\Gamma_n\alpha+\sigma^2=\alpha^T\boldsymbol{\gamma}_n+\sigma^2,\quad n\geqslant p
	\end{align*}\par
	(4)由(3)和\cref{theo:RhotGamma0}立即可得。\par
	(5)由\cref{theo:GeneralSolutionHomogeneousLinearDifferenceEqConstantCoefficients}和(4)可知$\gamma(n)$和$\rho(n)$的通解都具有如下形式：
	\begin{equation*}
		\sum_{i=1}^{s}\sum_{j=0}^{r_i-1}c_{ij}n^{j}\lambda_i^n,\;\forall\;n\in\mathbb{N}
	\end{equation*}
	其中$\seq{\lambda}{s}$为对应常系数齐次线性差分方程的特征方程的根，$c_{ij}$为任意常数。若$c_{ij}$全为$0$，则$\gamma(0),\rho(0)$都为$0$，所以它们不可能全为$0$.由$\operatorname{AR}(p)$序列的定义，$|\lambda_i|<1$，因为$a_p\ne0$，所以$\lambda_i\ne0$，由此可得$\gamma(n)$和$\rho(n)$始终不为$0$。由指数函数与幂函数的收敛速度比较可知$\gamma(n)$和$\rho(n)$的模随着$n$的增大将以指数阶的速度减小。\par
	(6)由\cref{prop:LinearlyStationarySeries}和\cref{theo:ARPSolution}(1)可知：
	\begin{equation*}
		f(\lambda)=\frac{\sigma^2}{2\pi}\left|\sum_{j=0}^{+\infty}\psi_je^{ij\lambda}\right|^2
	\end{equation*}
	由\cref{theo:SpectralGamma}和\cref{theo:ARPSolution}(1)可得：
	\begin{equation*}
		f(\lambda)=\frac{1}{2\pi}\sum_{n=-\infty}^{+\infty}\gamma(n)e^{-in\lambda}
	\end{equation*}
	根据\cref{theo:ARPSolution}(1)中的论述，有：
	\begin{equation*}
		A^{-1}(z)=\sum_{i=0}^{+\infty}\psi_iz^i,\quad|z|\leqslant\rho
	\end{equation*}
	因为$|e^{i\lambda}|=1<\rho$，所以：
	\begin{equation*}
		\sum_{j=0}^{+\infty}\psi_je^{ij\lambda}=A^{-1}(e^{i\lambda})
	\end{equation*}
	于是：
	\begin{equation*}
		f(\lambda)=\frac{\sigma^2}{2\pi}\left|A^{-1}(e^{i\lambda})\right|^2=\frac{\sigma^2}{2\pi|A(e^{i\lambda})|^2}
	\end{equation*}\par
	(7)由\cref{prop:LinearlyStationarySeries}(4)立即可得。
\end{proof}

\subsection{MA模型}
\begin{definition}
	设$\{\varepsilon_t\}$是$\operatorname{WN}(0,\sigma^2)$，实数$\seq{b}{q}(b_q\ne0)$使得多项式$B(z)=0$的根都在单位圆内：
	\begin{equation*}
		B(z)=1+\sum_{i=1}^{q}b_iz^i\ne0,\quad\forall\;|z|<1
	\end{equation*}
	则称：
	\begin{equation*}
		X_t=\varepsilon_t+\sum_{i=1}^{q}b_i\varepsilon_{t-i},\quad t\in\mathbb{Z}
	\end{equation*}
	为\textbf{$q$阶滑动平均模型}，简记为$\operatorname{MA}(q)$模型。称满足$\operatorname{MA}(q)$模型的平稳时间序列$\{X_t\}$为$\operatorname{MA}(q)$序列。若$B(z)\ne0$对$|z|\leqslant1$成立，则称对应的$\operatorname{MA}(q)$模型为\textbf{可逆的$\operatorname{MA}(q)$模型}，相应的$\operatorname{MA}(q)$序列为\textbf{可逆的$\operatorname{MA}(q)$序列}。可以用$B(\mathcal{B})$将模型改写为$X_t=B(\mathcal{B})\varepsilon_t$。对于可逆的$\operatorname{MA}(q)$模型，$B^{-1}(z)$有如下展开：
	\begin{equation*}
		B^{-1}(z)=\sum_{i=0}^{+\infty}\psi_iz^i,\quad |z|\leqslant1
	\end{equation*}
	于是在可逆情况下还可以将模型改写为：
	\begin{equation*}
		\varepsilon_t=B^{-1}(\mathcal{B})X_t=\sum_{i=0}^{+\infty}\psi_iX_{t-i},\quad t\in\mathbb{Z}^{}
	\end{equation*}
\end{definition}
\begin{theorem}
	设零均值平稳时间序列$\{X_t\}$有自协方差函数$\{\gamma(n)\}$，则$\{X_t\}$是$\operatorname{MA}(q)$序列的充分必要条件为：
	\begin{equation*}
		\gamma(q)\ne 0,\quad\gamma(k)=0,\;\forall\;|k|>q
	\end{equation*}
\end{theorem}
\begin{property}
	$\operatorname{MA}(q)$序列$\{X_t\}$具有如下性质：
	\begin{enumerate}
		\item 令$b_0=1$，则：
		\begin{equation*}
			\operatorname{E}(X_t)=0,\quad\gamma(n)=
			\begin{cases}
				\sigma^2\sum\limits_{i=0}^{q-n}b_ib_{i+n},&0\leqslant k\leqslant q \\
				0, &k>q
			\end{cases}
		\end{equation*}
		\item $\{X_t\}$的自协方差函数$\gamma(n)$和自相关函数$\rho(n)$都具有截尾性，即对任意的$k>q$有$\gamma(k)=\rho(k)=0$；
		\item 若$\{X_t\}$可逆，对$j<0$定义$\psi_j=0$，那么$\{\psi_n\}$具有递推公式：
		\begin{equation*}
			\psi_0=1,\quad\psi_j=-\sum_{i=1}^{q}b_i\psi_{j-i},\;\forall\;j\geqslant1
		\end{equation*}
		\item $\{X_t\}$具有谱密度：
		\begin{equation*}
			f(\lambda)=\frac{\sigma^2}{2\pi}\left|\sum_{j=0}^{q}b_je^{ij\lambda}\right|^2=\frac{\sigma^2}{2\pi}|B(e^{i\lambda})|^2=\frac{1}{2\pi}\sum_{n=-k}^{k}\gamma(n)e^{-in\lambda},\quad\lambda\in[-\pi,\pi]
		\end{equation*}
		\item $\{X_t\}$的自协方差矩阵为正定矩阵；
		\item 若$\{X_t\}$可逆，则$\{X_t\}$是最小序列；若$\{X_t\}$不可逆，则$\{X_t\}$不是最小序列；
	\end{enumerate}
\end{property}
\begin{proof}
	(1)由\cref{theo:ECovFiniteMovingAverage}立即可得。\par
	(2)由(1)和\cref{theo:RhotGamma0}立即得出。\par
	(3)对$k<0$定义$\psi_k=0$，因为$\{X_t\}$可逆，所以：
	\begin{align*}
		1&=B(z)B^{-1}(z)=\left(1+\sum_{i=1}^{q}b_iz^i\right)B^{-1}(z)=\sum_{i=0}^{q}b_iz^i\sum_{j=0}^{+\infty}\psi_jz^j \\
		&=\sum_{i=0}^{q}\sum_{j=0}^{+\infty}b_iz^i\psi_jz^j=\sum_{j=0}^{+\infty}\sum_{i=0}^{q}b_i\psi_jz^{i+j}=\sum_{j=0}^{+\infty}\left(\sum_{i=0}^{q}b_i\psi_{j-i}\right)z^j
	\end{align*}
	对比系数可得（递推公式）：
	\begin{equation*}
		\sum_{i=0}^{q}b_i\psi_{-i}=1,\quad\sum_{i=0}^{q}b_i\psi_{j-i}=0,\;\forall\;j\geqslant1
	\end{equation*}\par
	(4)由\cref{prop:ARp}(6)和$B(z)$的定义立即可得，第三种表达方式由(1)和\cref{theo:SpectralGamma}立即可得。\par
	(5)由(4)和\cref{theo:GammaPositiveDefinite}立即可得。
\end{proof}

\subsection{ARMA}
\begin{definition}
	设$\{\varepsilon_t\}$是$\operatorname{WN}(0,\sigma^2)$，实系数多项式$A(z)=0$和$B(z)=0$没有公共根且满足$b_0=1,\;a_pb_q\ne0$和：
	\begin{equation*}
		A(z)=1-\sum_{i=1}^{p}a_iz^i\ne0,\;|z|\leqslant1\quad B(z)=\sum_{i=0}^{q}b_iz^i\ne0,\;|z|<1
	\end{equation*}
	则称差分方程：
	\begin{equation*}
		X_t=\sum_{i=1}^{p}a_iX_{t-i}+\sum_{i=0}^{q}b_i\varepsilon_{t-i}
	\end{equation*}
	为\textbf{自回归滑动平均模型}，简称为$\operatorname{ARMA}(p,q)$模型。称满足$\operatorname{ARMA}(p,q)$模型的平稳时间序列$\{X_t\}$为$\operatorname{ARMA}(p,q)$序列。可以用$A(\mathcal{B})$与$B(\mathcal{B})$将模型改写为$A(\mathcal{B})X_t=B(\mathcal{B})\varepsilon_t$。若要求$B(z)$在单位圆上也没有根，则称此时的$\operatorname{ARMA}(p,q)$模型为\textbf{可逆的$\operatorname{ARMA}(p,q)$模型}，相应的$\operatorname{ARMA}(p,q)$序列为\textbf{可逆的$\operatorname{ARMA}(p,q)$序列}。对于可逆的$\operatorname{ARMA}(p,q)$模型，令$\seq{z}{s}$为$B(z)=0$的全部互异根，$1<\rho<\min\limits_i\{|z_i|\}$，则$B^{-1}(z)A(z)$在$\{z:|z|\leqslant\rho\}$内解析，从而有如下展开式：
	\begin{equation*}
		B^{-1}(z)A(z)=\sum_{i=0}^{+\infty}\varphi_iz^i,\quad|z|\leqslant\rho
	\end{equation*}
	且这个级数是绝对收敛的。由绝对收敛性可知$|\psi_iz^i|\to0$，即$|\psi_i|=o(\rho^{-i})$，所以$\{\psi_i\}\in l^1$。在$A(\mathcal{B})X_t=B(\mathcal{B})\varepsilon_t$两边同乘$B^{-1}(\mathcal{B})$即可将模型改写为：
	\begin{equation*}
		\varepsilon_t=B^{-1}(\mathcal{B})A(\mathcal{B})=\sum_{i=0}^{+\infty}\varphi_iX_{t-i}
	\end{equation*}\par
	若不对$A(z)$的根与$B(z)$的根做任何限制，称差分方程$A(\mathcal{B})X_t=B(\mathcal{B})\varepsilon_t$为\textbf{广义的$\operatorname{ARMA}(p,q)$模型}。
\end{definition}
\begin{theorem}\label{theo:ARMAPQSolution}
	在$\operatorname{ARMA}(p,q)$模型中，设$A(z)=0$有$s$个互异根$\seq{z}{s}$，根的重数分别为$\seq{r}{s}$，$1<\rho<\min\limits_i\{|z_i|\}$，则：
	\begin{enumerate}
		\item $\operatorname{ARMA}(p,q)$模型的唯一平稳解是：
		\begin{equation*}
			X_t=\sum_{i=0}^{+\infty}\psi_i\varepsilon_{t-i}
		\end{equation*}
		其中$\psi_i$为$\Phi(z)=A^{-1}(z)B(z)$在$\{z:|z|\leqslant\rho\}$内展开的幂级数的系数，称之为\textbf{Wold系数}，$\{\psi_n\}\in l^1$。对$j<0$定义$\psi_j=0$，对$j>q$定义$b_j=0$，那么它具有递推公式：
		\begin{equation*}
			\psi_0=1,\quad\psi_j=b_j+\sum_{i=1}^{p}a_i\psi_{j-i},\;\forall\;j\geqslant1
		\end{equation*}
		\item $\operatorname{ARMA}(p,q)$模型的通解为：
		\begin{equation*}
			\sum_{i=0}^{+\infty}\psi_i\varepsilon_{t-i}+\sum_{i=1}^{s}\sum_{j=0}^{r_i-1}c_{ij}t^{j}z_i^{-t}
		\end{equation*}
		其中$c_{ij}$为任意常数；
		\item $\operatorname{ARMA}(p,q)$模型的任一解都以负指数阶的速度收敛到平稳解，$\min\limits_i{|z_i|}$越大，收敛越快。
	\end{enumerate}
\end{theorem}
\begin{proof}
	(1)因为$A(z)$满足平稳性条件，所以存在$\rho>1$使得在$\{z:|z|\leqslant\rho\}$内$A^{-1}(z)B(z)$解析，从而有展开式：
	\begin{equation*}
		\Phi(z)=A^{-1}(z)B(z)=\sum_{i=0}^{+\infty}\psi_iz^i,\quad|z|\leqslant\rho
	\end{equation*}
	且这个级数是绝对收敛的。由绝对收敛性可知$|\psi_iz^i|\to0$，即$|\psi_i|=o(\rho^{-i})$，所以$\{\psi_i\}\in l^1$，由\cref{theo:l1LinearlyStationarySeries}可知$\{X_t\}$是平稳序列。在
	\begin{equation*}
		X_t=\sum_{i=0}^{+\infty}\psi_i\varepsilon_{t-i}
	\end{equation*}
	两边同乘$A(\mathcal{B})$即可得到$A(\mathcal{B})X_t=B(\mathcal{B})\varepsilon_t$，所以$\{X_t\}$是$\operatorname{ARMA}(p,q)$模型的平稳解。\par
	设还有另一平稳解$\{Y_t\}$，即$A(\mathcal{B})Y_t=B(\mathcal{B})\varepsilon_t$且$A^{-1}(\mathcal{B})$存在，则：
	\begin{equation*}
		Y_t=A^{-1}(\mathcal{B})B(\mathcal{B})\varepsilon_t=X_t
	\end{equation*}\par
	综上，$\{X_t\}$是$\operatorname{ARMA}(p,q)$模型唯一的平稳解。\par
	定义$a_0=-1$，则：
	\begin{align*}
		A(z)\Phi(z)&=\left(1-\sum_{i=1}^{p}a_iz^i\right)\Phi(z)=-\sum_{i=0}^{p}a_iz^i\sum_{j=0}^{+\infty}\psi_jz^j \\
		&=-\sum_{i=0}^{p}\sum_{j=0}^{+\infty}a_iz^i\psi_jz^j=-\sum_{j=0}^{+\infty}\sum_{i=0}^{p}a_i\psi_jz^{i+j}=-\sum_{j=0}^{+\infty}\left(\sum_{i=0}^{p}a_i\psi_{j-i}\right)z^j	
	\end{align*}
	最后一步是求和换元后的结果。又有：
	\begin{equation*}
		A(z)\Phi(z)=B(z)=\sum_{i=0}^{q}b_iz^i
	\end{equation*}
	对比系数可得（递推公式）：
	\begin{equation*}
		-\sum_{i=0}^{p}a_i\psi_{-i}=b_0,\quad-\sum_{i=0}^{p}a_i\psi_{j-i}=b_i,\;\forall\;j\geqslant1
	\end{equation*}\par
	(2)由(1)、\cref{theo:GeneralSolutionNonhomogeneousLinearDifferenceEquation}与\cref{theo:GeneralSolutionHomogeneousLinearDifferenceEqConstantCoefficients}即可得通解为：
	\begin{equation*}
		X_t+\sum_{i=1}^{s}\sum_{j=0}^{r_i-1}c_{ij}t^{j}z_i^t=\sum_{i=0}^{+\infty}\psi_i\varepsilon_{t-i}+\sum_{i=1}^{s}\sum_{j=0}^{r_i-1}c_{ij}t^{j}z_i^{-t}
	\end{equation*}\par
	(3)由(1)(2)可得对于$\operatorname{ARMA}(p,q)$模型的任一解$\{Y_t\}$有：
	\begin{equation*}
		|X_t-Y_t|=\left|\sum_{i=1}^{s}\sum_{j=0}^{r_i-1}c_{ij}t^{j}z_i^{-t}\right|\leqslant O\left[\left(\min_i\{|z_i|\}\right)^{-t}\right]\qedhere
	\end{equation*}
\end{proof}
\begin{note}
	上述定理给了我们一个产生$\operatorname{ARMA}(p,q)$序列的方式。先任意选择$p$个初始值，然后根据自回归系数和白噪声序列产生序列$\{Y_t\}$。因为任意的$\{Y_t\}$都以负指数阶的速度收敛到平稳解，取一个较大的$m$然后令$X_t=Y_{m+t}$即可得到近似的$\operatorname{ARMA}(p,q)$序列$\{X_t\}$。
\end{note}
\begin{property}
	$\operatorname{ARMA}(p,q)$序列$\{X_t\}$具有如下性质：
	\begin{enumerate}
		\item 对任意的$i\geqslant1$且$i\in\mathbb{N}^+$，$X_t$与$\varepsilon_{t+i}$不相关；
		\item $\gamma(n)=\sigma^2\sum\limits_{i=0}^{+\infty}\psi_i\psi_{i+n}$；
		\item (Yule-Walker方程)$\;\{X_t\}$的自协方差函数满足：
		\begin{gather*}
			\gamma(n)-\sum_{i=1}^{p}a_i\gamma(n-i)=
			\begin{cases}
				\sigma^2\sum\limits_{i=n}^{q}b_i\psi_{i-n},&1\leqslant n\leqslant q \\
				0 & n>q
			\end{cases} \\
			\begin{pmatrix}
				\gamma(q+1) \\
				\gamma(q+2) \\
				\vdots \\
				\gamma(q+p)
			\end{pmatrix}=
			\begin{pmatrix}
				\gamma(q) & \gamma(q-1) & \cdots & \gamma(q-p+1) \\
				\gamma(q+1) & \gamma(q) & \cdots & \gamma(q-p+2) \\
				\vdots & \vdots & \ddots & \vdots \\
				\gamma(q+p-1) & \gamma(q+p-2) & \cdots & \gamma(q) \\
			\end{pmatrix}
			\begin{pmatrix}
				a_1 \\
				a_2 \\
				\vdots \\
				a_p
			\end{pmatrix}
		\end{gather*}
		记上述矩阵为$\Gamma_{p,q}$；
		\item $\{X_t\}$的自协方差函数与自相关函数具有截尾性，即对任意的$k>q$有$\gamma(k)=\rho(k)=0$，且二者的模随着$n$的增大指数衰减；
		\item $\{X_t\}$具有谱密度：
		\begin{equation*}
			f(\lambda)=\frac{\sigma^2}{2\pi}\left|\sum_{j=0}^{+\infty}\psi_je^{ij\lambda}\right|^2=\frac{\sigma^2}{2\pi}\left|\frac{B(e^{i\lambda})}{A(e^{i\lambda})}\right|^2=\frac{1}{2\pi}\sum_{n=-\infty}^{+\infty}\gamma(n)e^{-in\lambda}
		\end{equation*}
		\item $\{X_t\}$的自协方差矩阵为正定矩阵；
	\end{enumerate}
\end{property}
\begin{proof}
	(1)由\cref{theo:ARMAPQSolution}(1)和\cref{prop:ARp}(1)立即可得。\par
	(2)由\cref{theo:ARMAPQSolution}(1)和\cref{prop:LinearlyStationarySeries}(1)立即可得。\par
	(3)对$j<0$定义$\psi_j=0$，则：
	\begin{align*}
		\gamma(n)&=\operatorname{E}(X_tX_{t-n})=\operatorname{E}\left[\left(\sum_{i=1}^{p}a_iX_{t-i}+\sum_{i=0}^{q}b_i\varepsilon_{t-i}\right)X_{t-n}\right] \\
		&=\operatorname{E}\left(\sum_{i=1}^{p}a_iX_{t-i}X_{t-n}\right)+\operatorname{E}\left(\sum_{i=0}^{q}b_i\varepsilon_{t-i}X_{t-n}\right) \\
		& =\sum_{i=1}^{p}a_i\gamma(n-i)+\operatorname{E}\left(\sum_{i=0}^{q}b_i\varepsilon_{t-i}\sum_{j=0}^{+\infty}\psi_j\varepsilon_{t-n-j}\right) \\
		&=\sum_{i=1}^{p}a_i\gamma(n-i)+\sigma^2\sum_{j=0}^{q}b_j\psi_{j-n}=\sum_{i=1}^{p}a_i\gamma(n-i)+\sigma^2\sum_{j=n}^{q}b_j\psi_{j-n}
	\end{align*}\par
	(4)截尾性由(3)立即得出。由\cref{ineq:cauchy-ineq-R}、(2)和\cref{theo:ARMAPQSolution}(1)中的$|\psi_i|=o(\rho^{-1})$可得：
	\begin{align*}
		|\gamma(n)|&=\left|\sigma^2\sum_{i=0}^{+\infty}\psi_i\psi_{i+n}\right|\leqslant\sigma^2\sum_{i=0}^{+\infty}|\psi_i||\psi_{i+n}|\leqslant\sigma^2\left(\sum_{i=0}^{+\infty}\psi_i^2\sum_{i=0}^{+\infty}\psi_{i+n}^2\right)^{\frac{1}{2}} \\
		&\leqslant c_0\left(\sum_{i=n}^{+\infty}\rho^{-2i}\right)^{\frac{1}{2}}\leqslant c_1\rho^{-n}
	\end{align*}
	上式第一行到第二行的过程中利用$\{\psi_n\}\in l^1$将第一个求和和$\sigma^2$放缩为$c_0$，最后一个放缩利用$\{\rho^{-2i}\}$的收敛性显然可得，于是由自协方差函数的模随着$n$的增大呈现出指数衰减，根据\cref{theo:RhotGamma0}可得自相关函数的对应结论。\par
	(5)由\cref{prop:LinearlyStationarySeries}(3)和$\Phi(z)$的定义立即可得，第三个表示方法由\cref{theo:ARMAPQSolution}(1)和\cref{theo:SpectralGamma}立即可得。\par
	(6)由(5)和\cref{theo:GammaPositiveDefinite}立即可得。
\end{proof}

\subsection{ARIMA模型}
\begin{definition}
	设$\{\varepsilon_t\}$是$\operatorname{WN}(0,\sigma^2)$，实系数多项式$A(z)=0$和$B(z)=0$没有公共根且满足$b_0=1,\;a_pb_q\ne0$和：
	\begin{equation*}
		A(z)=1-\sum_{i=1}^{p}a_iz^i\ne0,\;|z|\leqslant1\quad B(z)=\sum_{i=0}^{q}b_iz^i\ne0,\;|z|<1
	\end{equation*}
	则称差分方程：
	\begin{equation*}
		A(\mathcal{B})(1-\mathcal{B})^dX_t=B(\mathcal{B})\varepsilon_t
	\end{equation*}
	为\textbf{ARIMA模型}，记为$\operatorname{ARMA}(p,d,q)$模型。若$Y_t=(1-\mathcal{B})^dX_t$是$\operatorname{ARMA}(p,q)$序列，则称$\{X_t\}$是\textbf{$\operatorname{ARIMA}(p,d,q)$序列}。
\end{definition}
\begin{theorem}
	$\operatorname{ARIMA}(p,d,q)$模型的通解为：
	\begin{equation*}
		X_t=\sum_{i=0}^{d-1}c_it^{i}+\sum_{n_{d-1}=1}^{t}\cdots\sum_{n_1=1}^{n_2}\sum_{i=1}^{n_1}Y_i
	\end{equation*}
	其中$c_i$为随机变量。
\end{theorem}
\begin{proof}
	当$k=1$时，给定初值$X_0$，有：
	\begin{align*}
		X_t=X_{t-1}+Y_t=X_{t-2}+Y_{t-1}+Y_t=\cdots=X_0+\sum_{i=1}^{t}Y_i=X_0t^0+\sum_{i=1}^{t}Y_i
	\end{align*}
	即$k=1$时结论成立。设$k=d-1$时结论成立，即：
	\begin{equation*}
		X_t=\sum_{i=1}^{d-2}c_it^{i}+\sum_{n_{d-2}=1}^{t}\cdots\sum_{n_1=1}^{n_2}\sum_{i=1}^{n_1}Y_i
	\end{equation*}
	则$k=d$时有：
	\begin{equation*}
		Y_t=(1-\mathcal{B})^dX_t=(1-\mathcal{B})^{d-1}(1-\mathcal{B})X_t
	\end{equation*}
	令$(1-\mathcal{B})X_t=X_t-X_{t-1}=Z_t$，由归纳假设可知：
	\begin{equation*}
		Z_t=\sum_{i=1}^{d-2}c_i't^{i}+\sum_{n_{d-2}=1}^{t}\cdots\sum_{n_1=1}^{n_2}\sum_{i=1}^{n_1}Y_i
	\end{equation*}
	所以：
	\begin{align*}
		X_t&=X_{t-1}+Z_t=X_{t-2}+Z_{t-1}+Z_t=X_0+\sum_{i=1}^{t}Z_i \\
		&=X_0+\sum_{i=1}^{t}\left(\sum_{j=1}^{d-2}c_j'i^{j}+\sum_{n_{d-2}=1}^{i}\cdots\sum_{n_1=1}^{n_2}\sum_{j=1}^{n_1}Y_j\right) \\
		&=X_0+\sum_{i=1}^{t}\sum_{j=1}^{d-2}c_j'i^{j}+\sum_{i=1}^{t}\sum_{n_{d-2}=1}^{i}\cdots\sum_{n_1=1}^{n_2}\sum_{j=1}^{n_1}Y_j \\
		&=X_0+\sum_{j=1}^{d-2}\sum_{i=1}^{t}c_j'i^{j}+\sum_{n_{d-1}=1}^{t}\sum_{n_{d-2}=1}^{n_{d-1}}\cdots\sum_{n_1=1}^{n_2}\sum_{j=1}^{n_1}Y_j \\
		&=X_0t^0+\sum_{i=1}^{d-1}C_it^i+\sum_{n_{d-1}=1}^{t}\sum_{n_{d-2}=1}^{n_{d-1}}\cdots\sum_{n_1=1}^{n_2}\sum_{j=1}^{n_1}Y_j \\
		&=\sum_{i=0}^{d-1}C_it^{i}+\sum_{n_{d-1}=1}^{t}\cdots\sum_{n_1=1}^{n_2}\sum_{i=1}^{n_1}Y_i
	\end{align*}
	倒数第三行到倒数第二行使用了多项式的结论，其中$C_i$由$\{X_t\}$初始的$d$个值决定。
\end{proof}
\subsubsection{单位根模型}
\begin{definition}
	称$\operatorname{ARIMA}(p,1,q)$模型为\textbf{单位根模型}。
\end{definition}



\section{本科时间序列}


\begin{gather*}
	\bar{x}=\frac{\sum\limits_{t=1}^{n}x_t}{n} \\
	\hat{\gamma}(k)=\frac{\sum_{t=1}^{n-k}(x_t-\bar{x})(x_{t+k}-\bar{x})}{n-k},\;
	\hat{\gamma}(0)=s^2 \\
	\hat{\rho}_k=\frac{\hat{\gamma}(k)}{\hat{\gamma}(0)}
\end{gather*}

acf(x, lag=)
虚线为自相关系数$2$倍标准差位置

\subsubsection{平稳性检验}
\begin{enumerate}
	\item 时序图观察
	\item 自相关系数图acf函数，应呈现出迅速衰减向$0$
\end{enumerate}

\subsubsection{白噪声检验}
同均值同方差不相关
\begin{theorem}\label{theo:Barlett}
	如果一个时间序列是白噪声，得到一个观察期数为$n$的观察序列$\{x_t\}$，那么有：
	\begin{equation*}
		\hat{\rho}_k\sim\operatorname{N}\left(0,\frac{1}{n}\right),\;\forall\;k\ne0
	\end{equation*}
	近似成立。
\end{theorem}

\begin{derivation}
	构建假设：
	\begin{enumerate}
		\item 原假设：延迟期数小于或等于$m$期的序列值之间相互独立，即：
		\begin{equation*}
			H_0:\rho_1=\rho_2=\cdots=\rho_m=0
		\end{equation*}
		\item 备择假设：延迟期数小于或等于$m$期的序列值之间有相关性\info{确定这里是有相关性而不是不独立吗？}，即：
		\begin{equation*}
			\text{至少存在某个}\rho_k\ne0,\;k\leqslant m
		\end{equation*}
	\end{enumerate}
	构建$Q$统计量：
	\begin{equation*}
		Q=n\sum_{k=1}^{m}\hat{\rho}_k^2
	\end{equation*}
	若原假设成立，则$\hat{\rho}_k^2$之间也彼此独立，于是：
	\begin{equation*}
		Q=\sum_{k=1}^{m}(\sqrt{n}\hat{\rho}_k)^2\sim\chi^2_m
	\end{equation*}
	当原假设不成立时，$Q$统计量的值应该偏大，于是拒绝域取$\chi^2_m$分布的上$\alpha$分位点。\par
	Box和Ljung为了弥补小样本情况时$Q$统计量效果较差的问题，推导出了LB统计量：
	\begin{equation*}
		LB=n(n+2)\sum_{k=1}^{m}\left(\frac{\hat{\rho}_k^2}{n-k}\right)\sim\chi^2_m
	\end{equation*}\par
	两种检验的代码为Box.test(x, type=, lag=)
\end{derivation}
