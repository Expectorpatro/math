\chapter{微积分}

\section{微分}
\subsection{Fr\'echet微分}
\begin{definition}
	设$X,Y$为数域$K$上的赋范线性空间，$E\subseteq X$是一个开集，$x_0\in E$，$T:E\to Y$是一个映射。若存在有界线性算子$A\in\mathcal{L}(X,Y)$满足：
	\begin{equation*}
		\lim_{||h||_X\to0}\frac{||T(x_0+h)-Tx_0-Ah||_Y}{||h||_X}=0
	\end{equation*}
	则称映射$T$在点$x_0$处Fr\'{e}chet \gls{Differentiable}，称$A$是$T$在点$x_0$处的Fr\'{e}chet \gls{Differential}，记作$\operatorname{D}Tx_0=A$。若$T$在$E$中的每一个点处都可微，则称$T$在$E$上可微。若$\operatorname{D}T$在$x_0$处Fr\'echet可微，将其Fr\'echet微分记作$\operatorname{D}^2T$，更高阶的情况可依此类推。称：
	\begin{equation*}
		T(x_0+h)=Tx_0+Ah+\operatorname{o}(h)
	\end{equation*}
	为\textbf{无穷小增量公式}。
\end{definition}
\begin{property}\label{prop:FrechetDifferential}
	设$X,Y$为数域$K$上的赋范线性空间，$E\subseteq X$是一个开集，$x_0\in E$，$T:E\to Y$和$S:E\to Y$是两个映射，则：
	\begin{enumerate}
		\item 若$T$在$x_0$处Fr\'echet可微，则$T$在$x_0$处的Fr\'echet微分是唯一的；
		\item 若$T$在$x_0$处Fr\'echet可微，则存在$x_0$的邻域$U$和$\alpha>0$使得：
		\begin{equation*}
			||Tx-Tx_0||_Y\leqslant\alpha||x-x_0||_X,\quad\forall\;x\in U
		\end{equation*}
		\item 若$T$在$x_0$处Fr\'echet可微，则$T$在$x_0$处连续；
		\item 若$T,S$在$x_0$处Fr\'echet可微，则对于任意的$\alpha,\beta\in K$，$\alpha T+\beta S$在$x_0$处Fr\'echet可微，且有：
		\begin{equation*}
			\operatorname{D}(\alpha T+\beta S)x_0=\alpha \operatorname{D}Tx_0+\beta\operatorname{D}Sx_0
		\end{equation*}
		\item 设$Z$是数域$K$上的赋范线性空间，$F\subseteq Y$是一个开集，$R:F\to Z$是一个映射。若$T$在$x_0$处Fr\'echet可微，$TE\subseteq F$，$R$在$Tx_0$处Fr\'echet可微，则$RT:E\to Z$也在$x_0$处可微，且有：
		\begin{equation*}
			\operatorname{D}(RT)x_0=\operatorname{D}R(Tx_0)\operatorname{D}Tx_0
		\end{equation*}
	\end{enumerate}
\end{property}
\begin{proof}
	(1)若存在一个不同于$A$的$B\in\mathcal{L}(X,Y)$满足：
	\begin{equation*}
		\lim_{||h||_X\to0}\frac{||T(x_0+h)-Tx_0-Bh||_Y}{||h||_X}=0
	\end{equation*}
	则对于任意的$h\in X\setminus\{\mathbf{0}\}$有：
	\begin{align*}
		&||(B-A)h||_Y=||T(x_0+h)-Tx_0-Ah-[T(x_0+h)-Tx_0-Bh]||_Y \\
		\leqslant&||T(x_0+h)-Tx_0-Ah||_Y+||T(x_0+h)-Tx_0-Bh||_Y
	\end{align*}
	于是：
	\begin{equation*}
		\frac{||(B-A)h||_Y}{||h||_X}\leqslant\frac{||T(x_0+h)-Tx_0-Ah||_Y}{||h||_X}+\frac{||T(x_0+h)-Tx_0-Bh||_Y}{||h||_X}
	\end{equation*}
	由\cref{prop:RMap}(4)(5.b)可得：
	\begin{align*}
		&\frac{||(B-A)h||_Y}{||h||_X}\leqslant\lim_{||h||_X\to0}\left[\frac{||T(x_0+h)-Tx_0-Ah||_Y}{||h||_X}+\frac{||T(x_0+h)-Tx_0-Bh||_Y}{||h||_X}\right] \\
		=&\lim_{||h||_X\to0}\frac{||T(x_0+h)-Tx_0-Ah||_Y}{||h||_X}+\lim_{||h||_X\to0}\frac{||T(x_0+h)-Tx_0-Bh||_Y}{||h||_X}=0
	\end{align*}
	所以$||(B-A)h||=0$对任意的$h\in X\setminus\{\mathbf{0}\}$都成立，即$A=B$。\par
	(2)设$\operatorname{D}Tx_0=A$。因为$T$在$x_0$处Fr\'echet可微，所以对于任意的$\varepsilon>0$，存在$\delta>0$使得当$0<||x-x_0||_X<\delta$时有：
	\begin{equation*}
		||Tx-Tx_0-A(x-x_0)||_Y<\varepsilon||x-x_0||_X
	\end{equation*}
	于是\info{算子范数}：
	\begin{align*}
		&||Tx-Tx_0||_Y\leqslant||Tx-Tx_0-A(x-x_0)||_Y+||A(x-x_0)||_Y \\
		<&\varepsilon||x-x_0||_X+||A||\;||x-x_0||_X=(\varepsilon+||A||)||x-x_0||_X
	\end{align*}
	取$\alpha=\varepsilon+||A||$即可。\par
	(3)由(2)立即可得。\par
	(4)令$A=\operatorname{D}Tx_0,\;B=\operatorname{D}Sx_0$。对于任意的$h\in X\setminus\{\mathbf{0}\}$有：
	\begin{align*}
		&\frac{||[\alpha T(x_0+h)+\beta S(x_0+h)-\alpha Tx_0-\beta Sx]-(\alpha A+\beta B)h||_Y}{||h||_X} \\
		=&\frac{1}{||h||_X}\{||\alpha[T(x_0+h)-Tx_0-Ah]+\beta[S(x_0+h)-Sx-Bh]||_Y\} \\
		\leqslant&\frac{1}{||h||_X}\{||\alpha[T(x_0+h)-Tx_0-Ah]||_Y+||\beta[S(x_0+h)-Sx-Bh]||_Y\} \\
		=&|\alpha|\frac{||T(x_0+h)-Tx_0-Ah||_Y}{||h||_X}+|\beta|\frac{||S(x_0+h)-Sx-Bh||_Y}{||h||_X}
	\end{align*}
	于是由\cref{prop:RMap}(4)(5.b)(5.c)可得：
	\begin{align*}
		&0\leqslant\lim_{||h||_X\to0}\frac{||[\alpha T(x_0+h)+\beta S(x_0+h)-\alpha Tx_0-\beta Sx]-(\alpha A+\beta B)h||_Y}{||h||_X} \\
		\leqslant&|\alpha|\lim_{||h||_X\to0}\frac{||T(x_0+h)-Tx_0-Ah||_Y}{||h||_X}+|\beta|\lim_{||h||_X\to0}\frac{||S(x_0+h)-Sx-Bh||_Y}{||h||_X}=0
	\end{align*}
	所以：
	\begin{equation*}
		\lim_{||h||_X\to0}\frac{||[\alpha T(x_0+h)+\beta S(x_0+h)-\alpha Tx_0-\beta Sx]-(\alpha A+\beta B)h||_Y}{||h||_X}=0
	\end{equation*}
	结论成立。\par
	(5)对于任意的$h\in X\setminus\{\mathbf{0}\}$有：
	\begin{align*}
		&||RT(x_0+h)-R(Tx_0)-\operatorname{D}R(Tx_0)(\operatorname{D}Tx_0)h||_Y \\
		=&||R[T(x_0+h)-Tx_0+Tx_0]-R(Tx_0)-\operatorname{D}R(Tx_0)(\operatorname{D}Tx_0)h \\
		&+\operatorname{D}R(Tx_0)[T(x_0+h)-Tx_0]-\operatorname{D}R(Tx_0)[T(x_0+h)-Tx_0]||_Y \\
		\leqslant&||R[Tx_0+T(x_0+h)-Tx_0]-R(Tx_0)-\operatorname{D}R(Tx_0)[T(x_0+h)-Tx_0]||_Y \\
		&+||\operatorname{D}R(Tx_0)[T(x_0+h)-Tx_0]-\operatorname{D}R(Tx_0)(\operatorname{D}Tx_0)h||_Y \\
		=&||R[Tx_0+T(x_0+h)-Tx_0]-R(Tx_0)-\operatorname{D}R(Tx_0)[T(x_0+h)-Tx_0]||_Y \\
		&+||\operatorname{D}R(Tx_0)[T(x_0+h)-Tx_0-(\operatorname{D}Tx_0)h]||_Y \\
		\leqslant&||R[Tx_0+T(x_0+h)-Tx_0]-R(Tx_0)-\operatorname{D}R(Tx_0)[T(x_0+h)-Tx_0]||_Y \\
		&+||\operatorname{D}R(Tx_0)||\;||T(x_0+h)-Tx_0-(\operatorname{D}Tx_0)h||_Y
	\end{align*}
	由(2)可知对于充分接近$\mathbf{0}$的$h$，存在$\alpha>0$使得：
	\begin{equation*}
		||T(x_0+h)-Tx_0||_Y\leqslant\alpha||h||_X
	\end{equation*}
	所以根据\cref{prop:RMap}(4)(5.b)(5.c)可知：
	\begin{align*}
		&0\leqslant\lim_{||h||_X\to0}\frac{||RT(x_0+h)-R(Tx_0)-\operatorname{D}R(Tx_0)(\operatorname{D}Tx_0)h||_Y}{||h||_X} \\
		\leqslant&\lim_{||h||_X\to0}\frac{||R[Tx_0+T(x_0+h)-Tx_0]-R(Tx_0)-\operatorname{D}R(Tx_0)[T(x_0+h)-Tx_0]||_Y }{||h||_X} \\
		&+\lim_{||h||_X\to0}\frac{||\operatorname{D}R(Tx_0)||\;||T(x_0+h)-Tx_0-(\operatorname{D}Tx_0)h||_Y}{||h||_X} \\
		=&\lim_{||h||_X\to0}\frac{||R[Tx_0+T(x_0+h)-Tx_0]-R(Tx_0)-\operatorname{D}R(Tx_0)[T(x_0+h)-Tx_0]||_Y }{||h||_X} \\
		&+||\operatorname{D}R(Tx_0)||\lim_{||h||_X\to0}\frac{||T(x_0+h)-Tx_0-(\operatorname{D}Tx_0)h||_Y}{||h||_X}=0
	\end{align*}
	结论成立。
\end{proof}
\subsection{G\^ateaux微分}
\begin{definition}
	设$X,Y$为数域$K$上的赋范线性空间，$E\subseteq X$，$x_0\in X$，$T:E\to Y$是一个映射。给定$h\in X$，若存在$\delta>0$使得$x_0+th\in E$对一切$|t|<\delta$成立，
	并且存在极限：
	\begin{equation*}
		\lim_{t\to0}\frac{T(x_0+th)-Tx_0}{t}
	\end{equation*}
	则称该极限为映射$T$在点$x_0$沿方向$h$的G\^ateaux \gls{DirectionalDerivative}，记为$\dif T(x_0;h)$。特别的，若$X$是有限维的，设$X$的维数为$n$，取$X$的一组标准正交基$\{\seq{e}{n}\}$，称$T$在$x_0$处对$e_i$的G\^ateaux方向导数为$T$在点$x_0$对$e_i$的\gls{PartialDerivative}，也将其记作$T_{x^i}'(x_0)$或$T_{x_i}(x_0)$。若$\dif T(x_0;h)$存在点$x_0$处沿方向$h_1$的G\^ateaux方向导数，则将其记作$\dif^2 T(x_0;h,h_1)$，更高阶的情况可依此类推。若存在有界线性算子$A\in\mathcal{L}(X,Y)$满足：
	\begin{equation*}
		\dif T(x_0;h)=Ah
	\end{equation*}
	则称$T$在$x_0$处G\^ateaux可微。
\end{definition}
\begin{property}\label{prop:FrechetGateaux}
	Fr\'echet可微和G\^ateaux可微具有如下关系：
	\begin{enumerate}
		\item 设$X,Y$为数域$K$上的赋范线性空间，$E\subseteq X$是一个开集，$x_0\in E$，$T:E\to Y$是一个映射。若$T$在$x_0$处Fr\'echet可微，则它在$x_0$处沿任何方向$h$的G\^ateaux方向导数都存在，且$\dif T(x_0;h)=(\operatorname{D}Tx_0)h$，即$T$在$x_0$处G\^ateaux可微；
		\item 设$X$为$\mathbb{R}^{}$上的赋范线性空间，$E\subseteq X$是一个开集，$x_0\in E$，$T:E\mathbb{R}^{}$是一个映射。$T$在$x_0$处Fr\'echet可微的充分必要条件为$T$在$x_0$处G\^ateaux可微；
	\end{enumerate}
\end{property}
\begin{proof}
	(1)由Fr\'echet可微和G\^teaux方向导数的定义立即可得。\par
	(2)必要性由(1)即可得到，下证充分性。\par
	因为$T$在$x_0$处G\^ateaux可微，所以存在有界线性算子$A\in\mathcal{L}(X,\mathbb{R}^{})$使得对任意的$h\in X$：
	\begin{equation*}
		\lim_{t\to0}\frac{T(x_0+th)-Tx_0}{t}=Ah
	\end{equation*}
	即：
	\begin{align*}
		&\lim_{t\to0}\left\|\frac{T(x_0+th)-Tx_0}{t}-Ah\right\|=\lim_{t\to0}\left\|\frac{T(x_0+th)-Tx_0-Ath}{t}\right\| \\
		=&\lim_{t\to0}||h||_X\frac{||T(x_0+th)-Tx_0-Ath||}{||th||_X}=0
	\end{align*}
	要使得上式成立，必须有：
	\begin{equation*}
		\lim_{||h||_X\to0}\frac{||T(x_0+h)-Tx_0-Ah||_Y}{||h||_X}=0
	\end{equation*}
\end{proof}
\begin{note}
	根据\cref{prop:FrechetGateaux}(2)，对于从实赋范线性空间到$\mathbb{R}^{}$上的映射的$T$，若$T$ Fr\'echet可微，我们也称$T$ 可微、G\^ateaux可微或可导；若$T$ G\^ateaux可微，我们也称$T$ 可导、Fr\'echet可微或可微。
\end{note}
\subsection{$\mathbb{R}^{n}$上的微分}
\subsubsection{有限增量公式}
为了得到有限增量公式，我们需要先来讨论$\mathbb{R}^{}\to\mathbb{R}^{}$的函数的极值，更一般情况下关于极值的讨论将放在后面。
\begin{definition}
	设函数$f:I\to\mathbb{R}^{}$，开区间$I\subseteq\mathbb{R}^{}$，$x_0\in I$。若存在$x_0$的邻域$U(x_0,\delta)$使得对任意的$x\in U(x_0,\delta)$有：
	\begin{equation*}
		f(x)\leqslant f(x_0)\quad\text{或}\quad f(x)\geqslant f(x_0)
	\end{equation*}
	则称$f(x)$在$x_0$处取到\textbf{极大值}或\textbf{极小值}。若上述不等号严格地成立，则称$f(x)$在$x_0$处取到\textbf{严格的极大值}或\textbf{严格的极小值}。函数的极大值与极小值统称为\textbf{极值}，使函数取到极值的点$x$被称为函数的\textbf{极值点}。
\end{definition}
\begin{lemma}\label{lem:SmallOSignPreservation}
	设$A\in\mathbb{R}^{}\setminus\{0\}$。若$f(h)=Ah+\operatorname{o}(h\to0)$，那么对于充分小的$h\ne0$，$f(h)$与$Ah$同号。
\end{lemma}
\begin{proof}
	由\cref{prop:RSeq}(8.b)(8.c)可得：
	\begin{equation*}
		\lim_{h\to0}\frac{f(h)}{Ah}=\lim_{h\to0}\frac{Ah}{Ah}+\lim_{h\to0}\frac{\operatorname{o}(h)}{Ah}=1
	\end{equation*}
	根据\cref{prop:RSeq}(5)即可得到结论。
\end{proof}
\begin{theorem}[Fermat Theorem]\label{theo:FermatTheorem}
	设函数$f:I\to\mathbb{R}^{}$，开区间$I\subseteq\mathbb{R}^{}$，$f$在$x_0\in I$处取得极值。若$f$在$x_0$处可导，则有$f'(x_0)=0$。
\end{theorem}
\begin{proof}
	由无穷小增量公式可得：
	\begin{equation*}
		f(x)-f(x_0)=f'(x_0)(x-x_0)+o(x-x_0)
	\end{equation*}
	根据\cref{lem:SmallOSignPreservation}即可得出结论。
\end{proof}
\begin{theorem}[Rolle Theorem]\label{theo:RolleTheorem}
	设函数$f$在$[a,b]$上连续，$(a,b)$上可导，$f(a)=f(b)$，则存在$c\in(a,b)$使得$f'(c)=0$。
\end{theorem}
\begin{proof}
	由\cref{prop:OpenClosedSet}(2)、\cref{theo:CompactRn}和\cref{prop:CompactMap}(3)可知$f$在$[a,b]$上取到最小值$m\in\mathbb{R}^{}$和最大值$M\in\mathbb{R}^{}$。若$M=m$，则$f$在$[a,b]$上是常值函数，由\cref{theo:FermatTheorem}可知对任意的$c\in(a,b)$都有$f'(c)=0$。若$M\ne m$，则存在$c\in(a,b)$使得$f$在$c$处取得极值。由\cref{theo:FermatTheorem}即可得出结论。
\end{proof}
\begin{theorem}[Lagrange Mean Value Theorem]\label{theo:LagrangeMeanValueTheorem}
	设函数$f$在$[a,b]$上连续，$(a,b)$上可导，则存在$c\in(a,b)$使得：
	\begin{equation*}
		f'(c)=\frac{f(b)-f(a)}{b-a}
	\end{equation*}
	即存在$\theta\in(0,1)$使得：
	\begin{equation*}
		f(b)-f(a)=f'[a+\theta(b-a)](b-a)
	\end{equation*}
\end{theorem}
\begin{proof}
	作辅助函数：
	\begin{equation*}
		F(x)=f(x)-f(a)-\frac{f(b)-f(a)}{b-a}(x-a)
	\end{equation*}
	由\cref{prop:RMap}(5.b)(5.c)和\cref{prop:FrechetDifferential}(4)可知$F(x)$在$[a,b]$上连续，$(a,b)$上可导，$F(a)=F(b)=0$。根据\cref{theo:RolleTheorem}可知存在$c\in(a,b)$使得：
	\begin{equation*}
		0=F'(c)=f'(c)-\frac{f(b)-f(a)}{b-a}\qedhere
	\end{equation*}
\end{proof}
\begin{theorem}[$\mathbb{R}^{n}\to\mathbb{R}^{}$上的有限增量公式]\label{theo:FiniteIncrementRnR}
	设$E\subseteq\mathbb{R}^{n}$是开集，$f:E\to\mathbb{R}^{}$在$\overline{E}$上连续且在$E$上可微，$a,b\in\overline{E}$且对任意的$\theta\in(0,1)$有$a+\theta(b-a)\in E$，则存在$\theta\in(0,1)$使得：
	\begin{equation*}
		f(b)-f(a)=\sum_{i=1}^{n}f_{x_i}'[a+\theta(b-a)](b_i-a_i)
	\end{equation*}
\end{theorem}
\begin{proof}
	考察函数：
	\begin{equation*}
		\varphi(t)=f[a+t(b-a)]
	\end{equation*}
	$\varphi(t)$在$[0,1]$上连续，在$(0,1)$上可导，由\cref{theo:LagrangeMeanValueTheorem}可得：
	\begin{equation*}
		\varphi(1)-\varphi(0)=\varphi'(\theta),\;\theta\in(0,1)
	\end{equation*}
	根据\cref{prop:FrechetDifferential}(5)可知：
	\begin{equation*}
		\varphi'(t)=\sum_{i=1}^{n}f_{x_i}'[a+t(b-a)](b_i-a_i)
	\end{equation*}
	于是：
	\begin{equation*}
		\varphi(1)-\varphi(0)=f(b)-f(a)=\sum_{i=1}^{n}f_{x_i}'[a+\theta(b-a)](b_i-a_i)\qedhere
	\end{equation*}
\end{proof}
%\begin{theorem}[$\mathbb{R}^{n}\to\mathbb{R}^{m}$上的有限增量公式]\label{theo:FiniteIncrementRnRm}
%	设$E\subseteq\mathbb{R}^{n}$是开集，$f:E\to\mathbb{R}^{m}$在$E$上Fr\'echet可微，$a,b\in E$且对任意的$\theta\in[0,1]$有$a+\theta(b-a)\in E$，则存在$\theta\in(0,1)$使得：
%	\begin{equation*}
%		||f(b)-f(a)||\leqslant||\operatorname{D}f[a+\theta(b-a)]||\;||b-a||
%	\end{equation*}
%\end{theorem}
%\begin{proof}
%	
%\end{proof}

\section{定积分}
\begin{definition}
	设$Q_i=[a_i,b_i]\subseteq\mathbb{R}^{},\;i=1,2,\dots,n$，$Q=Q_1\times Q_2\times\cdots\times Q_n\subseteq\mathbb{R}^{n}$是一个闭方块。称$Q_i$为$Q$的\gls{Edge}，定义$Q$的\gls{Volume}为：
	\begin{equation*}
		\operatorname{Vol}(Q)=\prod_{i=1}^{n}(b_i-a_i)
	\end{equation*}
	对于$G_i=(a_i,b_i)\subseteq\mathbb{R}^{},\;i=1,2,\dots,n$，称$G=G_1\times G_2\times\cdots\times G_n\subseteq\mathbb{R}^{n}$是一个开方块，同样称$G_i$为$G$的棱，定义$G$的体积为：
	\begin{equation*}
		\operatorname{Vol}(G)=\prod_{i=1}^{n}(b_i-a_i)
	\end{equation*}
\end{definition}
\begin{definition}
	定义闭区间$[a,b]\subseteq\mathbb{R}^{}$的一个\gls{Partition}为插入在$a$和$b$之间的有限个分点：
	\begin{equation*}
		P:\;a=x_0<x_1<\cdots<x_n=b
	\end{equation*}
	这些分点把$[a,b]$分成$n$个闭子区间$[x_{i-1},x_{i}],\;i=1,2,\dots,n$，其中第$i$个闭子区间的长度为$\Delta x_i=x_i-x_{i-1}$，称$|P|=\max\{\Delta x_i:i=1,2,\dots,n\}$为分割$P$的\gls{Mesh}。在分割$P$的每一个闭子区间上任取一点：
	\begin{equation*}
		\xi_i\in[x_{i-1},x_i],\quad i=1,2,\dots,n
	\end{equation*}
	称这$n$个点$\seq{\xi}{n}$为对应于分割$P$的一组\gls{Tag}，用$\xi$来表示它们。
\end{definition}
\begin{definition}
	设$Q^i=[a^i,b^i]\subseteq\mathbb{R}^{},\;i=1,2,\dots,n$，$Q=Q^1\times Q^2\times\cdots\times Q^n\subseteq\mathbb{R}^{n}$是一个闭方块，$Q^i$的分割为：
	\begin{equation*}
		P^i:\;a^i=x_0^i<x_1^i<\cdots<x_{N_i}^i=b^i
	\end{equation*}
	称$P=\{P^1,P^2,\dots,P^n\}$为$Q$的一个分割，称$|P|=\max\{|P_i|:i=1,2,\dots,n\}$为分割$P$的模。设$x_{i_j}^i$为$Q^i$的一个分点，记：
	\begin{equation*}
		L_{i_j}^i=\{x=(x^1,x^2,\dots,x^n)\in Q:x^i=x^i_{i_j}\}
	\end{equation*}
	为分割$P$的一个\gls{PartitionHyperplane}。分割$P$的各分界：
	\begin{equation*}
		L_{i_j}^i,\quad i=1,2,\dots,n,\;i_j=1,2,\dots,N_i
	\end{equation*}
	将$Q$分成了$\prod\limits_{i=1}^{n}N_i$个闭子方块，记：
	\begin{gather*}
		Q_{i_j}^i=[x_{i_j-1}^i,x_{i_j}^i],\quad Q_J=\prod_{i=1}^{n}Q_{i_j}^i,\;J=\{1_j,2_j,\dots,n_j\} \\
		\operatorname{Vol}(Q_J)=\Delta x_J=\prod_{i=1}^{n}(x_{i_j}^i-x_{i_j-1}^i)
	\end{gather*}
	在每一个闭子方块$Q_J$上任取一点$\xi_J$，称$\{\xi_J\}$为对应于分割$P$的一组标志点，记为$\xi$。
\end{definition}
\begin{definition}
	如果闭方块$Q\subseteq\mathbb{R}^{}$上的分割序列$\{P_n\}$满足：
	\begin{equation*}
		\lim_{n\to+\infty}|P_n|=0
	\end{equation*}
	则称$\{P_n\}$是一个\gls{SequenceOfPartitionsWithMeshTendingToZero}。
\end{definition}
\begin{definition}
	设$Q\subseteq\mathbb{R}^{n}$是一个闭方块，$f:Q\to\mathbb{R}^{}$是一个函数，对于$Q$的任意一个分割：
	\begin{equation*}
		P=\{P^1,P^2,\dots,P^n\}
	\end{equation*}
	和对应于这一分割的任意一组标志点$\xi$，可以作和：
	\begin{equation*}
		\sigma(f,P,\xi)=\sum_{J}^{}f(\xi_J)\Delta x_J
	\end{equation*}
	称和$\sigma(f,P,\xi)$为函数$f$在闭方块$Q$上的\gls{RiemannSum}。
\end{definition}
\begin{definition}
	设$Q\subseteq\mathbb{R}^{n}$是一个闭方块，$f:Q\to\mathbb{R}^{}$是一个函数，$I\in\mathbb{R}^{}$。若对任意的$\varepsilon>0$，存在$\delta>0$使得只要$|P|<\delta$，不论分割$P$对应的标志点组$\xi$如何选择，都有：
	\begin{equation*}
		|\sigma(f,P,\xi)-I|<\varepsilon
	\end{equation*}
	则称$f$在闭方块$Q$上\gls{RiemannIntegrable}，并且把$I$称为函数$f$在$Q$上的\gls{RiemannIntegral}，记为：
	\begin{equation*}
		\mathop{\int\!\!\cdots\!\!\int}\limits_{Q}f(x^1,x^2,\dots,x^n)\dif (x^1,x^2,\dots,x^n)=\lim_{|P|\to0}\sigma(f,P,\xi)=I
	\end{equation*}
	在不至于混淆的情况下也可以简记为：
	\begin{equation*}
		\int_{Q}f(x^1,x^2,\dots,x^n)\dif (x^1,x^2,\dots,x^n)\quad\text{或}\quad\int_{Q}f(x)\dif x
	\end{equation*}
\end{definition}

\subsection{定积分存在的一般条件}
\begin{theorem}\label{theo:RiemannIntegrableBounded}
	设函数$f$在闭方块$Q\subseteq\mathbb{R}^{}$上可积，则$f$在$Q$上有界。
\end{theorem}
\begin{proof}
	设$f$在$Q$上无界。因为$f$在$Q$上可积，所以对于$\varepsilon=1$，存在$\delta>0$使得只要$|P|<\delta$，不论分割$P$对应的标志点组$\xi$如何选择，都有$|\sigma(f,P,\xi)-I|<1$，即
	\begin{equation*}
		|\sigma(f,P,\xi)|=|\sigma(f,P,\xi)-I+I|\leqslant|\sigma(f,P,\xi)-I|+|I|<1+|I|
	\end{equation*}
	任取上述满足$|P|<\delta$的分割$P$。因为$f$在$Q$上无界，所以$f$至少$Q$的一个闭子方块$Q_{J'}$上无界，于是可以选择$\xi_{J'}\in Q_{J'}$使得：
	\begin{equation*}
		|f(\xi_{J'})\Delta x_{J'}|>\sum_{J\ne {J'}}|f(\xi_{J'})\Delta x_{J'}|+1+|I|
	\end{equation*}
	注意到$|a|-|b|=|a+b-b|-|b|\leqslant|a+b|+|-b|-|b|=|a+b|$，于是就有：
	\begin{equation*}
		1+|I|>|\sigma(f,P,\xi)|=\left|\sum_{J}f(\xi_J)\Delta x_J\right|\geqslant|f(\xi_{J'})\Delta x_{J'}|-\left|\sum_{J\ne J'}^{}f(\xi_J)\Delta x_J\right|>1+|I|
	\end{equation*}
	矛盾，所以$f$在$Q$上有界。
\end{proof}
\begin{definition}
	设函数$f$在闭方块$Q\subseteq\mathbb{R}^{}$上有定义且有界。由\info{确界原理}可知，对于$Q$的一个分割$P$，$f$在$Q$的任一闭子方块$Q_J$上都有有限的下确界和上确界，记为：
	\begin{equation*}
		m_J=\inf_{x\in Q_j}f(x),\quad M_J=\sup_{x\in Q_j}f(x),\quad\omega_J=M_J-m_J
	\end{equation*}
	记：
	\begin{equation*}
		m=\inf_{x\in Q}f(x),\quad M=\sup_{x\in Q}f(x),\quad\omega=M-m
	\end{equation*}
\end{definition}
\begin{definition}
	设函数$f$在闭方块$Q\subseteq\mathbb{R}^{}$上有定义且有界，$P$是$Q$上的一个分割，分别称：
	\begin{equation*}
		L(f,P)=\sum_{J}^{}m_J\Delta x_J,\quad U(f,P)=\sum_{J}^{}M_J\Delta x_J,\quad\Omega(f,P)=U(f,P)-L(f,P)
	\end{equation*}
	为$f$关于$P$的\gls{LowerDarbouxSum}、\gls{UpperDarbouxSum}和\gls{DarbouxSum}。记：
	\begin{equation*}
		\underline{I}=\sup_PL(f,P),\quad\overline{I}=\inf_PU(f,P)
	\end{equation*}
\end{definition}
\begin{property}\label{prop:DarbouxSum}
	设函数$f$在闭方块$Q\subseteq\mathbb{R}^{}$上有定义且有界，$P$是$Q$上的一个分割，$f$关于$P$的Darboux下和$L(f,P)$和Darboux上和$U(f,P)$具有如下性质：
	\begin{enumerate}
		\item $-L(-f,P)=U(f,P)$；
		\item $L(f,P)\leqslant\sigma(f,P,\xi)\leqslant U(f,P),\;\inf\limits_{\xi}\sigma(f,P,\xi)=L(f,P),\;\sup\limits_{\xi}\sigma(f,P,\xi)=U(f,P)$；
		\item 设分割$P'$是由分割$P$添加$l$个分界构成的分割，则：
		\begin{align*}
			L(f,P)\leqslant L(f,P')\leqslant L(f,P)+l\omega C|P| \\
			U(f,P)\geqslant U(f,P')\geqslant U(f,P)-l\omega C|P| \\
			C=\max\left\{\frac{\operatorname{Vol}(Q)}{b^i-a^i}:i=1,2,\dots,n\right\}
		\end{align*}
		\item 设$P_1,P_2$是$Q$的任意两个分割，则有$L(f,P_1)\leqslant U(f,P_2)$；
		\item $\lim\limits_{|P|\to0}L(f,P)=\underline{I},\;\lim\limits_{|P|\to0}U(f,P)=\overline{I}$。
	\end{enumerate}
\end{property}
\begin{proof}
	(1)注意到：
	\begin{equation*}
		-L(-f,P)=-\sum_{J}^{}-M_J\Delta x_J=\sum_{J}^{}M_J\Delta x_J=U(f,P)
	\end{equation*}\par
	(2)由定义即可得出结论。\par
	(3)只证明添加一个分界的情况，多个分界的结论可直接由此推出。设添加的分界为：
	\begin{equation*}
		\{x=(x^1,x^2,\dots,x^n)\in Q:x^i=\alpha,\;\alpha\in(x^h_{k-1},x^h_k)\}
	\end{equation*}
	注意到：
	\begin{align*}
	L(f,P)=\sum_{J:i_j\ne k}^{}m_J\Delta x_J+\sum_{J:i_j=k}^{}m_J\Delta x_J
	\end{align*}
	添加分界后改变的部分仅为后一项，且添加分界后，后一项中的每一个部分为：
	\begin{equation*}
		m_{J'}\left(\frac{\gamma-x^h_{k-1}}{\Delta x_J}\right)\Delta x_J+m_{J''}\left(\frac{x^h_k-\gamma}{\Delta x_J}\right)\Delta x_J
	\end{equation*}
	于是：
	\begin{align*}
		&L(f,P')-L(f,P)=\sum_{J:i_j=k}^{}\left[m_{J'}\left(\frac{\gamma-x^h_{k-1}}{\Delta x_J}\right)\Delta x_J+m_{J''}\left(\frac{x^h_k-\gamma}{\Delta x_J}\right)\Delta x_J-m_J\Delta x_J\right] \\
		=&\sum_{J:i_j=k}^{}\left[m_{J'}\left(\frac{\gamma-x^h_{k-1}}{\Delta x_J}\right)\Delta x_J+m_{J''}\left(\frac{x^h_k-\gamma}{\Delta x_J}\right)\Delta x_J-m_J\left(\frac{\gamma-x^h_{k-1}+x^h_k-\gamma}{\Delta x_J}\right)\Delta x_J\right] \\
		=&\sum_{J:i_j=k}^{}\left[(m_{J'}-m_J)\left(\frac{\gamma-x^h_{k-1}}{\Delta x_J}\right)\Delta x_J+(m_{J''}-m_J)\left(\frac{x^h_k-\gamma}{\Delta x_J}\right)\Delta x_J\right]
	\end{align*}
	注意到$m_J\leqslant m_{J'},m_{J''}\leqslant M_J$，所以有：
	\begin{equation*}
		0\leqslant L(f,P')-L(f,P)\leqslant\sum_{J:i_j=k}^{}\omega_J\Delta x_J\leqslant\omega_J\sum_{J:i_j=k}^{}\Delta x_J=\omega\frac{\Delta x^h_k}{b^h-a^h}\operatorname{Vol}(Q)\leqslant\omega C|P|
	\end{equation*}
	即：
	\begin{equation*}
		L(f,P)\leqslant L(f,P')\leqslant L(f,P)+\omega C|P|
	\end{equation*}\par
	由(1)和上述结论可得：
	\begin{equation*}
		0\leqslant L(-f,P')-L(-f,P)\leqslant-\omega C|P|
	\end{equation*}
	于是：
	\begin{equation*}
		0\leqslant -U(f,P')+U(f,P)\leqslant-\omega C|P|
	\end{equation*}
	即：
	\begin{equation*}
		U(f,P)\geqslant U(f,P')\geqslant U(f,P)-\omega C|P|
	\end{equation*}\par
	(4)设$P'$为$P_1$和$P_2$的分点合并在一起构成的分割，则由(3)(2)可得：
	\begin{equation*}
		L(f,P_1)\leqslant L(f,P')\leqslant U(f,P')\leqslant U(f,P_2)
	\end{equation*}\par
	(5)只证明第一个结论，第二个完全类似。由上确界的定义可得对任意的$\varepsilon>0$，存在$Q$上的分割$P_0$使得：
	\begin{equation*}
		\underline{I}-\frac{\varepsilon}{2}<L(f,P_0)<\underline{I}
	\end{equation*}
	设$P_0$的分界数为$l$。取$Q$上的分割$P$满足：
	\begin{equation*}
		|P|<\delta=\frac{\varepsilon}{2l\omega C+1}
	\end{equation*}
	将$P_0,P$的分界合在一起得到分割$P'$，则由(3)可得：
	\begin{equation*}
		\underline{I}\geqslant L(f,P)\geqslant L(f,P')-l\omega C|P|\geqslant L(f,P_0)-l\omega C|P|>\underline{I}-\frac{\varepsilon}{2}-\frac{\varepsilon}{2}=\underline{I}-\varepsilon
	\end{equation*}
	即对任意的$\varepsilon>0$，只要$|P|<\delta=\dfrac{\varepsilon}{2l\omega C+1}$，就有$|L(f,P)-\underline{I}|<\varepsilon$，所以：
	\begin{equation*}
		\lim_{|P|\to0}L(f,P)=\underline{I}\qedhere
	\end{equation*}
\end{proof}
\begin{theorem}\label{theo:RiemannIntegrableIff}
	设函数$f$在方块$Q\subseteq\mathbb{R}^{}$上有定义并且有界，则下述三条结论等价：
	\begin{enumerate}
		\item 对任意的$\varepsilon>0$，存在$Q$上的分割$P$使得$\Omega(f,P)=U(f,P)-L(f,P)<\varepsilon$；
		\item $f$在$Q$上满足$\underline{I}=\overline{I}$，也即$\lim\limits_{|P|\to0}\Omega(f,P)=0$；
		\item $f$在$Q$上可积且$\int_{Q}f(x)\dif x=\overline{I}=\underline{I}$。
	\end{enumerate}
\end{theorem}
\begin{proof}
	\textbf{(1)$\to$(2)：}因为对任意的分割$P$都有：
	\begin{equation*}
		0\leqslant\overline{I}-\underline{I}\leqslant U(f,P)-L(f,P)
	\end{equation*}
	根据条件即可得到对任意的$\varepsilon>0$有$0\leqslant\overline{I}-\underline{I}<\varepsilon$，所以$\overline{I}=\underline{I}$。\par
	\textbf{(2)$\to$(3)：}记$\overline{I}=\underline{I}=I$，由\cref{prop:DarbouxSum}(5)可得：
	\begin{equation*}
		\lim_{|P|\to0}L(f,P)=\lim_{|P|\to0}U(f,P)=I
	\end{equation*}
	根据\cref{prop:DarbouxSum}(2)和\cref{prop:RMap}(3.a)可得：
	\begin{equation*}
		\lim_{|P|\to0}\sigma(f,P,\xi)=I
	\end{equation*}
	即$f$在$Q$上可积且积分值为$I$。\par
	\textbf{(3)$\to$(1)：}由可积的定义，对任意的$\varepsilon>0$，存在$\delta>0$使得只要$|P|<\delta$，就有：
	\begin{equation*}
		I-\frac{\varepsilon}{3}<\sigma(f,P,\xi)<I+\frac{\varepsilon}{3}
	\end{equation*}
	对于这个$P$，由\cref{prop:DarbouxSum}(2)和上下确界的不等式性可得：
	\begin{equation*}
		I-\frac{\varepsilon}{3}\leqslant L(f,P)\leqslant U(f,P)\leqslant I+\frac{\varepsilon}{3}
	\end{equation*}
	于是有：
	\begin{equation*}
		U(f,P)-L(f,P)\leqslant\frac{2\varepsilon}{3}<\varepsilon\qedhere
	\end{equation*}
\end{proof}

\subsection{可积函数类}
\begin{lemma}\label{lem:omega=SupVari}
	设函数$f$在闭方块$J$上有定义，记：
	\begin{equation*}
		M=\sup_{x\in J}f(x),\quad m=\inf_{x\in J}f(x),\quad\omega=M-m
	\end{equation*}
	则有：
	\begin{equation*}
		\omega=\sup_{x_1,x_2\in J}|f(x_1)-f(x_2)|
	\end{equation*}
\end{lemma}
\begin{proof}
	若$\omega=0$，则结论显然成立，下对$\omega>0$的情况进行证明。\par
	对任意的$x_1,x_2\in J$有：
	\begin{equation*}
		|f(x_1)-f(x_2)|\leqslant\omega
	\end{equation*}
	由上确界的不等式性即可得：
	\begin{equation*}
		\sup_{x_1,x_2\in J}|f(x_1)-f(x_2)|\leqslant\omega
	\end{equation*}
	对于任意的$0<\varepsilon<\omega$，由上确界和下确界的定义可得存在$x_1,x_2\in J$使得：
	\begin{equation*}
		M>f(x_1)>M-\frac{\varepsilon}{2}>m+\frac{\varepsilon}{2}>f(x_2)>m
	\end{equation*}
	于是：
	\begin{equation*}
		f(x_1)-f(x_2)>M-\frac{\varepsilon}{2}-m-\frac{\varepsilon}{2}=\omega-\varepsilon
	\end{equation*}
	由上确界的不等式性可得：
	\begin{equation*}
		\sup_{x_1,x_2\in J}|f(x_1)-f(x_2)|\geqslant\omega
	\end{equation*}
	所以：
	\begin{equation*}
		\omega=\sup_{x_1,x_2\in J}|f(x_1)-f(x_2)|\qedhere
	\end{equation*}
\end{proof}
\begin{theorem}\label{theo:RiemannIntegrable4ArithmeticOperation}
	设函数$f,g$在闭方块$Q\subseteq\mathbb{R}^{}$上可积，$\alpha,\beta\in\mathbb{R}^{}$，则：
	\begin{enumerate}
		\item $\alpha f+\beta g$在$Q$上可积且：
		\begin{equation*}
			\int_Q[\alpha f(x)+\beta g(x)]\dif x=\alpha\int_Qf(x)\dif x+\beta\int_Qg(x)\dif x
		\end{equation*}
		\item $fg$在$Q$上可积；
		\item 若存在常数$c>0$使得$|f(x)|\geqslant c,\;\forall\;x\in Q$，则$\dfrac{1}{f}$在$Q$上可积；
		\item $|f|$在$Q$上可积。
	\end{enumerate}
\end{theorem}
\begin{proof}
	(1)因为$f,g$可积，所以可设：
	\begin{equation*}
		\lim_{|P|\to0}\sigma(f,P,\xi)=I_1\in\mathbb{R}^{},\quad\lim_{|P|\to0}\sigma(g,P,\xi)=I_2\in\mathbb{R}^{}
	\end{equation*}
	由\cref{prop:RMap}(5.b)(5.c)可得：
	\begin{align*}
		\lim_{|P|\to0}\sigma(\alpha f+\beta g,P,\xi)&=\lim_{|P|\to0}[\alpha\sigma(f,P,\xi)+\beta\sigma(g,P,\xi)] \\
		&=\alpha\lim_{|P|\to0}\sigma(f,P,\xi)+\beta\lim_{|P|\to0}\sigma(g,P,\xi) \\
		&=\alpha I_1+\beta I_2\in\mathbb{R}^{}
	\end{align*}
	由定义可得$\alpha f+\beta g$可积，所以：
	\begin{equation*}
		\int_Q[\alpha f(x)+\beta g(x)]\dif x=\alpha\int_Qf(x)\dif x+\beta\int_Qg(x)\dif x
	\end{equation*}\par
	(2)由\cref{theo:RiemannIntegrableBounded}可知$f,g$在$Q$上有界，设：
	\begin{equation*}
		|f(x)|\leqslant K,\;|g(x)|\leqslant L,\quad\forall\;x\in Q
	\end{equation*}
	对于任意的$x,y\in Q_J$有：
	\begin{align*}
		|f(x)g(x)-f(y)g(y)|&=|f(x)g(x)-f(y)g(x)+f(y)g(x)-f(y)g(y)| \\
		&=|[f(x)-f(y)]g(x)+[g(x)-g(y)]f(y)| \\
		&\leqslant|f(x)-f(y)||g(x)|+|g(x)-g(y)||f(y)| \\
		&\leqslant|f(x)-f(y)|L+|g(x)-g(y)|K\leqslant\omega_J(f)L+\omega_J(g)K
	\end{align*}
	于是由\cref{lem:omega=SupVari}和上确界的不等式性有：
	\begin{equation*}
		\omega_J(fg)=\sup_{x,y\in Q_J}|f(x)g(x)-f(y)g(y)|\leqslant L\omega_J(f)+K\omega_J(g)
	\end{equation*}
	因为$\Omega_J(fg)=\omega_J(fg)\Delta x_J$，所以对$P$有：
	\begin{equation*}
		\Omega(fg,P)=\sum_{J}^{}\omega_J(fg)\Delta x_J\leqslant L\sum_{J}^{}\omega_J(f)\Delta x_J+K\sum_{J}^{}\omega_J(g)\Delta x_J=L\Omega(f,P)+K\Omega(g,P)
	\end{equation*}
	因为$f,g$可积，由\cref{theo:RiemannIntegrableIff}(2)可得：
	\begin{equation*}
		\lim_{|P|\to0}\Omega(f,P)=\lim_{|P|\to0}\Omega(g,P)=0
	\end{equation*}
	由\cref{prop:RMap}(5.b)(5.c)和\cref{prop:RMap}(3.a)可得：
	\begin{equation*}
		0\leqslant\lim_{|P|\to0}\Omega(fg,P)\leqslant L\lim_{|P|\to0}\Omega(f,P)+K\lim_{|P|\to0}\Omega(g,P)=0
	\end{equation*}
	即：
	\begin{equation*}
		\lim_{|P|\to0}\Omega(fg,P)=0
	\end{equation*}
	由\cref{theo:RiemannIntegrableIff}(2)可得$fg$在$Q$上可积。\par
	(3)对任意的$x,y\in Q_J$有：
	\begin{equation*}
		\left|\frac{1}{f(x)}-\frac{1}{f(y)}\right|=\left|\frac{f(y)-f(x)}{f(x)f(y)}\right|\leqslant\frac{|f(y)-f(x)|}{c^2}
	\end{equation*}
	由\cref{lem:omega=SupVari}、上确界的不等式性和上确界的线性运算可得：
	\begin{equation*}
		\omega_J\left(\frac{1}{f}\right)=\sup_{x,y\in Q_J}\left|\frac{1}{f(x)}-\frac{1}{f(y)}\right|\leqslant\sup_{x,y\in Q_J}\frac{|f(y)-f(x)|}{c^2}=\frac{\omega_J(f)}{c^2}
	\end{equation*}
	因为$\Omega_J\left(\dfrac{1}{f}\right)=\omega_J\left(\dfrac{1}{f}\right)\Delta x_J$，所以对$P$有：
	\begin{equation*}
		\Omega\left(\dfrac{1}{f},P\right)=\sum_{J}^{}\omega_J\left(\dfrac{1}{f}\right)\Delta x_J\leqslant\sum_{J}^{}\frac{\omega_J(f)\Delta x_J}{c^2}=\frac{\Omega(f,P)}{c^2}
	\end{equation*}
	因为$f$可积，由\cref{theo:RiemannIntegrableIff}(2)可得：
	\begin{equation*}
		\lim_{|P|\to0}\Omega(f,P)=0
	\end{equation*}
	由\cref{prop:RMap}(5.c)和\cref{prop:RMap}(3.a)可得：
	\begin{equation*}
		\lim_{|P|\to0}\Omega\left(\frac{1}{f},P\right)=0
	\end{equation*}
	由\cref{theo:RiemannIntegrableIff}(2)可得$\dfrac{1}{f}$在$Q$上可积。\par
	(4)对任意的$x,y\in Q$有：
	\begin{equation*}
		\Big||f(x)|-|f(y)|\Big|\leqslant|f(x)-f(y)|
	\end{equation*}
	所以由\cref{lem:omega=SupVari}和上确界的不等式性可得：
	\begin{equation*}
		\omega_J(|f|)=\sup_{x,y\in Q_J}\Big||f(x)-f(y)|\Big|\leqslant\sup_{x,y\in Q_J}|f(x)-f(y)|=\omega_J(f)
	\end{equation*}
	因为$\Omega_J(|f|)=\omega_J(|f|)\Delta x_J$，所以对$P$有：
	\begin{equation*}
		\Omega(|f|,P)=\sum_{J}^{}\omega_J(|f|)\Delta x_J\leqslant\sum_{J}^{}\omega_J(f)\Delta x_J=\Omega(f,P)
	\end{equation*}
	因为$f$可积，由\cref{theo:RiemannIntegrableIff}(2)可得：
	\begin{equation*}
		\lim_{|P|\to0}\Omega(f,P)=0
	\end{equation*}
	由\cref{prop:RMap}(2.a)可得：
	\begin{equation*}
		\lim_{|P|\to0}\Omega\left(|f|,P\right)=0
	\end{equation*}
	由\cref{theo:RiemannIntegrableIff}(2)可得$|f|$在$Q$上可积。
\end{proof}
\begin{theorem}\label{theo:RiemannIntegrable}
	关于函数的可积性，有如下结论：
	\begin{enumerate}
		\item 设$Q_1\subseteq Q\subseteq\mathbb{R}^{n}$，$Q_1,Q$为闭方块。若函数$f$在$Q$上可积，则$f$在$Q_1$上可积；
		\item 若函数$f$在闭区间$[a,b]\subseteq\mathbb{R}^{}$上有定义且单调有界，则$f$在$[a,b]$上可积；
		\item 若函数$f$在闭方块$Q\subseteq\mathbb{R}^{}$上连续，则$f$在$Q$上可积；
		\item 若函数$f$在闭区间$[a,b]\subseteq\mathbb{R}^{}$上有界且除了有限个间断点外在其它各点连续，则$f$在$[a,b]$上可积；
		\item 若函数$f,g$在闭区间$[a,b]\subseteq\mathbb{R}^{}$上有定义且有界，除了有限个点$\seq{c}{l}$以外有$f=g$，此时如果$f$可积，则$g$也可积，且有：
		\begin{equation*}
			\int_{a}^bf(x)\dif x=\int_{a}^bg(x)\dif x
		\end{equation*}
	\end{enumerate}
\end{theorem}
\begin{proof}
	(1)因为$f$在$Q$上可积，所以对任意的$\varepsilon>0$，存在$\delta>0$使得只要$Q$上的分割$P_1$满足$|P_1|<\delta$就有$\Omega(f,P_1)<\varepsilon$。为$P_1$再增加分界得到$P_2$使得$P_2$的子分割$P$构成$Q_1$的一个分割（若原本就是则不增加分界），由\cref{prop:DarbouxSum}(3)可知$\Omega(f,P_2)<\Omega(f,P_1)$。对于$P$有：
	\begin{equation*}
		0<\Omega(f,P)<\Omega(f,P_2)\leqslant\Omega(f,P_1)<\varepsilon
	\end{equation*}
	而$|P|\leqslant|P_2|\leqslant|P_1|<\delta$，所以由\cref{prop:RMap}(2.a)可得：
	\begin{equation*}
		\lim_{|P|\to0}\Omega(f,P)=\lim_{|P_1|\to0}\Omega(f,P_1)=0
	\end{equation*}
	由\cref{theo:RiemannIntegrableIff}(2)可得$f$在$Q_1$上可积。\par
	(2)设$f$单调增。$P$是$[a,b]$上的分割，对任意的$\varepsilon>0$，取：
	\begin{equation*}
		\delta=\frac{\varepsilon}{f(b)-f(a)+1}
	\end{equation*}
	则当$|P|<\delta$时有：
	\begin{equation*}
		\Omega(f,P)=\sum_{i=1}^{n}\omega_i\Delta x_i<\delta\sum_{i=1}^{n}\omega_i=\delta[f(b)-f(a)]=\frac{\varepsilon[f(b)-f(a)]}{f(b)-f(a)+1}<\varepsilon
	\end{equation*}
	所以：
	\begin{equation*}
		\lim_{|P|\to0}\Omega(f,P)=0
	\end{equation*}
	由\cref{theo:RiemannIntegrableIff}(2)可得$f$在$[a,b]$上可积。\par
	对$f$单调减的情况只需在上述过程中取：
	\begin{equation*}
		\delta=\frac{\varepsilon}{f(a)-f(b)+1}
	\end{equation*}\par
	(3)因为$f$在$Q$上连续，由\cref{theo:CompactRn}和\cref{prop:CompactMap}(4)可得$f$在$[a,b]$上一致连续，所以对任意的$\varepsilon>0$，存在$\delta>0$，当$|x-y|<\delta$时就有$|f(x)-f(y)|<\varepsilon$。取$|P|<\delta$，于是：
	\begin{equation*}
		\Omega(f,P)=\sum_{J}^{}\omega_J\Delta x_J<\varepsilon\sum_{J}^{}\Delta x_J=\operatorname{Vol}(Q)\varepsilon
	\end{equation*}
	所以：
	\begin{equation*}
		\lim_{|P|\to0}\Omega(f,P)=0
	\end{equation*}
	由\cref{theo:RiemannIntegrableIff}(2)可得$f$在$Q$上可积。\par
	(4)设$f$的间断点为$\seq{c}{l}$，对任意给定的充分小的$\eta$，取$l$个开区间：
	\begin{equation*}
		J_j=(c_j-\eta,c_j+\eta),\quad j=1,2,\dots,l
	\end{equation*}
	在$[a,b]$减去$\seq{J}{l}$后所余下的有限个闭子区间上，$f$是连续的，由\cref{prop:OpenClosedSet}(2)、\cref{theo:CompactRn}和\cref{prop:CompactMap}(4)可得$f$在其上一致连续，所以存在$\delta>0$，使得只要：
	\begin{equation*}
		x_,y\in[a,b]\Big\backslash\left(\underset{j=1}{\overset{l}{\cup}}J_j\right),\;|x-y|<\delta
	\end{equation*}
	就有$|f(x)-f(y)|<\eta$。取$[a,b]$上的分割$P$使得$|P|<\min\{\eta,\delta\}$。因为$|P|<\eta$，注意到一个$J_j$最多与四个$P$的闭子区间相交，所以在$P$的各闭子区间中，最多只有总长度不超过$4l\eta$的子区间与某个$J_j$相交。可以把$\Omega(f,P)$分成两部分：
	\begin{equation*}
		\Omega(f,P)=\sum_s'\omega_s\Delta x_s+\sum_t''\omega_t\Delta x_t
	\end{equation*}
	第一部分与所有的$J_j$都不相交，第二部分与某个$J_j$相交，于是有：
	\begin{align*}
		\Omega(f,P)&=\sum_s'\omega_s\Delta x_s+\sum_t''\omega_t\Delta x_t<\eta\sum_{s}'\omega_s+\omega\sum_{t}''\Delta x_t \\
		&\leqslant\eta(b-a)+\omega4l\eta=(b-a+4l\omega)\eta
	\end{align*}
	对任意的$\varepsilon>0$，只要取：
	\begin{equation*}
		\eta<\frac{\varepsilon}{b-a+4l\omega}
	\end{equation*}
	就可以得到$\Omega(f,P)<\varepsilon$，即：
	\begin{equation*}
		\lim_{|P|\to0}\Omega(f,P)=0
	\end{equation*}
	由\cref{theo:RiemannIntegrableIff}(2)可得$f$在$[a,b]$上可积。\par
	(5)记：
	\begin{equation*}
		K=\max\{|g(c_1)-f(c_1)|,|g(c_2)-f(c_2)|,\dots,|g(c_l)-f(c_l)|\}
	\end{equation*}
	设$P$是$[a,b]$上的任意分割，则在$P$的各个闭子区间中，最多只有$2l$个能够包含某个$c_i$（考虑$|P|$足够小的情况，这时一个闭子区间只能含有一个$c_i$），同时当且仅当$f$在$P$的包含$c_i$的闭子区间上的最大值或最小值是$f(c_i)$或$g$在该区间上的极值为$g(c_i)$时$\omega_i(f)$和$\omega_i(g)$才会不一样。分类讨论可得此时$|\omega_i(g)-\omega_i(f)|\leqslant K$，所以：
	\begin{align*}
		|\sigma(g,P,\xi)-\sigma(f,P,\xi)|&\leqslant\sum_{i=1}^{n}|[\omega_i(g)-\omega_i(f)]\Delta x_i| \\
		&\leqslant\sum_{i=1}^{n}|[\omega_i(g)-\omega_i(f)]||P|\leqslant2lK|P|
	\end{align*}
	于是：
	\begin{equation*}
		\int_{a}^bf(x)\dif x=\lim_{|P|\to0}\sigma(f,P,\xi)=\lim_{|P|\to0}\sigma(g,P,\xi)=\int_{a}^bg(x)\dif x\qedhere
	\end{equation*}
\end{proof}

\subsection{定积分的性质}
\begin{property}
	定积分具有如下性质：
	\begin{enumerate}
		\item 设$a<b<c$，若$f$在$[a,b]$和$[b,c]$上都可积，则$f$在$[a,c]$上也可积，且：
		\begin{equation*}
			\int_{a}^cf(x)\dif x=\int_{a}^bf(x)\dif x+\int_{b}^cf(x)\dif x
		\end{equation*}
		\item 若函数$f,g$在闭方块$Q\subseteq\mathbb{R}^{}$上可积且$f\leqslant g$在$Q$上恒成立，则：
		\begin{equation*}
			\int_Qf(x)\dif x\leqslant\int_Qg(x)\dif x
		\end{equation*}
		\item 设函数$f$在闭方块$Q$上可积，由\cref{theo:RiemannIntegrableBounded}可知$f$在闭方块上有界。若$f$在$Q$上满足$m\leqslant f\leqslant M$，则：
		\begin{equation*}
			m\operatorname{Vol}(Q)\leqslant\int_Qf(x)\dif x\leqslant M\operatorname{Vol}(Q)
		\end{equation*}
		\item 若$f$在闭方块$Q$上连续，则存在$c\in Q$使得：
		\begin{equation*}
			\int_Qf(x)\dif x=f(c)\operatorname{Vol}(Q)
		\end{equation*}
		\item 设闭方块$Q_1,Q_2\subseteq\mathbb{R}^{n}$满足$Q_1\subseteq Q_2$，函数$f:Q_1\to\mathbb{R}^{}$。若对$f$作如下延拓：
		\begin{equation*}
			f(x)=
			\begin{cases}
				f(x),&x\in Q_1 \\
				0,&x\in\mathbb{R}^{n}\setminus Q_1
			\end{cases}
		\end{equation*}
		则$f$在$Q_2$上可积的充分必要条件为$f$在$Q_1$上可积。此时还有：
		\begin{equation*}
			\int_{Q_1}f(x)\dif x=\int_{Q_2}f(x)\dif x
		\end{equation*}
		\item 设闭方块$Q=V\times W\subseteq\mathbb{R}^{n}\times\mathbb{R}^{p}$，闭方块$V\subseteq\mathbb{R}^{n}$，闭方块$W\subseteq\mathbb{R}^{p}$，函数$f(x,y):Q\to\mathbb{R}^{}$，$x\in\mathbb{R}^{n},\;y\in\mathbb{R}^{p}$，$\underline{I}_W(\overline{I}_W)$是将$f(x,y)$看作$y$的函数在$W$上的下（上）积分。若$f$在$Q$上可积，则$\underline{I}_E$和$\overline{I}_E$在$V$上可积，且有：
		\begin{equation*}
			\int_{Q}f(x,y)\dif(x,y)=\int_{V}\underline{I}_E\dif x=\int_{V}\overline{I}_E\dif x
		\end{equation*}
	\end{enumerate}
\end{property}
\begin{proof}
	(1)由\cref{theo:RiemannIntegrableBounded}可知$f$在$[a,c]$上有界，即存在$M>0$使得$|f(x)|\leqslant M$对任意的$x\in[a,c]$成立。\par
	取$[a,c]$上的一个分割$P$，若$b$在$P$的标志点集$\xi$中，则令$P'=P,\xi'=\xi$，其中$\xi'$是$P'$的标志点集。若$b$不在$\xi$中，则令：
	\begin{equation*}
		P':\;a=x_0<x_1<x_2<\cdots<x_j<b<x_{j+1}<\cdots<x_n=c,\quad \xi'=\xi\cup{b}
	\end{equation*}
	其中$x_i\in\xi,\;i=1,2,\dots,n$。注意到$\sigma(f,P,\xi)$和$\sigma(f,P',\xi')$的差别至多为：
	\begin{align*}
		|\sigma(f,P',\xi')-\sigma(f,P,\xi)|&=|f(\xi'_{j+1})(b-x_j)+f(\xi'_{j+2})(x_{j+1}-b)-f(\xi_{j+1})(x_{j+1}-x_j)| \\
		&<|f(\xi'_{j+1})+f(\xi'_{j+2})-f(\xi_{j+1})||P|\leqslant3M|P|
	\end{align*}
	即：
	\begin{equation*}
		\lim_{|P|\to0}\sigma(f,P,\xi)=\sigma(f,P',\xi')
	\end{equation*}
	将$P'$分别限制在$[a,b]$和$[b,c]$上可以得到分割$P_1,P_2$及其对应的标志点组$\varphi,\psi$。因为$f$在$[a,b]$和$[b,c]$上都可积，所以极限：
	\begin{equation*}
		\lim_{|P_1|\to0}\sigma(f,P_1,\varphi),\quad\lim_{|P_2|\to0}\sigma(f,P_2,\psi)
	\end{equation*}
	存在，因为：
	\begin{equation*}
		\sigma(f,P',\xi')=\sigma(f,P_1,\varphi)+\sigma(f,P_2,\psi),\quad|P'|\to0\longrightarrow|P_1|,|P_2|\to0
	\end{equation*}
	由\cref{prop:RMap}(5.b)可得：
	\begin{equation*}
		\lim_{|P'|\to0}\sigma(f,P',\xi)=\lim_{|P_1|\to0}\sigma(f,P_1,\varphi)+\lim_{|P_2|\to0}\sigma(f,P_2,\psi)=\int_{a}^bf(x)\dif x+\int_{b}^cf(x)\dif x
	\end{equation*}
	而$|P|\to0$包含了$|P'|\to0$，所以：
	\begin{equation*}
		\lim_{|P|\to0}\sigma(f,P,\xi)=\int_{a}^bf(x)\dif x+\int_{b}^cf(x)\dif x\in\mathbb{R}^{}
	\end{equation*}
	由定积分的定义即可得到：
	\begin{equation*}
		\int_{a}^cf(x)\dif x=\int_{a}^bf(x)\dif x+\int_{b}^cf(x)\dif x
	\end{equation*}\par
	(2)因为$f\leqslant g$在$Q$上恒成立，所以$\varphi=g-f\geqslant0$在$Q$上恒成立。因为$f,g$在$Q$上可积，由\cref{theo:RiemannIntegrable4ArithmeticOperation}(1)可知$\varphi$在$Q$上可积且：
	\begin{equation*}
		\int_Q\varphi(x)\dif x=\int_Qg(x)\dif x-\int_Qf(x)\dif x
	\end{equation*}
	因为$\varphi$在$Q$上非负，所以对$Q$上任意的分割$P$及其标志点组$\xi$都有$\sigma(\varphi,P,\xi)\geqslant0$，由\cref{prop:RMap}(4)可得：
	\begin{equation*}
		\int_Q\varphi(x)\dif x=\lim_{|P|\to0}\sigma(\varphi,P,\xi)\geqslant0
	\end{equation*}
	所以：
	\begin{equation*}
		\int_Qg(x)\dif x-\int_Qf(x)\dif x\geqslant0
	\end{equation*}\par
	(3)由定积分的定义和(2)可知：
	\begin{equation*}
		\int_Qm\dif x=m\operatorname{Vol}(Q)\leqslant\int_Qf(x)\dif x\leqslant\int_QM\dif x=M\operatorname{Vol}(Q)
	\end{equation*}\par
	(4)由\cref{theo:RiemannIntegrable}(3)可知$f$在$Q$上可积。由\cref{theo:CompactRn}和\cref{prop:CompactMap}(3)可知$f$在$Q$上可以取到下确界$m$和上确界$M$，根据(3)可得：
	\begin{equation*}
		m\operatorname{Vol}(Q)\leqslant\int_Qf(x)\dif x\leqslant M\operatorname{Vol}(Q)
	\end{equation*}
	即：
	\begin{equation*}
		m\leqslant\frac{1}{\operatorname{Vol}(Q)}\int_Qf(x)\dif x\leqslant M
	\end{equation*}
	由\cref{theo:IntermediateValue}可知存在$c\in Q$使得：
	\begin{equation*}
		f(c)=\frac{1}{\operatorname{Vol}(Q)}\int_Qf(x)\dif x
	\end{equation*}\par
	(5)\textbf{必要性：}由可积的定义，存在$I_2\in\mathbb{R}^{}$，对于任意的$\varepsilon>0$，存在$\delta>0$，只要$Q_2$上的分割$P_2$满足$|P_2|<\delta$，就有$|\sigma(f,P_2,\xi_2)-I_2|<\varepsilon$。取一组上述的$\varepsilon$和$\delta$，对于$Q_1$上的分割$P_1$满足$|P_1|<\delta$，可增加其分界使得$P_1$成为$Q_2$上的分割$P_2$，并满足$|P_2|<\delta$，此时有：
	\begin{equation*}
		|\sigma(f,P_1,\xi_1)-I_2|=|\sigma(f,P_2,\xi_2)-I_2|<\varepsilon
	\end{equation*}
	于是$f$在$Q_1$上可积且有：
	\begin{equation*}
		\int_{Q_1}f(x)\dif x=\int_{Q_2}f(x)\dif x
	\end{equation*}\par
	\textbf{充分性：}由\cref{theo:RiemannIntegrableIff}(2)可知，对任意的$\varepsilon>0$，存在$\delta>0$，使得当$Q_1$上的分割$P_1$满足$|P_1|<\delta$时就有$\Omega(f,P_1)<\varepsilon$。对于$Q_2$上任意满足$|P_2|<\delta$的分割$P_2$，可增加分界使其子分割$P_2'$成为$Q_1$的分割，此时有$|P_2'|<\delta$，记增加分界后的$P_2$为$P_3$，于是有：
	\begin{equation*}
		\Omega(f,P_3)=\Omega(f,P_2')<\varepsilon
	\end{equation*}
	根据\cref{theo:RiemannIntegrableIff}(1)可得$f$在$Q_2$上可积。\par
	(6)任取$V$和$W$上的分割$P_V,P_W$，则$P=\{P_V,P_W\}$构成$Q$的一个分割。 设$P_V$将$V$划分为$\seq{V}{arg2}$
\end{proof}

%\chapter{Lebesgue积分}
%本章讨论Lebesgue积分。\par
%在前半部分作好定义Lebesgue积分的所有准备工作，即讨论$\mathbb{R}^n$上的测度。\par
%\gls{measure}是一种映射，它把集合映射到某一个实数，是一种将几何空间的度量（长度、面积、体积）和其他常见概念（如大小、质量和事件的概率）广义化后产生的概念。\par
%我们的目的是建立一种定义\footnote{这里的定义并不是函数的定义域那种含义的定义，可以证明实数直线上存在不可测集合，这里类似于概率空间$(\Omega,\mathcal{F},P)$，实数直线是类似样本空间的概念。}在$\mathbb{R}^n$上的测度，使它满足以下的\gls{lmeasureaxiom}：
%\begin{axiom}\label{axi:Lebesguem}
%	对于$\mathbb{R}^n$上的某一集合族$\mathcal{F}$（待定义\label{sec:lebesgue可测集合族}），测度\gls{lmeasure}$m$有如下性质：
%	\begin{enumerate}
%		\item 非负性：对任意的$ E\in\mathcal{F}$，$m(E)\geqslant0$。
%		\item 可列可加性：若$E_n\in\mathcal{F},\;\forall\;n\in\mathbb{N}^+$，且对任意的$i,j\in\mathbb{N}^+,\;i\ne j,\;E_i\cap E_j=\varnothing$，则有$m(\underset{i=1}{\overset{+\infty}{\cup}} E_i)=\sum\limits_{i=1}^{+\infty}m(E_i)$。
%		\item 正则性：单位立方体$[0,1]^n\subset\mathcal{F}$且它的测度$m([0,1]^n)=1$。
%	\end{enumerate}
%\end{axiom}
%\input{analysis/int-calculus/exterior-measure}
%\input{analysis/int-calculus/measurable-collections}
%\input{analysis/int-calculus/measurable-functions}
%\input{analysis/int-calculus/integral}
%\input{analysis/int-calculus/differential}