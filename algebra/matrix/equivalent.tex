\section{相抵的应用}

\subsection{广义逆}
\begin{definition}
	设$A\in M_{m\times n}(K)$，一切满足方程组：
	\begin{equation*}
		AXA=A
	\end{equation*}
	的矩阵$X$都被称为是$A$的\gls{GeneralizedInverse}，记为$A^-$。
\end{definition}
 \begin{theorem}\label{theo:ExistenceOfGeneralizedInverse}
	设非零矩阵$A\in M_{m\times n}(K)$，$\operatorname{rank}(A)=r$且：
	\begin{equation*}
		A=P
		\begin{pmatrix}
			I_r & \mathbf{0} \\
			\mathbf{0} & \mathbf{0}
		\end{pmatrix}
		Q
	\end{equation*}
	其中$P,Q$分别为数域$K$上的$m$阶可逆矩阵和$n$阶可逆矩阵，则矩阵方程：
	\begin{equation*}
		AXA=A
	\end{equation*}
	一定有解，且其通解可表示为：
	\begin{equation*}
		X=Q^{-1}
		\begin{pmatrix}
			I_r & B \\
			C & D
		\end{pmatrix}
		P^{-1}
	\end{equation*}
	其中$B,C,D$分别为数域$K$上任意的$r\times (m-r),\;(n-r)\times r,\;(n-r)\times(m-r)$矩阵。
\end{theorem}
\begin{proof}
	若$X$是上述矩阵方程的一个解，则：
	\begin{gather*}
		P
		\begin{pmatrix}
			I_r & \mathbf{0} \\
			\mathbf{0} & \mathbf{0}
		\end{pmatrix}
		Q
		X
		P
		\begin{pmatrix}
			I_r & \mathbf{0} \\
			\mathbf{0} & \mathbf{0}
		\end{pmatrix}
		Q
		=
		P
		\begin{pmatrix}
			I_r & \mathbf{0} \\
			\mathbf{0} & \mathbf{0}
		\end{pmatrix}
		Q  \\
		\begin{pmatrix}
			I_r & \mathbf{0} \\
			\mathbf{0} & \mathbf{0}
		\end{pmatrix}
		Q
		X
		P
		\begin{pmatrix}
			I_r & \mathbf{0} \\
			\mathbf{0} & \mathbf{0}
		\end{pmatrix}
		=
		\begin{pmatrix}
			I_r & \mathbf{0} \\
			\mathbf{0} & \mathbf{0}
		\end{pmatrix}
	\end{gather*}
	将$QXP$写作如下分块矩阵的形式：
	\begin{equation*}
		QXP=
		\begin{pmatrix}
			H & B \\
			C & D
		\end{pmatrix}
	\end{equation*}
	其中$H,B,C,D$分别为数域$K$上任意的$r\times r,\;r\times (m-r),\;(n-r)\times r,\;(n-r)\times(m-r)$矩阵。于是：
	\begin{gather*}
		\begin{pmatrix}
			I_r & \mathbf{0} \\
			\mathbf{0} & \mathbf{0}
		\end{pmatrix}
		\begin{pmatrix}
			H & B \\
			C & D
		\end{pmatrix}
		\begin{pmatrix}
			I_r & \mathbf{0} \\
			\mathbf{0} & \mathbf{0}
		\end{pmatrix}
		=
		\begin{pmatrix}
			I_r & \mathbf{0} \\
			\mathbf{0} & \mathbf{0}
		\end{pmatrix} \\
		\begin{pmatrix}
			H & \mathbf{0} \\
			\mathbf{0} & \mathbf{0}
		\end{pmatrix}
		=
		\begin{pmatrix}
			I_r & \mathbf{0} \\
			\mathbf{0} & \mathbf{0}
		\end{pmatrix}
	\end{gather*}
	所以$H=I_r$，因此：
	\begin{equation*}
		X=Q^{-1}
		\begin{pmatrix}
			I_r & B \\
			C & D
		\end{pmatrix}
		P^{-1}\qedhere
	\end{equation*}
\end{proof}
\begin{property}\label{prop:A-}
	设$A\in M_{m\times n}(K),\;B\in M_{m\times q}(K),\;C\in M_{p\times n}(K)$，则广义逆$A^-$具有如下性质：
	\begin{enumerate}
		\item $A^-$唯一的充分必要条件为$A$可逆，此时$A^-=A^{-1}$；
		\item $\operatorname{rank}(A^-)\geqslant\operatorname{rank}(A)=\operatorname{rank}(AA^-)=\operatorname{rank}(A^-A)$；
		\item 若$\mathcal{M}(B)\subseteq\mathcal{M}(A),\mathcal{M}(C)\subseteq\mathcal{M}(A^T)$，则$C^TA^-B$是唯一的\info{两个唯一性的证明都问题}；
		\item $A(A^TA)^-A^T$是唯一的；
		\item 若$A$对称，则$(A^-)^T=A^-$；
		\item $A(A^TA)^-A^TA=A,\;A^TA(A^TA)^-A^T=A^T$；
		\item 若存在$\alpha$使得$c=A^T\alpha$，则$c^T(A^TA)^-A^TA=c^T$。
	\end{enumerate}
\end{property}
\begin{proof}
	(1)\textbf{充分性：}若$A$可逆，由\cref{prop:InvertibleMatrix}(3)可知$r=n$，由\cref{theo:ExistenceOfGeneralizedInverse}中$A^-$的通解公式，显然此时$A^-$唯一。\par
	\textbf{必要性：}若$A^-$唯一，则$r=n$，由\cref{prop:InvertibleMatrix}(3)可知此时$A$可逆。\par
	(2)由$A^-$的通解公式，$\operatorname{rank}(A^-)\geqslant r=\operatorname{rank}(A)$。因为：
	\begin{gather*}
		AA^-=P
		\begin{pmatrix}
			I_r & \mathbf{0} \\
			\mathbf{0} & \mathbf{0}
		\end{pmatrix}
		QQ^{-1}
		\begin{pmatrix}
			I_r & B \\
			C & D
		\end{pmatrix}
		P^{-1}
		=P
		\begin{pmatrix}
			I_r & B \\
			\mathbf{0} & \mathbf{0}
		\end{pmatrix}
		p^{-1} \\
		A^-A=Q^{-1}
		\begin{pmatrix}
			I_r & B \\
			C & D
		\end{pmatrix}
		P^{-1}P
		\begin{pmatrix}
			I_r & \mathbf{0} \\
			\mathbf{0} & \mathbf{0}
		\end{pmatrix}
		Q
		=Q^{-1}
		\begin{pmatrix}
			I_r & \mathbf{0} \\
			C & \mathbf{0}
		\end{pmatrix}
		Q
	\end{gather*}
	显然，$\operatorname{rank}(AA^-)=\operatorname{rank}(A^-A)=\operatorname{rank}(A)=r$。\par
	(3)由已知条件，存在矩阵$D_1,D_2$使得$B=AD_1,\;C=A^TD_2$，于是：
	\begin{equation*}
		C^TA^-B=D_2^TAA^-AD_1=D_2^TAD_1
	\end{equation*}\par
	(4)由\cref{prop:OrthogonalProjectionMat}(2)可知$A(A^TA)^-A^T$是向$\mathcal{M}(A)$的正交投影阵，由\cref{prop:ProjectionTransformation}(7)和\cref{theo:LinearTransformationMatrix}可得$A(A^TA)^-A$是唯一的，与$(A^TA)^-$的选择无关。\par
	(5)此时有：
	\begin{equation*}
		AXA=A\iff A^TX^TA^T=A^T\iff AX^TA=A
	\end{equation*}\par
	(6)设$B=A(A^TA)^-A^TA-A$，则：
	\begin{align*}
		B^TB
		&=\{A^TA[(A^TA)^-]^TA^T-A^T\}[A(A^TA)^-A^TA-A] \\
		&=A^TA[(A^TA)^-]^TA^TA(A^TA)^-A^TA-A^TA[(A^TA)^-]^TA^TA \\
		&\quad-A^TA(A^TA)^-A^TA+A^TA \\
		&=A^TA[(A^TA)^-]^TA^TA-A^TA[(A^TA)^-]^TA^TA-A^TA+A^TA=\mathbf{0}
	\end{align*}
	所以$B=\mathbf{0}$（考虑$B^TB$主对角线上的元素），于是$A(A^TA)^-A^TA=A$。第二个等式由\cref{prop:Transpose}(4)和第一个等式即可得到。\par
	(7)由(6)和\cref{prop:Transpose}(4)可得：
	\begin{equation*}
		c^T(A^TA)^-A^TA=\alpha^TA(A^TA)^-A^TA=\alpha^TA=c^T\qedhere
	\end{equation*}
\end{proof}

\subsection{Moore-Penrose广义逆}
\begin{definition}
	设$A\in M_{m\times n}(\mathbb{C})$。若$X\in M_{n\times m}(\mathbb{C})$满足：
	\begin{equation*}
		\begin{cases}
			AXA=A \\
			XAX=X \\
			(AX)^H=AX \\
			(XA)^H=XA
		\end{cases}
	\end{equation*}
	则称$X$为$A$的Moore-Penrose广义逆，记作$A^+$，上述方程组被称为$A$的Penrose方程组。
\end{definition}
\subsubsection{满秩分解导出的广义逆}
\begin{theorem}
	设$A\in M_{m\times n}(\mathbb{C})$，则$A$的Penrose方程组一定有唯一解。对$A$进行满秩分解，设$A=BC$，其中$B,C$分别为列满秩矩阵与行满秩矩阵，则$A$的Penrose方程组的解可表示为：
	\begin{equation*}
		X=C^H(CC^H)^{-1}(B^HB)^{-1}B^H
	\end{equation*}
\end{theorem}
\begin{proof}
	由\cref{prop:MatrixRank}(8)可知$(B^HB)^{-1},(CC^H)^{-1}$存在，将上述$X$代入$A$的Penrose方程组可得：
	\begin{align*}
		&\begin{aligned}
			XAX
			&=C^H(CC^H)^{-1}(B^HB)^{-1}B^HBCC^H(CC^H)^{-1}(B^HB)^{-1}B^H \\
			&=C^H(CC^H)^{-1}(B^HB)^{-1}B^H=X
		\end{aligned} \\
		&AXA=BCC^H(CC^H)^{-1}(B^HB)^{-1}B^HBC=BC=A \\
		&\begin{aligned}
			(AX)^H
			&=X^HA^H=B[(B^HB)^{-1}]^H[(CC^H)^{-1}]^HCC^HB^H \\
			&=B[(B^HB)^{-1}]^H[(CC^H)^{-1}]^HCC^HB^H \\
			&=B[(B^HB)^H]^{-1}[(CC^H)^H]^{-1}CC^HB^H \\
			&=B(B^HB)^{-1}(CC^H)^{-1}CC^HB^H \\
			&=B(B^HB)^{-1}B^H \\
			&=B(CC^H)(CC^H)^{-1}(B^HB)^{-1}B^H=AX
		\end{aligned} \\
		&\begin{aligned}
			(XA)^H
			&=A^HX^H=C^HB^HB[(B^HB)^{-1}]^H[(CC^H)^{-1}]^HC \\
			&=C^H(CC^H)^{-1}C=C^H(CC^H)^{-1}(B^HB)^{-1}(B^HB)C=XA
		\end{aligned}
	\end{align*}
	于是$X$与$A$的Penrose方程组相容，所以$X$是解。
\end{proof}
\subsubsection{奇异值分解导出的广义逆}
\begin{theorem}\label{theo:A+SVD}
	设$A\in M_{m\times n}(\mathbb{C})$，则有：
	\begin{equation*}
		A^+=Q
		\begin{pmatrix}
			\varLambda^{-1} & \mathbf{0} \\
			\mathbf{0} & \mathbf{0}
		\end{pmatrix}
		P^H
	\end{equation*}
	其中$P,Q,\varLambda$为$A$的奇异值分解中相关矩阵。
\end{theorem}
\begin{proof}
	将之代入到$A$的Penrose方程组中可得：
	\begin{gather*}
		\begin{aligned}
			AQ
			\begin{pmatrix}
				\varLambda^{-1} & \mathbf{0} \\
				\mathbf{0} & \mathbf{0}
			\end{pmatrix}
			P^HA
			&=P
			\begin{pmatrix}
				\varLambda & \mathbf{0} \\
				\mathbf{0} & \mathbf{0}
			\end{pmatrix}Q^HQ
			\begin{pmatrix}
				\varLambda^{-1} & \mathbf{0} \\
				\mathbf{0} & \mathbf{0}
			\end{pmatrix}
			P^HP
			\begin{pmatrix}
				\varLambda & \mathbf{0} \\
				\mathbf{0} & \mathbf{0}
			\end{pmatrix}Q^H \\
			&=P\begin{pmatrix}
				\varLambda & \mathbf{0} \\
				\mathbf{0} & \mathbf{0}
			\end{pmatrix}Q^H
			=A
		\end{aligned} \\
		\begin{aligned}
			Q
			\begin{pmatrix}
				\varLambda^{-1} & \mathbf{0} \\
				\mathbf{0} & \mathbf{0}
			\end{pmatrix}
			P^HA
			Q
			\begin{pmatrix}
				\varLambda^{-1} & \mathbf{0} \\
				\mathbf{0} & \mathbf{0}
			\end{pmatrix}
			P^H
			&=Q
			\begin{pmatrix}
				\varLambda^{-1} & \mathbf{0} \\
				\mathbf{0} & \mathbf{0}
			\end{pmatrix}
			P^HP
			\begin{pmatrix}
				\varLambda & \mathbf{0} \\
				\mathbf{0} & \mathbf{0}
			\end{pmatrix}
			Q^HQ
			\begin{pmatrix}
				\varLambda^{-1} & \mathbf{0} \\
				\mathbf{0} & \mathbf{0}
			\end{pmatrix}
			P^H \\
			&=Q
			\begin{pmatrix}
				\varLambda^{-1} & \mathbf{0} \\
				\mathbf{0} & \mathbf{0}
			\end{pmatrix}
			P^H
		\end{aligned} \\
		AQ
		\begin{pmatrix}
			\varLambda^{-1} & \mathbf{0} \\
			\mathbf{0} & \mathbf{0}
		\end{pmatrix}
		P^H=Q
		\begin{pmatrix}
			\varLambda^{-1} & \mathbf{0} \\
			\mathbf{0} & \mathbf{0}
		\end{pmatrix}
		P^HA=I
	\end{gather*}
	因为$I$是Hermitian矩阵，于是$Q
	\begin{pmatrix}
		\varLambda^{-1} & \mathbf{0} \\
		\mathbf{0} & \mathbf{0}
	\end{pmatrix}
	P^H$与$A$的Penrose方程组相容，所以它是解。
\end{proof}
\subsubsection{Moore-Penrose广义逆的性质}
\begin{property}\label{prop:A+}
	设$A\in M_{m\times n}(\mathbb{C})$，则$A$的Moore-Penrose广义逆$A^+$具有如下性质：
	\begin{enumerate}
		\item $A^+$是唯一的；
		\item $(A^+)^+=A$；
		\item $(A^+)^H=(A^H)^+$；
		\item $\operatorname{rank}(A^+)=\operatorname{rank}(A)$；
		\item 若$A$是一个Hermitian矩阵，则：
		\begin{equation*}
			A^+=Q
			\begin{pmatrix}
				\varLambda^{-1} & \mathbf{0} \\
				\mathbf{0} & \mathbf{0}
			\end{pmatrix}Q^H
		\end{equation*}
		其中$\varLambda$为$A$的非零特征值构成的对角矩阵，$Q$是一个正交矩阵；
		\item 若$\alpha$是一个非零向量，则$\alpha^+=\frac{\alpha^H}{||\alpha||^2}$；
		\item $I-A^+A\geqslant \mathbf{0}$；
		\item $(A^HA)^+=A^+(A^H)^+$；
		\item $A^+=(A^HA)^+A^H=A^H(AA^H)^+$。
	\end{enumerate}
\end{property}
\begin{proof}
	(1)设$X_1,X_2$都是$A$的Penrose方程组的解，则：
	\begin{align*}
		X_1
		&=X_1AX_1=X_1(AX_2A)X_1=X_1(AX_2)(AX_1) \\
		&=X_1(AX_2)^H(AX_1)^H=X_1(AX_1AX_2)^H=X_1X_2^H(AX_1A)^H \\
		&=X_1X_2^HA^H=X_1(AX_2)^H=X_1AX_2=X_1(AX_2A)X_2 \\
		&=(X_1A)(X_2A)X_2=(X_1A)^H(X_2A)^HX_2=(X_2AX_1A)^HX_2 \\
		&=(X_2A)^HX_2=X_2AX_2=X_2
	\end{align*}
	所以Penrose方程组的解是唯一的。\par
	(2)由Penrose方程的对称性可直接得到。\par
	(3)由$A^+$的奇异值分解表示（\cref{theo:A+SVD}）和\cref{prop:Transpose}(4)可得：
	\begin{align*}
		(A^+)^H&=\left[Q
		\begin{pmatrix}
			\varLambda^{-1} & \mathbf{0} \\
			\mathbf{0} & \mathbf{0}
		\end{pmatrix}P^H\right]^H
		=P
		\begin{pmatrix}
			\varLambda^{-1} & \mathbf{0} \\
			\mathbf{0} & \mathbf{0}
		\end{pmatrix}^HQ^H \\
		&=P
		\begin{pmatrix}
			(\varLambda^{-1})^H & \mathbf{0} \\
			\mathbf{0} & \mathbf{0}
		\end{pmatrix}Q^H
		=P
		\begin{pmatrix}
			(\varLambda^H)^{-1} & \mathbf{0} \\
			\mathbf{0} & \mathbf{0}
		\end{pmatrix}Q^H
	\end{align*}
	将其代入$A^H$的Penrose方程组可得：
	\begin{gather*}
		\begin{aligned}
			A^H(A^+)^HA^H
			&=Q
			\begin{pmatrix}
				\varLambda^H & \mathbf{0} \\
				\mathbf{0} & \mathbf{0}
			\end{pmatrix}
			P^HP
			\begin{pmatrix}
				(\varLambda^H)^{-1} & \mathbf{0} \\
				\mathbf{0} & \mathbf{0}
			\end{pmatrix}
			Q^HQ
			\begin{pmatrix}
				\varLambda^H & \mathbf{0} \\
				\mathbf{0} & \mathbf{0}
			\end{pmatrix}
			P^H \\
			&=Q
			\begin{pmatrix}
				\varLambda^H & \mathbf{0} \\
				\mathbf{0} & \mathbf{0}
			\end{pmatrix}
			P^H
			=A^H
		\end{aligned} \\
		\begin{aligned}
			(A^+)^HA^H(A^+)^H
			&=P
			\begin{pmatrix}
				(\varLambda^H)^{-1} & \mathbf{0} \\
				\mathbf{0} & \mathbf{0}
			\end{pmatrix}
			Q^H\begin{pmatrix}
				\varLambda^H & \mathbf{0} \\
				\mathbf{0} & \mathbf{0}
			\end{pmatrix}
			P^HP
			\begin{pmatrix}
				(\varLambda^H)^{-1} & \mathbf{0} \\
				\mathbf{0} & \mathbf{0}
			\end{pmatrix}Q^H \\
			&=P
			\begin{pmatrix}
				(\varLambda^H)^{-1} & \mathbf{0} \\
				\mathbf{0} & \mathbf{0}
			\end{pmatrix}Q^H
			=(A^+)^H
		\end{aligned} \\
		[A^H(A^+)^H]^H=[(A^+)^HA^H]^H=A^+A=I
	\end{gather*}
	因为$I$是Hermitian矩阵，于是$(A^+)^H$与$A^H$的Penrose方程组相容，所以$(A^+)^H=(A^H)^+$。\par
	(4)由$A^+$的奇异值分解表示（\cref{theo:A+SVD}）和\cref{prop:InvertibleMatrix}(16)可得$\operatorname{rank}(A^+)=\operatorname{rank}(\varLambda)$，而$\operatorname{rank}(\varLambda)=\operatorname{rank}(A)$，所以有$\operatorname{rank}(A^+)=\operatorname{rank}(A)$。\par
	(5)因为$A$是一个Hermitian矩阵，由\cref{prop:HermitianMatEigen}(3)可知存在酉矩阵$Q$使得：
	\begin{equation*}
		A=Q
		\begin{pmatrix}
			\varLambda & \mathbf{0} \\
			\mathbf{0} & \mathbf{0}
		\end{pmatrix}Q^H
	\end{equation*}
	由\cref{prop:Transpose}(4)，将$Q
	\begin{pmatrix}
		\varLambda^{-1} & \mathbf{0} \\
		\mathbf{0} & \mathbf{0}
	\end{pmatrix}Q^H$代入$A$的Penrose方程组可得：
	\begin{gather*}
		\begin{aligned}
			AQ
			\begin{pmatrix}
				\varLambda^{-1} & \mathbf{0} \\
				\mathbf{0} & \mathbf{0}
			\end{pmatrix}Q^HA
			&=Q
			\begin{pmatrix}
				\varLambda & \mathbf{0} \\
				\mathbf{0} & \mathbf{0}
			\end{pmatrix}
			Q^HQ
			\begin{pmatrix}
				\varLambda^{-1} & \mathbf{0} \\
				\mathbf{0} & \mathbf{0}
			\end{pmatrix}
			Q^HQ
			\begin{pmatrix}
				\varLambda & \mathbf{0} \\
				\mathbf{0} & \mathbf{0}
			\end{pmatrix}
			Q^H \\
			&=Q
			\begin{pmatrix}
				\varLambda & \mathbf{0} \\
				\mathbf{0} & \mathbf{0}
			\end{pmatrix}
			Q^H
			=A
		\end{aligned} \\
		\begin{aligned}
			Q
			\begin{pmatrix}
				\varLambda^{-1} & \mathbf{0} \\
				\mathbf{0} & \mathbf{0}
			\end{pmatrix}
			Q^HAQ
			\begin{pmatrix}
				\varLambda^{-1} & \mathbf{0} \\
				\mathbf{0} & \mathbf{0}
			\end{pmatrix}
			Q^H
			&=Q
			\begin{pmatrix}
				\varLambda^{-1} & \mathbf{0} \\
				\mathbf{0} & \mathbf{0}
			\end{pmatrix}
			Q^HQ
			\begin{pmatrix}
				\varLambda & \mathbf{0} \\
				\mathbf{0} & \mathbf{0}
			\end{pmatrix}
			Q^HQ
			\begin{pmatrix}
				\varLambda^{-1} & \mathbf{0} \\
				\mathbf{0} & \mathbf{0}
			\end{pmatrix}
			Q^H \\
			&=Q
			\begin{pmatrix}
				\varLambda^{-1} & \mathbf{0} \\
				\mathbf{0} & \mathbf{0}
			\end{pmatrix}
			Q^H
		\end{aligned} \\
		\left[AQ
		\begin{pmatrix}
			\varLambda^{-1} & \mathbf{0} \\
			\mathbf{0} & \mathbf{0}
		\end{pmatrix}
		Q^H\right]^H
		=
		\left[Q
		\begin{pmatrix}
			\varLambda^{-1} & \mathbf{0} \\
			\mathbf{0} & \mathbf{0}
		\end{pmatrix}
		Q^HA\right]^H
		=Q
		\begin{pmatrix}
			I & \mathbf{0} \\
			\mathbf{0} & \mathbf{0}
		\end{pmatrix}
		Q^H
	\end{gather*}
	因为$Q
	\begin{pmatrix}
		I & \mathbf{0} \\
		\mathbf{0} & \mathbf{0}
	\end{pmatrix}
	Q^H$是Hermitian矩阵，于是$Q
	\begin{pmatrix}
		\varLambda^{-1} & \mathbf{0} \\
		\mathbf{0} & \mathbf{0}
	\end{pmatrix}Q^H$与$A$的Penrose方程组相容，所以$Q
	\begin{pmatrix}
	\varLambda^{-1} & \mathbf{0} \\
	\mathbf{0} & \mathbf{0}
	\end{pmatrix}Q^H=A^+$。\par
	(6)将$\frac{\alpha^H}{||\alpha||^2}$代入$\alpha$的Penrose方程组可得：
	\begin{gather*}
		\alpha\frac{\alpha^H}{||\alpha||^2}\alpha=\alpha  \\
		\frac{\alpha^H}{||\alpha||^2}\alpha\frac{\alpha^H}{||\alpha||^2}=\frac{\alpha^H}{||\alpha||^2} \\
		\left(\alpha\frac{\alpha^H}{||\alpha||^2}\right)^H=\left(\frac{\alpha^H}{||\alpha||^2}\alpha\right)^H=1
	\end{gather*}
	显然$\dfrac{\alpha^H}{||\alpha||^2}=\alpha^+$。\par
	(7)由$A^+$的奇异值分解表示（\cref{theo:A+SVD}）可得：
	\begin{align*}
		I-A^+A&=I-Q
		\begin{pmatrix}
			\varLambda^{-1} & \mathbf{0} \\
			\mathbf{0} & \mathbf{0}
		\end{pmatrix}
		P^HP
		\begin{pmatrix}
			\varLambda & \mathbf{0} \\
			\mathbf{0} & \mathbf{0}
		\end{pmatrix}Q^H
		=I-Q
		\begin{pmatrix}
			I & \mathbf{0} \\
			\mathbf{0} & \mathbf{0}
		\end{pmatrix}Q^H \\
		&=I-\begin{pmatrix}
			I & \mathbf{0} \\
			\mathbf{0} & \mathbf{0}
		\end{pmatrix}
		=\begin{pmatrix}
			\mathbf{0} & \mathbf{0} \\
			\mathbf{0} & I
		\end{pmatrix}\cong
		\begin{pmatrix}
			I & \mathbf{0} \\
			\mathbf{0} & \mathbf{0}
		\end{pmatrix}
	\end{align*}
	由\cref{theo:PositiveSemidefinite}(3)的第三条可知$I-A^+A\geqslant\mathbf{0}$。\par
	(8)由(3)可得：
	\begin{align*}
		A^+(A^H)^+&=A^+(A^+)^H=Q
		\begin{pmatrix}
			\varLambda^{-1} & \mathbf{0} \\
			\mathbf{0} & \mathbf{0}
		\end{pmatrix}
		P^HP
		\begin{pmatrix}
			(\varLambda^H)^{-1} & \mathbf{0} \\
			\mathbf{0} & \mathbf{0}
		\end{pmatrix}Q^HQ^H \\
		&=Q\begin{pmatrix}
			\varLambda^{-1}(\varLambda^H)^{-1} & \mathbf{0} \\
			\mathbf{0} & \mathbf{0}
		\end{pmatrix}Q^H
		=\begin{pmatrix}
			\varLambda^{-1}(\varLambda^{H})^{-1} & \mathbf{0} \\
			\mathbf{0} & \mathbf{0}
		\end{pmatrix}
	\end{align*}
	由$A$的奇异值分解（\cref{theo:SVD}）可得：
	\begin{align*}
		A^HA&=\left[P
		\begin{pmatrix}
			\varLambda & \mathbf{0} \\
			\mathbf{0} & \mathbf{0}
		\end{pmatrix}Q^H\right]^HP
		\begin{pmatrix}
			\varLambda & \mathbf{0} \\
			\mathbf{0} & \mathbf{0}
		\end{pmatrix}Q^H \\
		=&Q
		\begin{pmatrix}
			\varLambda^H & \mathbf{0} \\
			\mathbf{0} & \mathbf{0}
		\end{pmatrix}
		P^HP
		\begin{pmatrix}
			\varLambda & \mathbf{0} \\
			\mathbf{0} & \mathbf{0}
		\end{pmatrix}Q^H
		=\begin{pmatrix}
			\varLambda^H\varLambda & \mathbf{0} \\
			\mathbf{0} & \mathbf{0}
		\end{pmatrix}
	\end{align*}
	将$A^+(A^H)^+$代入$A^HA$的Penrose方程组中即可验证得到$(A^HA)^+=A^+(A^H)^+$。\par
	(9)由(8)、(3)和$A^+$的奇异值分解表示（\cref{theo:A+SVD}）可得：
	\begin{gather*}
		\begin{aligned}
			(A^HA)^+A^H
			&=A^+(A^H)^+A^H
			=A^+(A^+)^HA^H \\
			&=Q
			\begin{pmatrix}
				\varLambda^{-1} & \mathbf{0} \\
				\mathbf{0} & \mathbf{0}
			\end{pmatrix}
			P^HP
			\begin{pmatrix}
				(\varLambda^H)^{-1} & \mathbf{0} \\
				\mathbf{0} & \mathbf{0}
			\end{pmatrix}
			Q^HQ
			\begin{pmatrix}
				\varLambda^H & \mathbf{0} \\
				\mathbf{0} & \mathbf{0}
			\end{pmatrix}
			P^H \\
			&=Q
			\begin{pmatrix}
				\varLambda^{-1} & \mathbf{0} \\
				\mathbf{0} & \mathbf{0}
			\end{pmatrix}
			P^H=A^+
		\end{aligned} \\
		\begin{aligned}
			A^H(AA^H)^+
			&=A^H(A^H)^+A^+
			=A^H(A^+)^HA^+ \\
			&=Q
			\begin{pmatrix}
				\varLambda^H & \mathbf{0} \\
				\mathbf{0} & \mathbf{0}
			\end{pmatrix}
			P^HP
			\begin{pmatrix}
				(\varLambda^H)^{-1} & \mathbf{0} \\
				\mathbf{0} & \mathbf{0}
			\end{pmatrix}
			Q^HQ
			\begin{pmatrix}
				\varLambda^{-1} & \mathbf{0} \\
				\mathbf{0} & \mathbf{0}
			\end{pmatrix}
			P^H \\
			&=Q
			\begin{pmatrix}
				\varLambda^{-1} & \mathbf{0} \\
				\mathbf{0} & \mathbf{0}
			\end{pmatrix}
			P^H=A^+
		\end{aligned}\qedhere
	\end{gather*}
\end{proof}

\subsection{线性方程组的解}
\begin{theorem}\label{theo:ConsistentLinearEqCondition}
	数域$K$上$n$元非齐次线性方程组$Ax=\beta$有解的充分必要条件为对$A$的任一广义逆$A^-$都有：
	\begin{equation*}
		\beta=AA^-\beta
	\end{equation*}
\end{theorem}
\begin{proof}
	\textbf{(1)必要性：}若$Ax=\beta$有解，取其一个解$\alpha$，于是对$A$的任一广义逆有：
	\begin{equation*}
		\beta=A\alpha=AA^-A\alpha=AA^-\beta
	\end{equation*}
	\textbf{(2)充分性：}若此时对$A$的任一广义逆$A^-$有$\beta=AA^-\beta$，则方程组可化为：
	\begin{equation*}
		Ax=AA^-\beta
	\end{equation*}
	容易看出$A^-\beta$就是$Ax=\beta$的一个解。
\end{proof}
\subsubsection{齐次方程组解的结构}
\begin{theorem}\label{theo:HomogeneousLinearEq'sGeneralSolution}
	若数域$K$上$n$元齐次线性方程组$Ax=\mathbf{0}$有解，则它的通解为：
	\begin{equation*}
		x=(I_n-A^-A)y
	\end{equation*}
	其中$A^-$是$A$的任意一个给定的广义逆，$y$取遍$K^n$中的列向量。
\end{theorem}
\begin{proof}
	任取$y\in K^n$，有：
	\begin{equation*}
		A(I_n-A^-A)y=Ay-AA^-Ay=Ay-Ay=\mathbf{0}
	\end{equation*}
	所以对任意的$y\in K^n$，$(I_n-A^-A)y$都是$Ax=\mathbf{0}$的解。\par
	若$\eta$是$Ax=\mathbf{0}$的一个解，则：
	\begin{equation*}
		(I_n-A^-A)\eta=\eta-A^-A\eta=\eta-A^-\mathbf{0}=\eta
	\end{equation*}
	所以$Ax=\mathbf{0}$的任意一个解$x$都可以表示为$(I_n-A^-A)x$的形式。\par
	综上，$Ax=\mathbf{0}$的通解为$x=(I_n-A^-A)y$。
\end{proof}
\subsubsection{非齐次方程组解的结构}
\begin{theorem}[结构1]
	\label{theo:InhomogeneousLinearEq'sGeneralSolution1}
	若数域$K$上$n$元非齐次线性方程组$Ax=\beta$有解，则它的通解为：
	\begin{equation*}
		x=A^-\beta+(I_n-A^-A)y
	\end{equation*}
	其中$A^-$是$A$的任意一个给定的广义逆，$y$取遍$K^n$中的列向量。
\end{theorem}
\begin{proof}
	由\cref{theo:ConsistentLinearEqCondition}的充分性可知对于给定的这一$A^-$，$A^-\beta$为$Ax=\beta$的一个特解，而由\cref{theo:HomogeneousLinearEq'sGeneralSolution}可知齐次线性方程组$Ax=\mathbf{0}$的通解为$(I_n-A^-A)y$，由\cref{prop:InhomogeneousSLESolution}(3)可得$Ax=\beta$的通解为$x=A^-\beta+(I_n-A^-A)y$。
\end{proof}
\begin{theorem}[结构2]
	\label{theo:InhomogeneousLinearEq'sGeneralSolution2}
	若数域$K$上$n$元非齐次线性方程组$Ax=\beta$有解，则它的通解为：
	\begin{equation*}
		x=A^-\beta
	\end{equation*}
	$A^-$取遍$A$的所有广义逆。
\end{theorem}
\begin{proof}
	由\cref{theo:ConsistentLinearEqCondition}的充分性可知对于任意的$A^-$，$A^-\beta$都是$Ax=\beta$的解。\par
	对于$Ax=\beta$的任意一个解$y$，由\cref{theo:InhomogeneousLinearEq'sGeneralSolution1}可知存在$A$的一个广义逆$G$和$K^n$上的一个列向量$z$，使得：
	\begin{equation*}
		y=G\beta+(I_n-GA)z
	\end{equation*}
	因为$\beta\ne\mathbf{0}$，所以$\beta^H\beta\ne0$，于是存在数域$K$上的矩阵$B=z(\beta^H\beta)^{-1}\beta^H$使得$B\beta=z$，于是：
	\begin{equation*}
		y=G\beta+(I_n-GA)B\beta=[G+(I_n-GA)B]\beta
	\end{equation*}
	因为：
	\begin{align*}
		A[G+(I_n-GA)B]A
		&=AGA+A(I_n-GA)BA \\
		&=A+ABA-AGABA \\
		&=A+ABA-ABA=A
	\end{align*}
	所以$G+(I_n-GA)B$是$A$的一个广义逆，即$Ax=\beta$的任一解可以表示为$A^-\beta$。
\end{proof}
\begin{theorem}
	在数域$K$上相容线性方程组$Ax=\beta$的解集中，$x_0=A^+\beta$为长度最小者。
\end{theorem}
\begin{proof}
	由\cref{theo:InhomogeneousLinearEq'sGeneralSolution1}可知，$Ax=\beta$的通解可以表示为：
	\begin{equation*}
		x=A^+\beta+(I-A^+A)y
	\end{equation*}
	于是：
	\begin{align*}
		||x||
		&=[A^+\beta+(I-A^+A)y]^H[A^+\beta+(I-A^+A)y] \\
		&=||x_0||+\beta^H(A^+)^H(I-A^+A)y \\
		&\quad+y^H(I-A^+A)^HA^+\beta+y^H(I-A^+A)^H(I-A^+A)y \\
		&=||x_0||+2\beta^H(A^+)^H(I-A^+A)y+||(I-A^+A)y||
	\end{align*}
	由\cref{prop:A+}(9)可得：
	\begin{align*}
		(A^+)^H(I-A^+A)
		&=(A^+)^H-(A^+)^HA^+A=(A^H)^+-(A^H)^+A^+A \\
		&=(A^H)^+-[A(A^H)]^+A=\mathbf{0}
	\end{align*}
	于是有$2\beta^H(A^+)^H(I-A^+A)y=0$。因为$||(I-A^+A)y||\geqslant0$，等号成立当且仅当$(I-A^+A)y=\mathbf{0}$，所以$x=A^+\beta=x_0$时长度最小。
\end{proof}