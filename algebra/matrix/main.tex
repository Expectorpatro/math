\chapter{矩阵}

\input{algebra/matrix/matrix-space.tex}
\input{algebra/matrix/vector-space.tex}
\input{algebra/matrix/linear-equations.tex}
\input{algebra/matrix/equivalent-class.tex}
\input{algebra/matrix/equivalent.tex}
\input{algebra/matrix/similar.tex}
\input{algebra/matrix/congruent.tex}

\section{特殊矩阵}
\subsection{幂等阵}
\begin{definition}
	若矩阵$A\in M_{n}(K)$满足$A^2=I_n$，则称$A$为\gls{IdempotentMatrix}。
\end{definition}
\begin{property}
	设$A\in M_{n}(K)$是一个幂等阵，$\operatorname{rank}(A)=r$，则：
	\begin{enumerate}
		\item $A$的特征值只能是$1$或$0$；
		\item $\operatorname{tr}(A)=\operatorname{rank}(A)$；
		\item $A\text{幂等}\Leftrightarrow\operatorname{rank}(A)+\operatorname{rank}(I_n-A)=n$；
		\item 存在秩为$r$的$B\in M_{n}(K)$使得$A=B(B^TB)^-B^T$；
	\end{enumerate}
\end{property}
\begin{proof}
	(1)设$\lambda$为$A$的一个特征值，$\varphi$为对应的特征向量，因为$A$是一个幂等阵，所以$A^2\varphi=A\varphi=\lambda\varphi$，又因为：
	\begin{equation*}
		A^2\varphi=AA\varphi=A\lambda\varphi=\lambda A\varphi=\lambda^2\varphi
	\end{equation*}
	所以$(\lambda^2-\lambda)\varphi=\mathbf{0}$。因为$\varphi$是特征向量，所以$\varphi\ne\mathbf{0}$，于是$\lambda^2-\lambda=0$，即$\lambda=1$或$\lambda=0$。由$\lambda$的任意性，结论成立。\par
	(2)因为$\operatorname{rank}(A)=r$，所以存在可逆矩阵$P,Q$使得：
	\begin{equation*}
		A=P
		\begin{pmatrix}
			I_r & \mathbf{0} \\
			\mathbf{0} & \mathbf{0}
		\end{pmatrix}Q=
		\begin{pmatrix}
			P_1 & P_2
		\end{pmatrix}
		\begin{pmatrix}
			I_r & \mathbf{0} \\
			\mathbf{0} & \mathbf{0}
		\end{pmatrix}
		\begin{pmatrix}
			Q_1 \\
			Q_2
		\end{pmatrix}
	\end{equation*}
	其中$P_1$为$n\times r$矩阵，$Q_1$为$r\times n$矩阵，于是$A=P_1Q_1$。因为$A$是一个幂等阵，所以：
	\begin{gather*}
		P
		\begin{pmatrix}
			I_r & \mathbf{0} \\
			\mathbf{0} & \mathbf{0}
		\end{pmatrix}Q
		P
		\begin{pmatrix}
			I_r & \mathbf{0} \\
			\mathbf{0} & \mathbf{0}
		\end{pmatrix}Q
		=
		P
		\begin{pmatrix}
			I_r & \mathbf{0} \\
			\mathbf{0} & \mathbf{0}
		\end{pmatrix}Q \\
		\begin{pmatrix}
			I_r & \mathbf{0} \\
			\mathbf{0} & \mathbf{0}
		\end{pmatrix}QP
		\begin{pmatrix}
			I_r & \mathbf{0} \\
			\mathbf{0} & \mathbf{0}
		\end{pmatrix}=
		\begin{pmatrix}
			I_r & \mathbf{0} \\
			\mathbf{0} & \mathbf{0}
		\end{pmatrix} \\
		\begin{pmatrix}
			I_r & \mathbf{0} \\
			\mathbf{0} & \mathbf{0}
		\end{pmatrix}
		\begin{pmatrix}
			P_1 & P_2
		\end{pmatrix}
		\begin{pmatrix}
			Q_1 \\
			Q_2
		\end{pmatrix}
		\begin{pmatrix}
			I_r & \mathbf{0} \\
			\mathbf{0} & \mathbf{0}
		\end{pmatrix}=
		\begin{pmatrix}
			I_r & \mathbf{0} \\
			\mathbf{0} & \mathbf{0}
		\end{pmatrix} \\
		\begin{pmatrix}
			Q_1P_1 & \mathbf{0} \\
			\mathbf{0} & \mathbf{0}
		\end{pmatrix}
		=
		\begin{pmatrix}
			I_r & \mathbf{0} \\
			\mathbf{0} & \mathbf{0}
		\end{pmatrix}
	\end{gather*}
	即$Q_1P_1=I_r$。由\cref{prop:Trace}(3)可得：
	\begin{equation*}
		\operatorname{tr}(A)=\operatorname{tr}(P_1Q_1)=\operatorname{tr}(Q_1P_1)=\operatorname{tr}(I_r)=r=\operatorname{rank}(A)
	\end{equation*}\par
	(3)
\end{proof}
\begin{property}\label{prop:HermitianIdempotent}
	设$A\in M_{n}(\mathbb{C})$是一个Hermitian幂等阵，则：
	\begin{enumerate}
		\item 
		\item $\operatorname{rank}(A)=\operatorname{tr}(A)$。
	\end{enumerate}
\end{property}
\begin{proof}
	(1)
	(2)由\cref{prop:HermitianMatEigen}(3)和(1)可知存在一个正交矩阵$Q$使得：
	\begin{equation*}
		A=Q^{-1}
		\begin{pmatrix}
			I_r & \mathbf{0} \\
			\mathbf{0} & \mathbf{0}
		\end{pmatrix}Q
	\end{equation*}
	由\cref{prop:Similar}可得：
	\begin{equation*}
		\operatorname{rank}(A)=\operatorname{rank}(I_r)=r
	\end{equation*}
	根据\cref{prop:Trace}(3)可得：
	\begin{equation*}
		\operatorname{tr}(A)=\operatorname{tr}\left[Q^{-1}
		\begin{pmatrix}
			I_r & \mathbf{0} \\
			\mathbf{0} & \mathbf{0}
		\end{pmatrix}Q\right]
		=\operatorname{tr}\left[
		\begin{pmatrix}
			I_r & \mathbf{0} \\
			\mathbf{0} & \mathbf{0}
		\end{pmatrix}QQ^{-1}\right]
		=\operatorname{tr}\left[
		\begin{pmatrix}
			I_r & \mathbf{0} \\
			\mathbf{0} & \mathbf{0}
		\end{pmatrix}\right]
		=r
	\end{equation*}
	所以有$\operatorname{rank}(A)=\operatorname{tr}(A)$。
\end{proof}
\input{algebra/matrix/svd.tex}